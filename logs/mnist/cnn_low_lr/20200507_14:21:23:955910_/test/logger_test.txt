2020-05-25 23:05:50 INFO: name: 20200507_14:21:23:955910_
2020-05-25 23:05:50 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-05-25 23:05:50 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-05-25 23:05:50 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-05-25 23:05:50 INFO: Using dataset: mnist
2020-05-25 23:05:50 INFO: BUILD TEST GRAPH
2020-05-25 23:05:50 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-05-25 23:05:50 INFO: Overwrite dataset info from restored data version.
2020-05-25 23:05:50 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-05-25 23:05:50 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-05-25 23:05:50 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-05-25 23:05:52 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-05-25 23:05:52 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-05-25 23:05:52 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-05-25 23:05:52 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-05-25 23:05:52 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-05-25 23:05:52 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-05-25 23:05:53 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-05-25 23:05:53 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1864, in _create_c_op
    c_op = c_api.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Dimensions must be equal, but are 784 and 50176 for 'tower_0/reconstruction_loss/sub' (op: 'Sub') with input shapes: [50,784], [?,50176].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 321, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 146, in main
    is_train=False)
  File "inspect_results.py", line 316, in tower_fn
    recon_loss = mod.reconstruction_loss(x, decoder_out, batch_reduce=False)
  File "/home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py", line 493, in reconstruction_loss
    sqrd_diff = tf.square(flat_images - decoder_output)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py", line 884, in binary_op_wrapper
    return func(x, y, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_math_ops.py", line 10855, in sub
    "Sub", x=x, y=y, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2027, in __init__
    control_input_ops)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1867, in _create_c_op
    raise ValueError(str(e))
ValueError: Dimensions must be equal, but are 784 and 50176 for 'tower_0/reconstruction_loss/sub' (op: 'Sub') with input shapes: [50,784], [?,50176].

2020-05-25 23:09:21 INFO: name: 20200507_14:21:23:955910_
2020-05-25 23:09:21 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-05-25 23:09:21 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-05-25 23:09:21 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-05-25 23:09:21 INFO: Using dataset: mnist
2020-05-25 23:09:21 INFO: BUILD TEST GRAPH
2020-05-25 23:09:21 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-05-25 23:09:21 INFO: Overwrite dataset info from restored data version.
2020-05-25 23:09:21 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-05-25 23:09:21 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-05-25 23:09:21 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-05-25 23:09:21 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-05-25 23:09:21 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-05-25 23:09:21 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-05-25 23:09:21 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-05-25 23:09:21 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-05-25 23:09:21 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-05-25 23:09:22 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-05-25 23:09:22 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1864, in _create_c_op
    c_op = c_api.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Dimensions must be equal, but are 784 and 50176 for 'tower_0/reconstruction_loss/sub' (op: 'Sub') with input shapes: [50,784], [?,50176].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 321, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 146, in main
    is_train=False)
  File "inspect_results.py", line 316, in tower_fn
    recon_loss = mod.reconstruction_loss(x, decoder_out, batch_reduce=False)
  File "/home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py", line 493, in reconstruction_loss
    sqrd_diff = tf.square(flat_images - decoder_output)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py", line 884, in binary_op_wrapper
    return func(x, y, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_math_ops.py", line 10855, in sub
    "Sub", x=x, y=y, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2027, in __init__
    control_input_ops)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1867, in _create_c_op
    raise ValueError(str(e))
ValueError: Dimensions must be equal, but are 784 and 50176 for 'tower_0/reconstruction_loss/sub' (op: 'Sub') with input shapes: [50,784], [?,50176].

2020-05-25 23:09:49 INFO: name: 20200507_14:21:23:955910_
2020-05-25 23:09:49 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-05-25 23:09:49 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-05-25 23:09:49 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-05-25 23:09:49 INFO: Using dataset: mnist
2020-05-25 23:09:49 INFO: BUILD TEST GRAPH
2020-05-25 23:09:49 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-05-25 23:09:49 INFO: Overwrite dataset info from restored data version.
2020-05-25 23:09:49 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-05-25 23:09:49 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-05-25 23:09:49 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-05-25 23:09:49 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-05-25 23:09:49 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-05-25 23:09:49 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-05-25 23:09:49 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-05-25 23:09:49 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-05-25 23:09:50 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-05-25 23:09:51 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-05-25 23:09:51 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1864, in _create_c_op
    c_op = c_api.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Dimensions must be equal, but are 784 and 50176 for 'tower_0/reconstruction_loss/sub' (op: 'Sub') with input shapes: [50,784], [?,50176].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 321, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 146, in main
    is_train=False)
  File "inspect_results.py", line 316, in tower_fn
    recon_loss = mod.reconstruction_loss(x, decoder_out, batch_reduce=False)
  File "/home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py", line 493, in reconstruction_loss
    sqrd_diff = tf.square(flat_images - decoder_output)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py", line 884, in binary_op_wrapper
    return func(x, y, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_math_ops.py", line 10855, in sub
    "Sub", x=x, y=y, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2027, in __init__
    control_input_ops)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1867, in _create_c_op
    raise ValueError(str(e))
ValueError: Dimensions must be equal, but are 784 and 50176 for 'tower_0/reconstruction_loss/sub' (op: 'Sub') with input shapes: [50,784], [?,50176].

2020-05-25 23:10:16 INFO: name: 20200507_14:21:23:955910_
2020-05-25 23:10:16 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-05-25 23:10:17 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-05-25 23:10:17 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-05-25 23:10:17 INFO: Using dataset: mnist
2020-05-25 23:10:17 INFO: BUILD TEST GRAPH
2020-05-25 23:10:17 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-05-25 23:10:17 INFO: Overwrite dataset info from restored data version.
2020-05-25 23:10:17 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-05-25 23:10:17 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-05-25 23:10:17 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-05-25 23:10:17 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-05-25 23:10:17 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-05-25 23:10:17 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-05-25 23:10:17 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-05-25 23:10:17 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-05-25 23:10:18 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-05-25 23:10:18 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-05-25 23:10:18 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1864, in _create_c_op
    c_op = c_api.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Dimensions must be equal, but are 784 and 50176 for 'tower_0/reconstruction_loss/sub' (op: 'Sub') with input shapes: [50,784], [?,50176].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 321, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 146, in main
    is_train=False)
  File "inspect_results.py", line 316, in tower_fn
    recon_loss = mod.reconstruction_loss(x, decoder_out, batch_reduce=False)
  File "/home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py", line 493, in reconstruction_loss
    sqrd_diff = tf.square(flat_images - decoder_output)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py", line 884, in binary_op_wrapper
    return func(x, y, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_math_ops.py", line 10855, in sub
    "Sub", x=x, y=y, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2027, in __init__
    control_input_ops)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1867, in _create_c_op
    raise ValueError(str(e))
ValueError: Dimensions must be equal, but are 784 and 50176 for 'tower_0/reconstruction_loss/sub' (op: 'Sub') with input shapes: [50,784], [?,50176].

2020-05-25 23:10:19 INFO: name: 20200507_14:21:23:955910_
2020-05-25 23:10:19 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-05-25 23:10:19 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-05-25 23:10:19 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-05-25 23:10:19 INFO: Using dataset: mnist
2020-05-25 23:10:19 INFO: BUILD TEST GRAPH
2020-05-25 23:10:19 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-05-25 23:10:19 INFO: Overwrite dataset info from restored data version.
2020-05-25 23:10:19 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-05-25 23:10:19 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-05-25 23:10:19 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-05-25 23:10:19 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-05-25 23:10:19 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-05-25 23:10:19 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-05-25 23:10:19 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-05-25 23:10:19 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-05-25 23:10:20 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-05-25 23:10:21 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-05-25 23:10:21 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1864, in _create_c_op
    c_op = c_api.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Dimensions must be equal, but are 784 and 50176 for 'tower_0/reconstruction_loss/sub' (op: 'Sub') with input shapes: [50,784], [?,50176].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 321, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 146, in main
    is_train=False)
  File "inspect_results.py", line 316, in tower_fn
    recon_loss = mod.reconstruction_loss(x, decoder_out, batch_reduce=False)
  File "/home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py", line 493, in reconstruction_loss
    sqrd_diff = tf.square(flat_images - decoder_output)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py", line 884, in binary_op_wrapper
    return func(x, y, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_math_ops.py", line 10855, in sub
    "Sub", x=x, y=y, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2027, in __init__
    control_input_ops)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1867, in _create_c_op
    raise ValueError(str(e))
ValueError: Dimensions must be equal, but are 784 and 50176 for 'tower_0/reconstruction_loss/sub' (op: 'Sub') with input shapes: [50,784], [?,50176].

2020-05-25 23:10:58 INFO: name: 20200507_14:21:23:955910_
2020-05-25 23:10:58 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-05-25 23:10:58 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-05-25 23:10:58 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-05-25 23:10:58 INFO: Using dataset: mnist
2020-05-25 23:10:58 INFO: BUILD TEST GRAPH
2020-05-25 23:10:58 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-05-25 23:10:58 INFO: Overwrite dataset info from restored data version.
2020-05-25 23:10:58 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-05-25 23:10:58 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-05-25 23:10:58 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-05-25 23:10:58 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-05-25 23:10:58 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-05-25 23:10:58 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-05-25 23:10:58 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-05-25 23:10:59 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-05-25 23:10:59 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-05-25 23:11:00 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-05-25 23:11:00 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1864, in _create_c_op
    c_op = c_api.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Dimensions must be equal, but are 784 and 50176 for 'tower_0/reconstruction_loss/sub' (op: 'Sub') with input shapes: [50,784], [?,50176].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 321, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 146, in main
    is_train=False)
  File "inspect_results.py", line 316, in tower_fn
    recon_loss = mod.reconstruction_loss(x, decoder_out, batch_reduce=False)
  File "/home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py", line 493, in reconstruction_loss
    sqrd_diff = tf.square(flat_images - decoder_output)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py", line 884, in binary_op_wrapper
    return func(x, y, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_math_ops.py", line 10855, in sub
    "Sub", x=x, y=y, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2027, in __init__
    control_input_ops)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1867, in _create_c_op
    raise ValueError(str(e))
ValueError: Dimensions must be equal, but are 784 and 50176 for 'tower_0/reconstruction_loss/sub' (op: 'Sub') with input shapes: [50,784], [?,50176].

2020-05-25 23:11:10 INFO: name: 20200507_14:21:23:955910_
2020-05-25 23:11:10 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-05-25 23:11:10 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-05-25 23:11:10 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-05-25 23:11:10 INFO: Using dataset: mnist
2020-05-25 23:11:10 INFO: BUILD TEST GRAPH
2020-05-25 23:11:10 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-05-25 23:11:10 INFO: Overwrite dataset info from restored data version.
2020-05-25 23:11:10 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-05-25 23:11:10 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-05-25 23:11:10 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-05-25 23:11:11 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-05-25 23:11:11 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-05-25 23:11:11 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-05-25 23:11:11 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-05-25 23:11:11 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-05-25 23:11:11 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-05-25 23:11:12 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-05-25 23:11:12 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1864, in _create_c_op
    c_op = c_api.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Dimensions must be equal, but are 784 and 50176 for 'tower_0/reconstruction_loss/sub' (op: 'Sub') with input shapes: [50,784], [?,50176].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 321, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 146, in main
    is_train=False)
  File "inspect_results.py", line 316, in tower_fn
    recon_loss = mod.reconstruction_loss(x, decoder_out, batch_reduce=False)
  File "/home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py", line 493, in reconstruction_loss
    sqrd_diff = tf.square(flat_images - decoder_output)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py", line 884, in binary_op_wrapper
    return func(x, y, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_math_ops.py", line 10855, in sub
    "Sub", x=x, y=y, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2027, in __init__
    control_input_ops)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1867, in _create_c_op
    raise ValueError(str(e))
ValueError: Dimensions must be equal, but are 784 and 50176 for 'tower_0/reconstruction_loss/sub' (op: 'Sub') with input shapes: [50,784], [?,50176].

2020-05-25 23:11:25 INFO: name: 20200507_14:21:23:955910_
2020-05-25 23:11:25 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-05-25 23:11:25 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-05-25 23:11:25 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-05-25 23:11:25 INFO: Using dataset: mnist
2020-05-25 23:11:25 INFO: BUILD TEST GRAPH
2020-05-25 23:11:25 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-05-25 23:11:25 INFO: Overwrite dataset info from restored data version.
2020-05-25 23:11:25 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-05-25 23:11:25 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-05-25 23:11:25 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-05-25 23:11:25 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-05-25 23:11:25 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-05-25 23:11:25 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-05-25 23:11:25 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-05-25 23:11:26 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-05-25 23:11:26 INFO: name: 20200507_14:21:23:955910_
2020-05-25 23:11:26 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-05-25 23:11:26 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-05-25 23:11:26 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-05-25 23:11:26 INFO: Using dataset: mnist
2020-05-25 23:11:26 INFO: BUILD TEST GRAPH
2020-05-25 23:11:26 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-05-25 23:11:26 INFO: Overwrite dataset info from restored data version.
2020-05-25 23:11:26 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-05-25 23:11:26 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-05-25 23:11:26 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-05-25 23:11:26 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-05-25 23:11:26 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-05-25 23:11:26 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-05-25 23:11:27 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-05-25 23:11:27 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-05-25 23:11:27 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-05-25 23:11:27 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-05-25 23:11:27 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1864, in _create_c_op
    c_op = c_api.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Dimensions must be equal, but are 784 and 50176 for 'tower_0/reconstruction_loss/sub' (op: 'Sub') with input shapes: [50,784], [?,50176].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 321, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 146, in main
    is_train=False)
  File "inspect_results.py", line 316, in tower_fn
    recon_loss = mod.reconstruction_loss(x, decoder_out, batch_reduce=False)
  File "/home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py", line 493, in reconstruction_loss
    sqrd_diff = tf.square(flat_images - decoder_output)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py", line 884, in binary_op_wrapper
    return func(x, y, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_math_ops.py", line 10855, in sub
    "Sub", x=x, y=y, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2027, in __init__
    control_input_ops)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1867, in _create_c_op
    raise ValueError(str(e))
ValueError: Dimensions must be equal, but are 784 and 50176 for 'tower_0/reconstruction_loss/sub' (op: 'Sub') with input shapes: [50,784], [?,50176].

2020-05-25 23:11:27 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-05-25 23:11:28 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-05-25 23:11:28 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1864, in _create_c_op
    c_op = c_api.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Dimensions must be equal, but are 784 and 50176 for 'tower_0/reconstruction_loss/sub' (op: 'Sub') with input shapes: [50,784], [?,50176].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 321, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 146, in main
    is_train=False)
  File "inspect_results.py", line 316, in tower_fn
    recon_loss = mod.reconstruction_loss(x, decoder_out, batch_reduce=False)
  File "/home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py", line 493, in reconstruction_loss
    sqrd_diff = tf.square(flat_images - decoder_output)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py", line 884, in binary_op_wrapper
    return func(x, y, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_math_ops.py", line 10855, in sub
    "Sub", x=x, y=y, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2027, in __init__
    control_input_ops)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1867, in _create_c_op
    raise ValueError(str(e))
ValueError: Dimensions must be equal, but are 784 and 50176 for 'tower_0/reconstruction_loss/sub' (op: 'Sub') with input shapes: [50,784], [?,50176].

2020-05-25 23:11:54 INFO: name: 20200507_14:21:23:955910_
2020-05-25 23:11:54 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-05-25 23:11:54 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-05-25 23:11:54 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-05-25 23:11:54 INFO: Using dataset: mnist
2020-05-25 23:11:54 INFO: BUILD TEST GRAPH
2020-05-25 23:11:54 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-05-25 23:11:54 INFO: Overwrite dataset info from restored data version.
2020-05-25 23:11:54 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-05-25 23:11:54 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-05-25 23:11:54 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-05-25 23:11:54 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-05-25 23:11:54 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-05-25 23:11:54 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-05-25 23:11:54 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-05-25 23:11:54 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-05-25 23:11:55 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-05-25 23:11:55 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-05-25 23:11:55 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1864, in _create_c_op
    c_op = c_api.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Dimensions must be equal, but are 784 and 50176 for 'tower_0/reconstruction_loss/sub' (op: 'Sub') with input shapes: [50,784], [?,50176].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 321, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 146, in main
    is_train=False)
  File "inspect_results.py", line 316, in tower_fn
    recon_loss = mod.reconstruction_loss(x, decoder_out, batch_reduce=False)
  File "/home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py", line 493, in reconstruction_loss
    sqrd_diff = tf.square(flat_images - decoder_output)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py", line 884, in binary_op_wrapper
    return func(x, y, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_math_ops.py", line 10855, in sub
    "Sub", x=x, y=y, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2027, in __init__
    control_input_ops)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1867, in _create_c_op
    raise ValueError(str(e))
ValueError: Dimensions must be equal, but are 784 and 50176 for 'tower_0/reconstruction_loss/sub' (op: 'Sub') with input shapes: [50,784], [?,50176].

2020-05-25 23:12:21 INFO: name: 20200507_14:21:23:955910_
2020-05-25 23:12:21 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-05-25 23:12:21 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-05-25 23:12:21 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-05-25 23:12:21 INFO: Using dataset: mnist
2020-05-25 23:12:21 INFO: BUILD TEST GRAPH
2020-05-25 23:12:21 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-05-25 23:12:21 INFO: Overwrite dataset info from restored data version.
2020-05-25 23:12:21 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-05-25 23:12:21 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-05-25 23:12:21 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-05-25 23:12:21 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-05-25 23:12:21 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-05-25 23:12:21 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-05-25 23:12:21 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-05-25 23:12:21 INFO: name: 20200507_14:21:23:955910_
2020-05-25 23:12:21 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-05-25 23:12:21 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-05-25 23:12:21 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-05-25 23:12:21 INFO: Using dataset: mnist
2020-05-25 23:12:21 INFO: BUILD TEST GRAPH
2020-05-25 23:12:21 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-05-25 23:12:21 INFO: Overwrite dataset info from restored data version.
2020-05-25 23:12:21 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-05-25 23:12:21 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-05-25 23:12:21 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-05-25 23:12:21 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
ust call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-05-25 23:12:21 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-05-25 23:12:21 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-05-25 23:12:22 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-05-25 23:12:22 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-05-25 23:12:22 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-05-25 23:12:22 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-05-25 23:12:23 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-05-25 23:12:23 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1864, in _create_c_op
    c_op = c_api.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Dimensions must be equal, but are 784 and 50176 for 'tower_0/reconstruction_loss/sub' (op: 'Sub') with input shapes: [50,784], [?,50176].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 321, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 146, in main
    is_train=False)
  File "inspect_results.py", line 316, in tower_fn
    recon_loss = mod.reconstruction_loss(x, decoder_out, batch_reduce=False)
  File "/home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py", line 493, in reconstruction_loss
    sqrd_diff = tf.square(flat_images - decoder_output)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py", line 884, in binary_op_wrapper
    return func(x, y, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_math_ops.py", line 10855, in sub
    "Sub", x=x, y=y, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2027, in __init__
    control_input_ops)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1867, in _create_c_op
    raise ValueError(str(e))
ValueError: Dimensions must be equal, but are 784 and 50176 for 'tower_0/reconstruction_loss/sub' (op: 'Sub') with input shapes: [50,784], [?,50176].

2020-05-25 23:12:23 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-05-25 23:12:23 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1864, in _create_c_op
    c_op = c_api.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Dimensions must be equal, but are 784 and 50176 for 'tower_0/reconstruction_loss/sub' (op: 'Sub') with input shapes: [50,784], [?,50176].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 321, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 146, in main
    is_train=False)
  File "inspect_results.py", line 316, in tower_fn
    recon_loss = mod.reconstruction_loss(x, decoder_out, batch_reduce=False)
  File "/home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py", line 493, in reconstruction_loss
    sqrd_diff = tf.square(flat_images - decoder_output)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py", line 884, in binary_op_wrapper
    return func(x, y, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_math_ops.py", line 10855, in sub
    "Sub", x=x, y=y, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2027, in __init__
    control_input_ops)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1867, in _create_c_op
    raise ValueError(str(e))
ValueError: Dimensions must be equal, but are 784 and 50176 for 'tower_0/reconstruction_loss/sub' (op: 'Sub') with input shapes: [50,784], [?,50176].

2020-05-25 23:12:49 INFO: name: 20200507_14:21:23:955910_
2020-05-25 23:12:49 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-05-25 23:12:49 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-05-25 23:12:49 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-05-25 23:12:49 INFO: Using dataset: mnist
2020-05-25 23:12:49 INFO: BUILD TEST GRAPH
2020-05-25 23:12:49 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-05-25 23:12:49 INFO: Overwrite dataset info from restored data version.
2020-05-25 23:12:49 INFO: name: 20200507_14:21:23:955910_
2020-05-25 23:12:49 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-05-25 23:12:49 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-05-25 23:12:49 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-05-25 23:12:49 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-05-25 23:12:49 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-05-25 23:12:49 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-05-25 23:12:49 INFO: Using dataset: mnist
2020-05-25 23:12:49 INFO: BUILD TEST GRAPH
2020-05-25 23:12:49 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-05-25 23:12:49 INFO: Overwrite dataset info from restored data version.
2020-05-25 23:12:49 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-05-25 23:12:49 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-05-25 23:12:49 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-05-25 23:12:49 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-05-25 23:12:49 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-05-25 23:12:49 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-05-25 23:12:49 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-05-25 23:12:49 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-05-25 23:12:49 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-05-25 23:12:49 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-05-25 23:12:50 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-05-25 23:12:50 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-05-25 23:12:50 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-05-25 23:12:50 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-05-25 23:12:51 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-05-25 23:12:51 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-05-25 23:12:51 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1864, in _create_c_op
    c_op = c_api.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Dimensions must be equal, but are 784 and 50176 for 'tower_0/reconstruction_loss/sub' (op: 'Sub') with input shapes: [50,784], [?,50176].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 321, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 146, in main
    is_train=False)
  File "inspect_results.py", line 316, in tower_fn
    recon_loss = mod.reconstruction_loss(x, decoder_out, batch_reduce=False)
  File "/home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py", line 493, in reconstruction_loss
    sqrd_diff = tf.square(flat_images - decoder_output)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py", line 884, in binary_op_wrapper
    return func(x, y, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_math_ops.py", line 10855, in sub
    "Sub", x=x, y=y, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2027, in __init__
    control_input_ops)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1867, in _create_c_op
    raise ValueError(str(e))
ValueError: Dimensions must be equal, but are 784 and 50176 for 'tower_0/reconstruction_loss/sub' (op: 'Sub') with input shapes: [50,784], [?,50176].

2020-05-25 23:12:51 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1864, in _create_c_op
    c_op = c_api.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Dimensions must be equal, but are 784 and 50176 for 'tower_0/reconstruction_loss/sub' (op: 'Sub') with input shapes: [50,784], [?,50176].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 321, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 146, in main
    is_train=False)
  File "inspect_results.py", line 316, in tower_fn
    recon_loss = mod.reconstruction_loss(x, decoder_out, batch_reduce=False)
  File "/home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py", line 493, in reconstruction_loss
    sqrd_diff = tf.square(flat_images - decoder_output)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py", line 884, in binary_op_wrapper
    return func(x, y, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_math_ops.py", line 10855, in sub
    "Sub", x=x, y=y, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2027, in __init__
    control_input_ops)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 1867, in _create_c_op
    raise ValueError(str(e))
ValueError: Dimensions must be equal, but are 784 and 50176 for 'tower_0/reconstruction_loss/sub' (op: 'Sub') with input shapes: [50,784], [?,50176].

2020-05-25 23:24:47 INFO: name: 20200507_14:21:23:955910_
2020-05-25 23:24:47 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-05-25 23:24:47 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-05-25 23:24:47 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-05-25 23:24:47 INFO: Using dataset: mnist
2020-05-25 23:24:47 INFO: BUILD TEST GRAPH
2020-05-25 23:24:47 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-05-25 23:24:47 INFO: Overwrite dataset info from restored data version.
2020-05-25 23:24:47 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-05-25 23:24:47 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-05-25 23:24:47 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-05-25 23:24:47 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-05-25 23:24:47 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-05-25 23:24:47 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-05-25 23:24:47 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-05-25 23:24:48 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-05-25 23:24:48 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-05-25 23:24:49 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-05-25 23:24:49 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-05-25 23:24:50 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-05-25 23:24:50 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-05-25 23:24:50 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-05-25 23:26:03 INFO: writing to csv
2020-05-25 23:26:04 INFO: csv saved at logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test/logs_mnist_cnn_adv_00_20200523_17_45_37_971194__train_saved_patch_png_test.csv
2020-05-25 23:46:34 INFO: name: 20200507_14:21:23:955910_
2020-05-25 23:46:34 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-05-25 23:46:34 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-05-25 23:46:34 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-05-25 23:46:34 INFO: Using dataset: mnist
2020-05-25 23:46:34 INFO: BUILD TEST GRAPH
2020-05-25 23:46:34 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-05-25 23:46:34 INFO: Overwrite dataset info from restored data version.
2020-05-25 23:46:34 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-05-25 23:46:35 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-05-25 23:46:35 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-05-25 23:46:35 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-05-25 23:46:35 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-05-25 23:46:35 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-05-25 23:46:35 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-05-25 23:46:36 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-05-25 23:46:36 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-05-25 23:46:37 INFO: name: 20200507_14:21:23:955910_
2020-05-25 23:46:37 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-05-25 23:46:37 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-05-25 23:46:37 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-05-25 23:46:37 INFO: Using dataset: mnist
2020-05-25 23:46:37 INFO: BUILD TEST GRAPH
2020-05-25 23:46:37 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-05-25 23:46:37 INFO: Overwrite dataset info from restored data version.
2020-05-25 23:46:37 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-05-25 23:46:37 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-05-25 23:46:37 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-05-25 23:46:37 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-05-25 23:46:37 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-05-25 23:46:37 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-05-25 23:46:37 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-05-25 23:46:37 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-05-25 23:46:37 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-05-25 23:46:38 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-05-25 23:46:38 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-05-25 23:46:38 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-05-25 23:46:38 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-05-25 23:46:38 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-05-25 23:46:39 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-05-25 23:46:39 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-05-25 23:46:40 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-05-25 23:46:40 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-05-25 23:46:41 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-05-25 23:47:11 INFO: name: 20200507_14:21:23:955910_
2020-05-25 23:47:11 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-05-25 23:47:12 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-05-25 23:47:12 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-05-25 23:47:12 INFO: Using dataset: mnist
2020-05-25 23:47:12 INFO: BUILD TEST GRAPH
2020-05-25 23:47:12 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-05-25 23:47:12 INFO: Overwrite dataset info from restored data version.
2020-05-25 23:47:12 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-05-25 23:47:12 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-05-25 23:47:12 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-05-25 23:47:12 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-05-25 23:47:12 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-05-25 23:47:12 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-05-25 23:47:12 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-05-25 23:47:12 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-05-25 23:47:13 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-05-25 23:47:14 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-05-25 23:47:14 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-05-25 23:47:15 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-05-25 23:47:15 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-05-25 23:47:15 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-05-25 23:47:30 INFO: name: 20200507_14:21:23:955910_
2020-05-25 23:47:30 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-05-25 23:47:30 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-05-25 23:47:30 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-05-25 23:47:30 INFO: Using dataset: mnist
2020-05-25 23:47:30 INFO: BUILD TEST GRAPH
2020-05-25 23:47:30 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-05-25 23:47:30 INFO: Overwrite dataset info from restored data version.
2020-05-25 23:47:30 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-05-25 23:47:30 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-05-25 23:47:30 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-05-25 23:47:30 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-05-25 23:47:30 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-05-25 23:47:30 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-05-25 23:47:30 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-05-25 23:47:31 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-05-25 23:47:31 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-05-25 23:47:32 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-05-25 23:47:32 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-05-25 23:47:33 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-05-25 23:47:33 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-05-25 23:47:33 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-05-25 23:47:36 INFO: writing to csv
2020-05-25 23:47:36 INFO: csv saved at logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test/logs_mnist_cnn_adv_05_20200523_17_51_59_203107__train_saved_patch_png_test.csv
2020-05-25 23:47:41 INFO: name: 20200507_14:21:23:955910_
2020-05-25 23:47:41 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-05-25 23:47:41 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-05-25 23:47:41 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-05-25 23:47:41 INFO: Using dataset: mnist
2020-05-25 23:47:41 INFO: BUILD TEST GRAPH
2020-05-25 23:47:41 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-05-25 23:47:41 INFO: Overwrite dataset info from restored data version.
2020-05-25 23:47:41 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-05-25 23:47:41 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-05-25 23:47:41 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-05-25 23:47:41 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-05-25 23:47:41 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-05-25 23:47:41 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-05-25 23:47:41 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-05-25 23:47:42 INFO: writing to csv
2020-05-25 23:47:42 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-05-25 23:47:42 INFO: csv saved at logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test/logs_mnist_cnn_adv_10_20200523_17_51_59_202980__train_saved_patch_png_test.csv
2020-05-25 23:47:42 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-05-25 23:47:43 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-05-25 23:47:44 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-05-25 23:47:44 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-05-25 23:47:44 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-05-25 23:47:44 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-05-25 23:48:04 INFO: name: 20200507_14:21:23:955910_
2020-05-25 23:48:04 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-05-25 23:48:04 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-05-25 23:48:04 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-05-25 23:48:04 INFO: Using dataset: mnist
2020-05-25 23:48:04 INFO: BUILD TEST GRAPH
2020-05-25 23:48:04 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-05-25 23:48:04 INFO: Overwrite dataset info from restored data version.
2020-05-25 23:48:04 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-05-25 23:48:04 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-05-25 23:48:04 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-05-25 23:48:05 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-05-25 23:48:05 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-05-25 23:48:05 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-05-25 23:48:05 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-05-25 23:48:05 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-05-25 23:48:05 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-05-25 23:48:06 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-05-25 23:48:06 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-05-25 23:48:07 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-05-25 23:48:07 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-05-25 23:48:07 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-05-25 23:48:22 INFO: writing to csv
2020-05-25 23:48:23 INFO: csv saved at logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test/logs_mnist_cnn_adv_15_20200523_17_51_59_200573__train_saved_patch_png_test.csv
2020-05-25 23:48:36 INFO: writing to csv
2020-05-25 23:48:36 INFO: csv saved at logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test/logs_mnist_cnn_adv_20_20200523_17_52_20_629928__train_saved_patch_png_test.csv
2020-05-25 23:48:41 INFO: writing to csv
2020-05-25 23:48:42 INFO: csv saved at logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test/logs_mnist_cnn_adv_25_20200523_17_52_20_629545__train_saved_patch_png_test.csv
2020-05-25 23:49:34 INFO: name: 20200507_14:21:23:955910_
2020-05-25 23:49:34 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-05-25 23:49:34 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-05-25 23:49:34 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-05-25 23:49:34 INFO: Using dataset: mnist
2020-05-25 23:49:34 INFO: BUILD TEST GRAPH
2020-05-25 23:49:34 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-05-25 23:49:34 INFO: Overwrite dataset info from restored data version.
2020-05-25 23:49:34 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-05-25 23:49:34 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-05-25 23:49:34 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-05-25 23:49:34 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-05-25 23:49:34 INFO: name: 20200507_14:21:23:955910_
2020-05-25 23:49:34 INFO: parent_dir: logs/mnist/cnn_low_lr
e name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-05-25 23:49:35 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
eprecated. Please use tf.compat.v1.variable_scope instead.

2020-05-25 23:49:35 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-05-25 23:49:35 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-05-25 23:49:35 INFO: Using dataset: mnist
2020-05-25 23:49:35 INFO: BUILD TEST GRAPH
2020-05-25 23:49:35 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-05-25 23:49:35 INFO: Overwrite dataset info from restored data version.
2020-05-25 23:49:35 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-05-25 23:49:35 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-05-25 23:49:35 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-05-25 23:49:35 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-05-25 23:49:35 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-05-25 23:49:35 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-05-25 23:49:35 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-05-25 23:49:35 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-05-25 23:49:35 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-05-25 23:49:35 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-05-25 23:49:36 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-05-25 23:49:36 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-05-25 23:49:36 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-05-25 23:49:37 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-05-25 23:49:37 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-05-25 23:49:37 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-05-25 23:49:37 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-05-25 23:49:37 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-05-25 23:49:37 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-05-25 23:49:37 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-05-25 23:50:04 INFO: name: 20200507_14:21:23:955910_
2020-05-25 23:50:04 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-05-25 23:50:04 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-05-25 23:50:04 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-05-25 23:50:04 INFO: Using dataset: mnist
2020-05-25 23:50:04 INFO: BUILD TEST GRAPH
2020-05-25 23:50:04 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-05-25 23:50:05 INFO: Overwrite dataset info from restored data version.
2020-05-25 23:50:05 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-05-25 23:50:05 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-05-25 23:50:05 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-05-25 23:50:05 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-05-25 23:50:05 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-05-25 23:50:05 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-05-25 23:50:05 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-05-25 23:50:05 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-05-25 23:50:05 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-05-25 23:50:06 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-05-25 23:50:06 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-05-25 23:50:07 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-05-25 23:50:07 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-05-25 23:50:07 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-05-25 23:50:35 INFO: name: 20200507_14:21:23:955910_
2020-05-25 23:50:35 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-05-25 23:50:35 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-05-25 23:50:35 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-05-25 23:50:35 INFO: Using dataset: mnist
2020-05-25 23:50:35 INFO: BUILD TEST GRAPH
2020-05-25 23:50:35 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-05-25 23:50:35 INFO: Overwrite dataset info from restored data version.
2020-05-25 23:50:35 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-05-25 23:50:35 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-05-25 23:50:35 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-05-25 23:50:35 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-05-25 23:50:35 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-05-25 23:50:35 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-05-25 23:50:35 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-05-25 23:50:35 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-05-25 23:50:35 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-05-25 23:50:36 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-05-25 23:50:37 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-05-25 23:50:37 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-05-25 23:50:37 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-05-25 23:50:37 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-05-25 23:50:41 INFO: writing to csv
2020-05-25 23:50:43 INFO: csv saved at logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test/logs_mnist_cnn_adv_30_20200523_17_52_43_862606__train_saved_patch_png_test.csv
2020-05-25 23:51:05 INFO: name: 20200507_14:21:23:955910_
2020-05-25 23:51:05 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-05-25 23:51:05 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-05-25 23:51:05 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-05-25 23:51:05 INFO: Using dataset: mnist
2020-05-25 23:51:05 INFO: BUILD TEST GRAPH
2020-05-25 23:51:05 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-05-25 23:51:05 INFO: Overwrite dataset info from restored data version.
2020-05-25 23:51:05 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-05-25 23:51:05 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-05-25 23:51:05 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-05-25 23:51:05 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-05-25 23:51:05 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-05-25 23:51:05 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-05-25 23:51:05 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-05-25 23:51:05 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-05-25 23:51:06 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-05-25 23:51:06 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-05-25 23:51:07 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-05-25 23:51:07 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-05-25 23:51:07 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-05-25 23:51:07 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-05-25 23:51:09 INFO: name: 20200507_14:21:23:955910_
2020-05-25 23:51:09 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-05-25 23:51:09 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-05-25 23:51:09 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-05-25 23:51:09 INFO: Using dataset: mnist
2020-05-25 23:51:09 INFO: BUILD TEST GRAPH
2020-05-25 23:51:09 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-05-25 23:51:09 INFO: Overwrite dataset info from restored data version.
2020-05-25 23:51:09 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-05-25 23:51:09 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-05-25 23:51:09 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-05-25 23:51:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-05-25 23:51:09 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-05-25 23:51:09 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-05-25 23:51:09 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-05-25 23:51:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-05-25 23:51:10 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-05-25 23:51:10 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-05-25 23:51:11 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-05-25 23:51:11 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-05-25 23:51:12 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-05-25 23:51:12 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-05-25 23:51:41 INFO: name: 20200507_14:21:23:955910_
2020-05-25 23:51:41 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-05-25 23:51:41 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-05-25 23:51:41 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-05-25 23:51:41 INFO: Using dataset: mnist
2020-05-25 23:51:41 INFO: BUILD TEST GRAPH
2020-05-25 23:51:41 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-05-25 23:51:41 INFO: Overwrite dataset info from restored data version.
2020-05-25 23:51:41 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-05-25 23:51:41 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-05-25 23:51:41 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-05-25 23:51:42 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-05-25 23:51:42 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-05-25 23:51:42 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-05-25 23:51:42 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-05-25 23:51:42 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-05-25 23:51:42 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-05-25 23:51:43 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-05-25 23:51:43 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-05-25 23:51:44 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-05-25 23:51:44 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-05-25 23:51:44 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-05-25 23:52:15 INFO: writing to csv
2020-05-25 23:52:16 INFO: writing to csv
2020-05-25 23:52:16 INFO: csv saved at logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test/logs_mnist_cnn_adv_35_20200523_17_53_45_577974__train_saved_patch_png_test.csv
2020-05-25 23:52:16 INFO: csv saved at logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test/logs_mnist_cnn_adv_40_20200523_17_54_50_514197__train_saved_patch_png_test.csv
2020-05-25 23:52:46 INFO: writing to csv
2020-05-25 23:52:47 INFO: csv saved at logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test/logs_mnist_cnn_adv_45_20200523_17_55_14_783439__train_saved_patch_png_test.csv
2020-05-25 23:53:07 INFO: writing to csv
2020-05-25 23:53:07 INFO: csv saved at logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test/logs_mnist_cnn_adv_50_20200523_17_55_14_231995__train_saved_patch_png_test.csv
2020-05-25 23:53:37 INFO: writing to csv
2020-05-25 23:53:37 INFO: csv saved at logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test/logs_mnist_cnn_adv_hun_20200523_18_03_23_818992__train_saved_patch_png_test.csv
2020-05-25 23:53:45 INFO: writing to csv
2020-05-25 23:53:46 INFO: csv saved at logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test/logs_mnist_cnn_adv_ten_20200523_17_59_39_944349__train_saved_patch_png_test.csv
2020-05-25 23:54:00 INFO: writing to csv
2020-05-25 23:54:01 INFO: csv saved at logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test/logs_mnist_cnn_adv_tho_20200523_18_03_33_266518__train_saved_patch_png_test.csv
2020-06-26 22:15:09 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:15:09 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:15:09 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:15:09 INFO: patch_path: logs/mnist/cnn_adv_00/20200527_16:34:47:996346_/train/saved_patch.png
2020-06-26 22:15:09 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:15:09 INFO: Using dataset: svhn
2020-06-26 22:15:09 INFO: BUILD TEST GRAPH
2020-06-26 22:15:09 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:15:09 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:15:09 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:15:09 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:15:10 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:15:10 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:15:10 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:15:10 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:15:10 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:15:10 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:15:11 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:15:11 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:15:11 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:15:12 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:15:12 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:15:12 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:15:12 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:15:12 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:15:12 INFO: patch_path: logs/mnist/cnn_adv_05/20200527_16:34:47:994302_/train/saved_patch.png
2020-06-26 22:15:12 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:15:12 INFO: Using dataset: svhn
2020-06-26 22:15:13 INFO: BUILD TEST GRAPH
2020-06-26 22:15:13 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:15:13 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:15:13 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:15:13 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:15:13 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:15:13 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:15:13 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[{{node save/Assign_21}}]]
	 [[save/RestoreV2/_110]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[{{node save/Assign_21}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[node save/Assign_21 (defined at inspect_results.py:173) ]]
	 [[save/RestoreV2/_110]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[node save/Assign_21 (defined at inspect_results.py:173) ]]
0 successful operations.
0 derived errors ignored.

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_21:
 alexnet_v2/conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:340)

Input Source operations connected to node save/Assign_21:
 alexnet_v2/conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:340)

Original stack trace for 'save/Assign_21':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[node save/Assign_21 (defined at inspect_results.py:173) ]]
	 [[save/RestoreV2/_110]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[node save/Assign_21 (defined at inspect_results.py:173) ]]
0 successful operations.
0 derived errors ignored.

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_21:
 alexnet_v2/conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:340)

Input Source operations connected to node save/Assign_21:
 alexnet_v2/conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:340)

Original stack trace for 'save/Assign_21':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:15:13 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:15:13 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:15:13 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:15:14 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:15:14 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:15:14 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:15:14 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:15:14 INFO: patch_path: logs/mnist/cnn_adv_10/20200527_16:34:47:997005_/train/saved_patch.png
2020-06-26 22:15:14 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:15:15 INFO: Using dataset: svhn
2020-06-26 22:15:15 INFO: BUILD TEST GRAPH
2020-06-26 22:15:15 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:15:15 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:15:15 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:15:15 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:15:15 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:15:15 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:15:15 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:15:15 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:15:15 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:15:15 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:15:15 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:15:15 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:15:15 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:15:15 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:15:16 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:15:16 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:15:16 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[{{node save/Assign_55}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:15:17 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:15:17 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:15:17 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:15:17 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:15:17 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:15:17 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:15:17 INFO: patch_path: logs/mnist/cnn_adv_15/20200527_16:34:58:043767_/train/saved_patch.png
2020-06-26 22:15:17 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:15:17 INFO: Using dataset: svhn
2020-06-26 22:15:17 INFO: BUILD TEST GRAPH
2020-06-26 22:15:17 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:15:17 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:15:17 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:15:17 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:15:18 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:15:18 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:15:18 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:15:18 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:15:18 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:15:18 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[{{node save/Assign_21}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[node save/Assign_21 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_21:
 alexnet_v2/conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:340)

Original stack trace for 'save/Assign_21':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[node save/Assign_21 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_21:
 alexnet_v2/conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:340)

Original stack trace for 'save/Assign_21':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:15:18 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:15:18 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:15:18 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:15:18 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:15:18 INFO: patch_path: logs/mnist/cnn_adv_20/20200527_16:35:32:993726_/train/saved_patch.png
2020-06-26 22:15:18 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:15:18 INFO: Using dataset: svhn
2020-06-26 22:15:18 INFO: BUILD TEST GRAPH
2020-06-26 22:15:18 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:15:18 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:15:18 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:15:18 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:15:19 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:15:19 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:15:19 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:15:19 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:15:19 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:15:19 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:15:19 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:15:19 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:15:19 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:15:20 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:15:20 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:15:20 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:15:20 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:15:21 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:15:21 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:15:21 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [150528] rhs shape= [50176]
	 [[{{node save/Assign_54}}]]
	 [[save/RestoreV2/_68]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [150528] rhs shape= [50176]
	 [[{{node save/Assign_54}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [150528] rhs shape= [50176]
	 [[node save/Assign_54 (defined at inspect_results.py:173) ]]
	 [[save/RestoreV2/_68]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [150528] rhs shape= [50176]
	 [[node save/Assign_54 (defined at inspect_results.py:173) ]]
0 successful operations.
0 derived errors ignored.

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_54:
 class_output/biases (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Input Source operations connected to node save/Assign_54:
 class_output/biases (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_54':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [150528] rhs shape= [50176]
	 [[node save/Assign_54 (defined at inspect_results.py:173) ]]
	 [[save/RestoreV2/_68]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [150528] rhs shape= [50176]
	 [[node save/Assign_54 (defined at inspect_results.py:173) ]]
0 successful operations.
0 derived errors ignored.

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_54:
 class_output/biases (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Input Source operations connected to node save/Assign_54:
 class_output/biases (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_54':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:15:21 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:15:21 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:15:21 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:15:21 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:15:21 INFO: patch_path: logs/mnist/cnn_adv_25/20200527_16:36:01:629416_/train/saved_patch.png
2020-06-26 22:15:21 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:15:21 INFO: Using dataset: svhn
2020-06-26 22:15:21 INFO: BUILD TEST GRAPH
2020-06-26 22:15:21 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:15:21 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:15:21 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:15:22 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:15:22 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[{{node save/Assign_55}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:15:22 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:15:22 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:15:22 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:15:22 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:15:22 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:15:22 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:15:22 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:15:22 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:15:22 INFO: patch_path: logs/mnist/cnn_adv_35/20200527_16:35:47:661453_/train/saved_patch.png
2020-06-26 22:15:22 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:15:22 INFO: Using dataset: svhn
2020-06-26 22:15:22 INFO: BUILD TEST GRAPH
2020-06-26 22:15:22 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:15:22 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:15:22 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:15:22 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:15:22 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:15:22 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:15:22 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:15:22 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:15:22 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:15:22 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:15:23 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:15:23 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:15:23 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:15:24 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:15:24 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:15:24 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:15:24 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:15:24 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:15:24 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:15:24 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:15:24 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:15:25 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[{{node save/Assign_21}}]]
	 [[save/RestoreV2/_62]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[{{node save/Assign_21}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[node save/Assign_21 (defined at inspect_results.py:173) ]]
	 [[save/RestoreV2/_62]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[node save/Assign_21 (defined at inspect_results.py:173) ]]
0 successful operations.
0 derived errors ignored.

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_21:
 alexnet_v2/conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:340)

Input Source operations connected to node save/Assign_21:
 alexnet_v2/conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:340)

Original stack trace for 'save/Assign_21':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[node save/Assign_21 (defined at inspect_results.py:173) ]]
	 [[save/RestoreV2/_62]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[node save/Assign_21 (defined at inspect_results.py:173) ]]
0 successful operations.
0 derived errors ignored.

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_21:
 alexnet_v2/conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:340)

Input Source operations connected to node save/Assign_21:
 alexnet_v2/conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:340)

Original stack trace for 'save/Assign_21':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:15:25 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[{{node save/Assign_21}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[node save/Assign_21 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_21:
 alexnet_v2/conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:340)

Original stack trace for 'save/Assign_21':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[node save/Assign_21 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_21:
 alexnet_v2/conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:340)

Original stack trace for 'save/Assign_21':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:15:25 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:15:25 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:15:26 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:15:26 INFO: patch_path: logs/mnist/cnn_adv_40/20200527_16:36:32:555527_/train/saved_patch.png
2020-06-26 22:15:26 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:15:26 INFO: Using dataset: svhn
2020-06-26 22:15:26 INFO: BUILD TEST GRAPH
2020-06-26 22:15:26 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:15:26 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:15:26 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:15:26 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:15:26 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:15:26 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:15:26 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:15:26 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:15:26 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:15:26 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:15:27 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:15:27 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:15:27 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:15:27 INFO: patch_path: logs/mnist/cnn_adv_45/20200527_18:00:37:576002_/train/saved_patch.png
2020-06-26 22:15:27 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:15:27 INFO: Using dataset: svhn
2020-06-26 22:15:27 INFO: BUILD TEST GRAPH
2020-06-26 22:15:27 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:15:27 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:15:27 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:15:27 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:15:27 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:15:27 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:15:27 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:15:27 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:15:27 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:15:27 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:15:27 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:15:28 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:15:28 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:15:28 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:15:28 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:15:28 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:15:29 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:15:29 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[{{node save/Assign_55}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:15:29 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:15:29 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:15:29 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:15:29 INFO: patch_path: logs/mnist/cnn_adv_50/20200527_18:23:40:836667_/train/saved_patch.png
2020-06-26 22:15:29 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:15:29 INFO: Using dataset: svhn
2020-06-26 22:15:29 INFO: BUILD TEST GRAPH
2020-06-26 22:15:29 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:15:29 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:15:29 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:15:29 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:15:29 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:15:29 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:15:29 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:15:29 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:15:29 INFO: patch_path: logs/mnist/cnn_adv_hun/20200527_23:10:16:004782_/train/saved_patch.png
2020-06-26 22:15:29 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:15:29 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:15:29 INFO: Using dataset: svhn
2020-06-26 22:15:29 INFO: BUILD TEST GRAPH
2020-06-26 22:15:29 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:15:29 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:15:30 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:15:30 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:15:30 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:15:30 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:15:30 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:15:30 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:15:30 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:15:30 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:15:30 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:15:30 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:15:30 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:15:30 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:15:30 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:15:30 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:15:31 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[{{node save/Assign_21}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[node save/Assign_21 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_21:
 alexnet_v2/conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:340)

Original stack trace for 'save/Assign_21':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[node save/Assign_21 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_21:
 alexnet_v2/conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:340)

Original stack trace for 'save/Assign_21':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:15:31 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:15:31 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:15:31 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:15:31 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:15:31 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:15:31 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:15:31 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:15:31 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:15:31 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:15:32 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:15:32 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [150528] rhs shape= [50176]
	 [[{{node save/Assign_54}}]]
	 [[save/RestoreV2/_70]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [150528] rhs shape= [50176]
	 [[{{node save/Assign_54}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [150528] rhs shape= [50176]
	 [[node save/Assign_54 (defined at inspect_results.py:173) ]]
	 [[save/RestoreV2/_70]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [150528] rhs shape= [50176]
	 [[node save/Assign_54 (defined at inspect_results.py:173) ]]
0 successful operations.
0 derived errors ignored.

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_54:
 class_output/biases (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Input Source operations connected to node save/Assign_54:
 class_output/biases (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_54':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [150528] rhs shape= [50176]
	 [[node save/Assign_54 (defined at inspect_results.py:173) ]]
	 [[save/RestoreV2/_70]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [150528] rhs shape= [50176]
	 [[node save/Assign_54 (defined at inspect_results.py:173) ]]
0 successful operations.
0 derived errors ignored.

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_54:
 class_output/biases (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Input Source operations connected to node save/Assign_54:
 class_output/biases (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_54':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:15:32 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[{{node save/Assign_21}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[node save/Assign_21 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_21:
 alexnet_v2/conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:340)

Original stack trace for 'save/Assign_21':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[node save/Assign_21 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_21:
 alexnet_v2/conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:340)

Original stack trace for 'save/Assign_21':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:15:33 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:15:33 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:15:33 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:15:33 INFO: patch_path: logs/mnist/cnn_adv_ten/20200527_18:31:49:489118_/train/saved_patch.png
2020-06-26 22:15:33 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:15:33 INFO: Using dataset: svhn
2020-06-26 22:15:33 INFO: BUILD TEST GRAPH
2020-06-26 22:15:33 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:15:34 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:15:34 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:15:34 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:15:34 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:15:34 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:15:34 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:15:34 INFO: patch_path: logs/mnist/cnn_adv_tho/20200527_23:10:14:955484_/train/saved_patch.png
2020-06-26 22:15:34 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:15:34 INFO: Using dataset: svhn
2020-06-26 22:15:34 INFO: BUILD TEST GRAPH
2020-06-26 22:15:34 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:15:34 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:15:34 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:15:34 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:15:34 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:15:34 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:15:34 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:15:34 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:15:34 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:15:34 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:15:34 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:15:34 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:15:34 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:15:34 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:15:34 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:15:34 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:15:35 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:15:35 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:15:35 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:15:35 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:15:36 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:15:36 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:15:36 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:15:36 INFO: patch_path: logs/mnist/cnn_adv_tnk/20200527_23:12:21:154178_/train/saved_patch.png
2020-06-26 22:15:36 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:15:36 INFO: Using dataset: svhn
2020-06-26 22:15:36 INFO: BUILD TEST GRAPH
2020-06-26 22:15:36 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:15:36 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:15:36 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:15:36 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:15:37 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:15:37 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:15:37 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:15:37 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:15:37 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:15:37 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:15:37 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:15:37 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:15:37 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:15:38 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:15:38 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[{{node save/Assign_55}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:15:38 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[{{node save/Assign_55}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:15:38 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:15:38 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:15:39 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:15:39 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:15:39 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:15:40 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[{{node save/Assign_21}}]]
	 [[save/RestoreV2/_60]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[{{node save/Assign_21}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[node save/Assign_21 (defined at inspect_results.py:173) ]]
	 [[save/RestoreV2/_60]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[node save/Assign_21 (defined at inspect_results.py:173) ]]
0 successful operations.
0 derived errors ignored.

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_21:
 alexnet_v2/conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:340)

Input Source operations connected to node save/Assign_21:
 alexnet_v2/conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:340)

Original stack trace for 'save/Assign_21':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[node save/Assign_21 (defined at inspect_results.py:173) ]]
	 [[save/RestoreV2/_60]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[node save/Assign_21 (defined at inspect_results.py:173) ]]
0 successful operations.
0 derived errors ignored.

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_21:
 alexnet_v2/conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:340)

Input Source operations connected to node save/Assign_21:
 alexnet_v2/conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:340)

Original stack trace for 'save/Assign_21':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:15:50 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:15:50 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:15:50 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:15:50 INFO: patch_path: logs/mnist/cnn_adv_30/20200527_16:35:49:450593_/train/saved_patch.png
2020-06-26 22:15:50 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:15:50 INFO: Using dataset: svhn
2020-06-26 22:15:50 INFO: BUILD TEST GRAPH
2020-06-26 22:15:50 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:15:50 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:15:50 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:15:50 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:15:51 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:15:51 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:15:51 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:15:51 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:15:51 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:15:51 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:15:52 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:15:52 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:15:53 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:15:53 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:15:53 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:15:55 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [150528] rhs shape= [50176]
	 [[{{node save/Assign_54}}]]
	 [[save/RestoreV2/_104]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [150528] rhs shape= [50176]
	 [[{{node save/Assign_54}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [150528] rhs shape= [50176]
	 [[node save/Assign_54 (defined at inspect_results.py:173) ]]
	 [[save/RestoreV2/_104]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [150528] rhs shape= [50176]
	 [[node save/Assign_54 (defined at inspect_results.py:173) ]]
0 successful operations.
0 derived errors ignored.

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_54:
 class_output/biases (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Input Source operations connected to node save/Assign_54:
 class_output/biases (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_54':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [150528] rhs shape= [50176]
	 [[node save/Assign_54 (defined at inspect_results.py:173) ]]
	 [[save/RestoreV2/_104]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [150528] rhs shape= [50176]
	 [[node save/Assign_54 (defined at inspect_results.py:173) ]]
0 successful operations.
0 derived errors ignored.

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_54:
 class_output/biases (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Input Source operations connected to node save/Assign_54:
 class_output/biases (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_54':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:33:21 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:33:21 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:33:21 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:33:21 INFO: patch_path: logs/mnist/cnn_adv_00/20200527_16:34:47:996346_/train/saved_patch.png
2020-06-26 22:33:21 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:33:21 INFO: Using dataset: svhn
2020-06-26 22:33:21 INFO: BUILD TEST GRAPH
2020-06-26 22:33:21 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:33:21 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:33:21 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:33:21 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:33:21 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:33:21 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:33:21 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:33:21 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:33:21 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:33:21 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:33:22 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:33:22 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:33:23 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:33:23 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:33:23 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:33:24 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[{{node save/Assign_21}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[node save/Assign_21 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_21:
 alexnet_v2/conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:340)

Original stack trace for 'save/Assign_21':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[node save/Assign_21 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_21:
 alexnet_v2/conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:340)

Original stack trace for 'save/Assign_21':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:33:29 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:33:29 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:33:29 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:33:29 INFO: patch_path: logs/mnist/cnn_adv_05/20200527_16:34:47:994302_/train/saved_patch.png
2020-06-26 22:33:29 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:33:29 INFO: Using dataset: svhn
2020-06-26 22:33:29 INFO: BUILD TEST GRAPH
2020-06-26 22:33:29 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:33:29 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:33:29 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:33:29 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:33:29 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:33:29 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:33:29 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:33:29 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:33:29 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:33:29 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:33:30 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:33:30 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:33:30 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:33:30 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:33:30 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:33:31 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[{{node save/Assign_21}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[node save/Assign_21 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_21:
 alexnet_v2/conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:340)

Original stack trace for 'save/Assign_21':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[node save/Assign_21 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_21:
 alexnet_v2/conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:340)

Original stack trace for 'save/Assign_21':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:33:36 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:33:36 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:33:36 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:33:36 INFO: patch_path: logs/mnist/cnn_adv_10/20200527_16:34:47:997005_/train/saved_patch.png
2020-06-26 22:33:36 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:33:36 INFO: Using dataset: svhn
2020-06-26 22:33:36 INFO: BUILD TEST GRAPH
2020-06-26 22:33:36 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:33:36 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:33:36 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:33:36 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:33:36 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:33:36 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:33:36 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:33:36 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:33:36 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:33:37 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:33:37 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:33:37 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:33:38 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:33:38 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:33:38 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:33:39 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[{{node save/Assign_55}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:33:43 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:33:43 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:33:43 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:33:43 INFO: patch_path: logs/mnist/cnn_adv_15/20200527_16:34:58:043767_/train/saved_patch.png
2020-06-26 22:33:43 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:33:43 INFO: Using dataset: svhn
2020-06-26 22:33:43 INFO: BUILD TEST GRAPH
2020-06-26 22:33:43 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:33:43 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:33:43 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:33:43 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:33:44 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:33:44 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:33:44 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:33:44 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:33:44 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:33:44 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:33:45 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:33:45 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:33:45 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:33:45 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:33:45 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:33:46 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[{{node save/Assign_55}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:33:51 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:33:51 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:33:51 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:33:51 INFO: patch_path: logs/mnist/cnn_adv_20/20200527_16:35:32:993726_/train/saved_patch.png
2020-06-26 22:33:51 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:33:51 INFO: Using dataset: svhn
2020-06-26 22:33:51 INFO: BUILD TEST GRAPH
2020-06-26 22:33:51 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:33:51 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:33:51 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:33:51 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:33:51 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:33:51 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:33:51 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:33:51 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:33:51 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:33:51 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:33:52 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:33:52 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:33:53 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:33:53 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:33:53 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:33:54 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[{{node save/Assign_55}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:33:58 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:33:58 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:33:58 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:33:58 INFO: patch_path: logs/mnist/cnn_adv_25/20200527_16:36:01:629416_/train/saved_patch.png
2020-06-26 22:33:58 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:33:58 INFO: Using dataset: svhn
2020-06-26 22:33:58 INFO: BUILD TEST GRAPH
2020-06-26 22:33:58 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:33:58 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:33:58 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:33:58 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:33:59 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:33:59 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:33:59 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:33:59 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:33:59 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:33:59 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:34:00 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:34:00 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:34:00 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:34:00 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:34:00 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:34:01 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[{{node save/Assign_55}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:34:06 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:34:06 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:34:06 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:34:06 INFO: patch_path: logs/mnist/cnn_adv_30/20200527_16:35:49:450593_/train/saved_patch.png
2020-06-26 22:34:06 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:34:06 INFO: Using dataset: svhn
2020-06-26 22:34:06 INFO: BUILD TEST GRAPH
2020-06-26 22:34:06 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:34:06 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:34:06 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:34:06 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:34:06 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:34:06 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:34:06 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:34:06 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:34:06 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:34:06 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:34:07 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:34:07 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:34:08 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:34:08 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:34:08 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:34:09 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[{{node save/Assign_55}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:34:13 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:34:13 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:34:13 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:34:13 INFO: patch_path: logs/mnist/cnn_adv_35/20200527_16:35:47:661453_/train/saved_patch.png
2020-06-26 22:34:13 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:34:13 INFO: Using dataset: svhn
2020-06-26 22:34:13 INFO: BUILD TEST GRAPH
2020-06-26 22:34:13 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:34:13 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:34:13 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:34:13 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:34:14 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:34:14 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:34:14 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:34:14 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:34:14 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:34:14 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:34:15 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:34:15 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:34:15 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:34:15 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:34:15 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:34:16 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[{{node save/Assign_55}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:34:21 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:34:21 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:34:21 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:34:21 INFO: patch_path: logs/mnist/cnn_adv_40/20200527_16:36:32:555527_/train/saved_patch.png
2020-06-26 22:34:21 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:34:21 INFO: Using dataset: svhn
2020-06-26 22:34:21 INFO: BUILD TEST GRAPH
2020-06-26 22:34:21 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:34:21 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:34:21 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:34:21 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:34:21 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:34:21 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:34:21 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:34:21 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:34:21 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:34:22 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:34:22 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:34:22 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:34:23 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:34:23 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:34:23 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:34:24 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[{{node save/Assign_55}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:34:29 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:34:29 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:34:29 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:34:29 INFO: patch_path: logs/mnist/cnn_adv_45/20200527_18:00:37:576002_/train/saved_patch.png
2020-06-26 22:34:29 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:34:29 INFO: Using dataset: svhn
2020-06-26 22:34:29 INFO: BUILD TEST GRAPH
2020-06-26 22:34:29 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:34:29 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:34:29 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:34:29 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:34:29 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:34:29 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:34:29 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:34:29 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:34:29 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:34:29 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:34:30 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:34:30 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:34:30 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:34:30 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:34:30 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:34:31 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[{{node save/Assign_55}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:34:36 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:34:36 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:34:36 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:34:36 INFO: patch_path: logs/mnist/cnn_adv_50/20200527_18:23:40:836667_/train/saved_patch.png
2020-06-26 22:34:36 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:34:36 INFO: Using dataset: svhn
2020-06-26 22:34:36 INFO: BUILD TEST GRAPH
2020-06-26 22:34:36 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:34:36 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:34:36 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:34:36 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:34:36 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:34:36 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:34:36 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:34:36 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:34:36 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:34:37 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:34:37 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:34:37 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:34:38 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:34:38 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:34:38 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:34:39 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[{{node save/Assign_55}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:34:43 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:34:43 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:34:43 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:34:43 INFO: patch_path: logs/mnist/cnn_adv_hun/20200527_23:10:16:004782_/train/saved_patch.png
2020-06-26 22:34:43 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:34:43 INFO: Using dataset: svhn
2020-06-26 22:34:43 INFO: BUILD TEST GRAPH
2020-06-26 22:34:43 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:34:43 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:34:43 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:34:43 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:34:44 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:34:44 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:34:44 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:34:44 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:34:44 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:34:44 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:34:45 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:34:45 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:34:45 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:34:45 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:34:45 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:34:46 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[{{node save/Assign_55}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:34:51 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:34:51 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:34:51 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:34:51 INFO: patch_path: logs/mnist/cnn_adv_ten/20200527_18:31:49:489118_/train/saved_patch.png
2020-06-26 22:34:51 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:34:51 INFO: Using dataset: svhn
2020-06-26 22:34:51 INFO: BUILD TEST GRAPH
2020-06-26 22:34:51 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:34:51 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:34:51 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:34:51 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:34:51 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:34:51 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:34:51 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:34:51 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:34:51 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:34:51 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:34:52 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:34:52 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:34:52 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:34:53 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:34:53 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:34:54 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[{{node save/Assign_55}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:34:58 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:34:58 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:34:58 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:34:58 INFO: patch_path: logs/mnist/cnn_adv_tho/20200527_23:10:14:955484_/train/saved_patch.png
2020-06-26 22:34:58 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:34:58 INFO: Using dataset: svhn
2020-06-26 22:34:58 INFO: BUILD TEST GRAPH
2020-06-26 22:34:58 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:34:58 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:34:58 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:34:58 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:34:58 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:34:58 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:34:58 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:34:58 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:34:58 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:34:59 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:35:00 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:35:00 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:35:00 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:35:00 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:35:00 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:35:01 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[{{node save/Assign_55}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [1024,150528] rhs shape= [1024,50176]
	 [[node save/Assign_55 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_55:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:384)

Original stack trace for 'save/Assign_55':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:35:06 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:35:06 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:35:06 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:35:06 INFO: patch_path: logs/mnist/cnn_adv_tnk/20200527_23:12:21:154178_/train/saved_patch.png
2020-06-26 22:35:06 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:35:06 INFO: Using dataset: svhn
2020-06-26 22:35:06 INFO: BUILD TEST GRAPH
2020-06-26 22:35:06 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:35:06 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:35:06 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:35:06 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:35:06 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:35:06 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:35:06 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:35:06 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:35:06 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:35:06 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:35:07 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:35:07 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:35:07 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:35:07 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:35:07 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:35:08 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[{{node save/Assign_21}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[node save/Assign_21 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_21:
 alexnet_v2/conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:340)

Original stack trace for 'save/Assign_21':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [11,11,3,64] rhs shape= [11,11,1,64]
	 [[node save/Assign_21 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_21:
 alexnet_v2/conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:340)

Original stack trace for 'save/Assign_21':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:54:56 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:54:56 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:54:56 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:54:56 INFO: patch_path: logs/mnist/cnn_adv_00/20200527_16:34:47:996346_/train/saved_patch.png
2020-06-26 22:54:56 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:54:56 INFO: Using dataset: mnist
2020-06-26 22:54:56 INFO: BUILD TEST GRAPH
2020-06-26 22:54:56 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:54:56 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:54:56 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-06-26 22:54:56 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-06-26 22:54:56 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-06-26 22:54:57 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:54:57 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:54:57 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:54:57 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:54:57 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:54:57 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:54:58 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:54:58 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:54:58 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:54:58 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:54:58 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:56:35 INFO: writing to csv
2020-06-26 22:56:36 INFO: csv saved at logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test/logs_mnist_cnn_adv_00_20200527_16_34_47_996346__train_saved_patch_png_test.csv
2020-06-26 22:56:42 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:56:42 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:56:42 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:56:42 INFO: patch_path: logs/mnist/cnn_adv_05/20200527_16:34:47:994302_/train/saved_patch.png
2020-06-26 22:56:42 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:56:42 INFO: Using dataset: mnist
2020-06-26 22:56:42 INFO: BUILD TEST GRAPH
2020-06-26 22:56:42 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:56:42 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:56:42 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-06-26 22:56:42 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-06-26 22:56:42 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-06-26 22:56:42 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:56:42 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:56:42 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:56:42 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:56:42 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:56:42 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:56:43 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:56:43 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:56:44 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:56:44 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:56:44 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 22:58:20 INFO: writing to csv
2020-06-26 22:58:21 INFO: csv saved at logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test/logs_mnist_cnn_adv_05_20200527_16_34_47_994302__train_saved_patch_png_test.csv
2020-06-26 22:58:26 INFO: name: 20200507_14:21:23:955910_
2020-06-26 22:58:26 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 22:58:26 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 22:58:26 INFO: patch_path: logs/mnist/cnn_adv_10/20200527_16:34:47:997005_/train/saved_patch.png
2020-06-26 22:58:26 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 22:58:26 INFO: Using dataset: mnist
2020-06-26 22:58:26 INFO: BUILD TEST GRAPH
2020-06-26 22:58:26 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:58:26 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:58:26 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-06-26 22:58:26 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-06-26 22:58:26 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-06-26 22:58:26 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:58:26 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:58:26 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:58:26 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:58:26 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:58:26 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 22:58:27 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:58:27 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:58:28 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:58:28 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:58:28 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 23:00:04 INFO: writing to csv
2020-06-26 23:00:05 INFO: csv saved at logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test/logs_mnist_cnn_adv_10_20200527_16_34_47_997005__train_saved_patch_png_test.csv
2020-06-26 23:00:10 INFO: name: 20200507_14:21:23:955910_
2020-06-26 23:00:10 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 23:00:10 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 23:00:10 INFO: patch_path: logs/mnist/cnn_adv_15/20200527_16:34:58:043767_/train/saved_patch.png
2020-06-26 23:00:10 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 23:00:10 INFO: Using dataset: mnist
2020-06-26 23:00:10 INFO: BUILD TEST GRAPH
2020-06-26 23:00:10 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 23:00:10 INFO: Overwrite dataset info from restored data version.
2020-06-26 23:00:10 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-06-26 23:00:10 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-06-26 23:00:10 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-06-26 23:00:10 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 23:00:10 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 23:00:10 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 23:00:10 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 23:00:10 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 23:00:11 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 23:00:12 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 23:00:12 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 23:00:12 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 23:00:12 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 23:00:12 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 23:01:48 INFO: writing to csv
2020-06-26 23:01:49 INFO: csv saved at logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test/logs_mnist_cnn_adv_15_20200527_16_34_58_043767__train_saved_patch_png_test.csv
2020-06-26 23:01:54 INFO: name: 20200507_14:21:23:955910_
2020-06-26 23:01:54 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 23:01:54 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 23:01:55 INFO: patch_path: logs/mnist/cnn_adv_25/20200527_16:36:01:629416_/train/saved_patch.png
2020-06-26 23:01:55 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 23:01:55 INFO: Using dataset: mnist
2020-06-26 23:01:55 INFO: BUILD TEST GRAPH
2020-06-26 23:01:55 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 23:01:55 INFO: Overwrite dataset info from restored data version.
2020-06-26 23:01:55 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-06-26 23:01:55 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-06-26 23:01:55 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-06-26 23:01:55 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 23:01:55 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 23:01:55 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 23:01:55 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 23:01:55 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 23:01:55 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 23:01:56 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 23:01:56 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 23:01:57 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 23:01:57 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 23:01:57 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 23:02:28 INFO: name: 20200507_14:21:23:955910_
2020-06-26 23:02:28 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 23:02:28 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 23:02:28 INFO: patch_path: logs/mnist/cnn_adv_20/20200527_16:35:32:993726_/train/saved_patch.png
2020-06-26 23:02:28 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 23:02:28 INFO: Using dataset: mnist
2020-06-26 23:02:28 INFO: BUILD TEST GRAPH
2020-06-26 23:02:29 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 23:02:29 INFO: Overwrite dataset info from restored data version.
2020-06-26 23:02:29 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-06-26 23:02:29 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-06-26 23:02:29 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-06-26 23:02:29 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 23:02:29 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 23:02:29 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 23:02:29 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 23:02:29 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 23:02:29 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 23:02:30 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 23:02:30 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 23:02:31 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 23:02:31 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 23:02:31 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 23:03:33 INFO: writing to csv
2020-06-26 23:03:33 INFO: csv saved at logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test/logs_mnist_cnn_adv_25_20200527_16_36_01_629416__train_saved_patch_png_test.csv
2020-06-26 23:03:39 INFO: name: 20200507_14:21:23:955910_
2020-06-26 23:03:39 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 23:03:39 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 23:03:39 INFO: patch_path: logs/mnist/cnn_adv_30/20200527_16:35:49:450593_/train/saved_patch.png
2020-06-26 23:03:39 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 23:03:39 INFO: Using dataset: mnist
2020-06-26 23:03:39 INFO: BUILD TEST GRAPH
2020-06-26 23:03:39 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 23:03:39 INFO: Overwrite dataset info from restored data version.
2020-06-26 23:03:39 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-06-26 23:03:39 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-06-26 23:03:39 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-06-26 23:03:39 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 23:03:39 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 23:03:39 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 23:03:39 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 23:03:39 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 23:03:40 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 23:03:41 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 23:03:41 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 23:03:41 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 23:03:41 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 23:03:41 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 23:04:09 INFO: writing to csv
2020-06-26 23:04:09 INFO: csv saved at logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test/logs_mnist_cnn_adv_20_20200527_16_35_32_993726__train_saved_patch_png_test.csv
2020-06-26 23:04:16 INFO: name: 20200507_14:21:23:955910_
2020-06-26 23:04:16 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 23:04:16 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 23:04:16 INFO: patch_path: logs/mnist/cnn_adv_35/20200527_16:35:47:661453_/train/saved_patch.png
2020-06-26 23:04:16 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 23:04:16 INFO: Using dataset: mnist
2020-06-26 23:04:16 INFO: BUILD TEST GRAPH
2020-06-26 23:04:16 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 23:04:16 INFO: Overwrite dataset info from restored data version.
2020-06-26 23:04:16 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-06-26 23:04:16 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-06-26 23:04:16 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-06-26 23:04:16 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 23:04:16 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 23:04:16 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 23:04:16 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 23:04:16 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 23:04:17 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 23:04:18 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 23:04:18 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 23:04:18 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 23:04:18 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 23:04:18 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 23:05:17 INFO: writing to csv
2020-06-26 23:05:17 INFO: csv saved at logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test/logs_mnist_cnn_adv_30_20200527_16_35_49_450593__train_saved_patch_png_test.csv
2020-06-26 23:05:23 INFO: name: 20200507_14:21:23:955910_
2020-06-26 23:05:23 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 23:05:23 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 23:05:23 INFO: patch_path: logs/mnist/cnn_adv_40/20200527_16:36:32:555527_/train/saved_patch.png
2020-06-26 23:05:23 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 23:05:23 INFO: Using dataset: mnist
2020-06-26 23:05:23 INFO: BUILD TEST GRAPH
2020-06-26 23:05:23 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 23:05:23 INFO: Overwrite dataset info from restored data version.
2020-06-26 23:05:23 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-06-26 23:05:23 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-06-26 23:05:24 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-06-26 23:05:24 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 23:05:24 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 23:05:24 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 23:05:24 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 23:05:24 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 23:05:24 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 23:05:25 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 23:05:25 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 23:05:25 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 23:05:26 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 23:05:26 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 23:05:56 INFO: writing to csv
2020-06-26 23:05:56 INFO: csv saved at logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test/logs_mnist_cnn_adv_35_20200527_16_35_47_661453__train_saved_patch_png_test.csv
2020-06-26 23:06:01 INFO: name: 20200507_14:21:23:955910_
2020-06-26 23:06:01 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 23:06:01 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 23:06:01 INFO: patch_path: logs/mnist/cnn_adv_45/20200527_18:00:37:576002_/train/saved_patch.png
2020-06-26 23:06:01 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 23:06:01 INFO: Using dataset: mnist
2020-06-26 23:06:01 INFO: BUILD TEST GRAPH
2020-06-26 23:06:01 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 23:06:01 INFO: Overwrite dataset info from restored data version.
2020-06-26 23:06:02 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-06-26 23:06:02 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-06-26 23:06:02 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-06-26 23:06:02 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 23:06:02 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 23:06:02 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 23:06:02 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 23:06:02 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 23:06:02 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 23:06:03 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 23:06:03 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 23:06:04 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 23:06:04 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 23:06:04 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 23:07:02 INFO: writing to csv
2020-06-26 23:07:02 INFO: csv saved at logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test/logs_mnist_cnn_adv_40_20200527_16_36_32_555527__train_saved_patch_png_test.csv
2020-06-26 23:07:08 INFO: name: 20200507_14:21:23:955910_
2020-06-26 23:07:08 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 23:07:08 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 23:07:08 INFO: patch_path: logs/mnist/cnn_adv_50/20200527_18:23:40:836667_/train/saved_patch.png
2020-06-26 23:07:08 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 23:07:08 INFO: Using dataset: mnist
2020-06-26 23:07:08 INFO: BUILD TEST GRAPH
2020-06-26 23:07:08 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 23:07:08 INFO: Overwrite dataset info from restored data version.
2020-06-26 23:07:08 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-06-26 23:07:08 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-06-26 23:07:08 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-06-26 23:07:08 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 23:07:08 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 23:07:08 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 23:07:08 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 23:07:08 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 23:07:08 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 23:07:09 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 23:07:09 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 23:07:10 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 23:07:10 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 23:07:10 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 23:07:41 INFO: writing to csv
2020-06-26 23:07:42 INFO: csv saved at logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test/logs_mnist_cnn_adv_45_20200527_18_00_37_576002__train_saved_patch_png_test.csv
2020-06-26 23:07:48 INFO: name: 20200507_14:21:23:955910_
2020-06-26 23:07:48 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 23:07:48 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 23:07:48 INFO: patch_path: logs/mnist/cnn_adv_hun/20200527_23:10:16:004782_/train/saved_patch.png
2020-06-26 23:07:48 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 23:07:48 INFO: Using dataset: mnist
2020-06-26 23:07:48 INFO: BUILD TEST GRAPH
2020-06-26 23:07:48 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 23:07:48 INFO: Overwrite dataset info from restored data version.
2020-06-26 23:07:48 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-06-26 23:07:48 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-06-26 23:07:48 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-06-26 23:07:48 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 23:07:48 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 23:07:48 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 23:07:48 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 23:07:48 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 23:07:49 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 23:07:50 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 23:07:50 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 23:07:50 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 23:07:50 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 23:07:50 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 23:08:33 INFO: name: 20200507_14:21:23:955910_
2020-06-26 23:08:33 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 23:08:33 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 23:08:33 INFO: patch_path: logs/mnist/cnn_adv_ten/20200527_18:31:49:489118_/train/saved_patch.png
2020-06-26 23:08:33 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 23:08:33 INFO: Using dataset: mnist
2020-06-26 23:08:33 INFO: BUILD TEST GRAPH
2020-06-26 23:08:33 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 23:08:33 INFO: Overwrite dataset info from restored data version.
2020-06-26 23:08:33 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-06-26 23:08:33 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-06-26 23:08:33 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-06-26 23:08:34 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 23:08:34 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 23:08:34 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 23:08:34 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 23:08:34 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 23:08:35 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 23:08:35 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 23:08:36 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 23:08:36 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 23:08:36 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 23:08:36 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 23:08:46 INFO: writing to csv
2020-06-26 23:08:46 INFO: csv saved at logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test/logs_mnist_cnn_adv_50_20200527_18_23_40_836667__train_saved_patch_png_test.csv
2020-06-26 23:08:51 INFO: name: 20200507_14:21:23:955910_
2020-06-26 23:08:51 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 23:08:51 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 23:08:51 INFO: patch_path: logs/mnist/cnn_adv_tho/20200527_23:10:14:955484_/train/saved_patch.png
2020-06-26 23:08:51 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 23:08:51 INFO: Using dataset: mnist
2020-06-26 23:08:51 INFO: BUILD TEST GRAPH
2020-06-26 23:08:51 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 23:08:51 INFO: Overwrite dataset info from restored data version.
2020-06-26 23:08:51 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-06-26 23:08:51 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-06-26 23:08:52 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-06-26 23:08:52 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 23:08:52 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 23:08:52 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 23:08:52 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 23:08:52 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 23:08:52 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 23:08:53 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 23:08:53 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 23:08:54 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 23:08:54 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 23:08:54 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 23:09:28 INFO: writing to csv
2020-06-26 23:09:28 INFO: csv saved at logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test/logs_mnist_cnn_adv_hun_20200527_23_10_16_004782__train_saved_patch_png_test.csv
2020-06-26 23:09:34 INFO: name: 20200507_14:21:23:955910_
2020-06-26 23:09:34 INFO: parent_dir: logs/mnist/cnn_low_lr
2020-06-26 23:09:34 INFO: test_dir: logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test
2020-06-26 23:09:34 INFO: patch_path: logs/mnist/cnn_adv_tnk/20200527_23:12:21:154178_/train/saved_patch.png
2020-06-26 23:09:34 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/params/params.json
2020-06-26 23:09:34 INFO: Using dataset: mnist
2020-06-26 23:09:34 INFO: BUILD TEST GRAPH
2020-06-26 23:09:34 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 23:09:34 INFO: Overwrite dataset info from restored data version.
2020-06-26 23:09:34 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-06-26 23:09:34 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-06-26 23:09:34 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-06-26 23:09:34 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 23:09:34 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 23:09:34 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 23:09:34 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 23:09:35 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 23:09:35 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/contrib/layers/python/layers/layers.py:1634: flatten (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.flatten instead.
2020-06-26 23:09:36 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/array_ops.py:1354: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 23:09:36 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 23:09:36 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 23:09:36 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 23:09:36 INFO: Restoring parameters from logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/train/checkpoint/model.ckpt30-51540
2020-06-26 23:10:17 INFO: writing to csv
2020-06-26 23:10:18 INFO: csv saved at logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test/logs_mnist_cnn_adv_ten_20200527_18_31_49_489118__train_saved_patch_png_test.csv
2020-06-26 23:10:30 INFO: writing to csv
2020-06-26 23:10:31 INFO: csv saved at logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test/logs_mnist_cnn_adv_tho_20200527_23_10_14_955484__train_saved_patch_png_test.csv
2020-06-26 23:11:14 INFO: writing to csv
2020-06-26 23:11:14 INFO: csv saved at logs/mnist/cnn_low_lr/20200507_14:21:23:955910_/test/logs_mnist_cnn_adv_tnk_20200527_23_12_21_154178__train_saved_patch_png_test.csv
