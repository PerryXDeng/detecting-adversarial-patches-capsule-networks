2020-06-26 22:13:52 INFO: name: 20200605_03:00:14:427684_
2020-06-26 22:13:52 INFO: parent_dir: logs/mnist/nomod_cap
2020-06-26 22:13:52 INFO: test_dir: logs/mnist/nomod_cap/20200605_03:00:14:427684_/test
2020-06-26 22:13:52 INFO: patch_path: logs/mnist/nomodcap_adv_00/20200613_17:57:35:190094_/train/saved_patch.png
2020-06-26 22:13:52 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/params/params.json
2020-06-26 22:13:52 INFO: Using dataset: svhn
2020-06-26 22:13:52 INFO: BUILD TEST GRAPH
2020-06-26 22:13:52 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:13:52 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:13:52 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:13:52 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:13:53 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:13:53 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:13:53 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:13:53 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:13:53 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:13:53 INFO: input shape: (64, 32, 32, 3)
2020-06-26 22:13:53 INFO: Scale of 0 disables regularizer.
2020-06-26 22:13:53 INFO: relu_conv1 output shape: (64, 16, 16, 64)
2020-06-26 22:13:53 INFO: primary_caps pose shape: (64, 16, 16, 8, 16)
2020-06-26 22:13:53 INFO: primary_caps activation shape (64, 16, 16, 8, 1)
2020-06-26 22:13:53 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 22:13:53 INFO: lyr.conv_caps1 votes shape: (3136, 72, 16, 16)
2020-06-26 22:13:53 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 22:13:53 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:13:53 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 22:13:54 INFO: lyr.conv_caps1 pose_out shape: (64, 7, 7, 16, 16)
2020-06-26 22:13:54 INFO: lyr.conv_caps1 activation_out shape: (64, 7, 7, 16, 1)
2020-06-26 22:13:54 INFO: lyr.conv_caps2 votes shape: (1600, 144, 16, 16)
2020-06-26 22:13:54 INFO: lyr.conv_caps2 pose_out shape: (64, 5, 5, 16, 16)
2020-06-26 22:13:54 INFO: lyr.conv_caps2 activation_out shape: (64, 5, 5, 16, 1)
2020-06-26 22:13:54 INFO: class_caps votes original shape: (1600, 16, 10, 16)
2020-06-26 22:13:54 INFO: class_caps votes in to routing shape: (64, 400, 10, 16)
2020-06-26 22:13:54 INFO: class_caps activation shape: (64, 10)
2020-06-26 22:13:54 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 22:13:54 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:13:55 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:13:55 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:13:55 INFO: Restoring parameters from logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/checkpoint/model.ckpt292-125268
2020-06-26 22:13:58 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [3072] rhs shape= [784]
	 [[{{node save/Assign_5}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [3072] rhs shape= [784]
	 [[node save/Assign_5 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_5:
 class_output/biases (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:288)

Original stack trace for 'save/Assign_5':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [3072] rhs shape= [784]
	 [[node save/Assign_5 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_5:
 class_output/biases (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:288)

Original stack trace for 'save/Assign_5':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:14:03 INFO: name: 20200605_03:00:14:427684_
2020-06-26 22:14:03 INFO: parent_dir: logs/mnist/nomod_cap
2020-06-26 22:14:03 INFO: test_dir: logs/mnist/nomod_cap/20200605_03:00:14:427684_/test
2020-06-26 22:14:03 INFO: patch_path: logs/mnist/nomodcap_adv_05/20200613_17:57:35:183021_/train/saved_patch.png
2020-06-26 22:14:03 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/params/params.json
2020-06-26 22:14:03 INFO: Using dataset: svhn
2020-06-26 22:14:03 INFO: BUILD TEST GRAPH
2020-06-26 22:14:03 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:14:03 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:14:03 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:14:03 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:14:03 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:14:03 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:14:03 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:14:03 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:14:03 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:14:04 INFO: input shape: (64, 32, 32, 3)
2020-06-26 22:14:04 INFO: Scale of 0 disables regularizer.
2020-06-26 22:14:04 INFO: relu_conv1 output shape: (64, 16, 16, 64)
2020-06-26 22:14:04 INFO: primary_caps pose shape: (64, 16, 16, 8, 16)
2020-06-26 22:14:04 INFO: primary_caps activation shape (64, 16, 16, 8, 1)
2020-06-26 22:14:04 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 22:14:04 INFO: lyr.conv_caps1 votes shape: (3136, 72, 16, 16)
2020-06-26 22:14:04 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 22:14:04 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:14:04 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 22:14:04 INFO: lyr.conv_caps1 pose_out shape: (64, 7, 7, 16, 16)
2020-06-26 22:14:04 INFO: lyr.conv_caps1 activation_out shape: (64, 7, 7, 16, 1)
2020-06-26 22:14:04 INFO: lyr.conv_caps2 votes shape: (1600, 144, 16, 16)
2020-06-26 22:14:04 INFO: lyr.conv_caps2 pose_out shape: (64, 5, 5, 16, 16)
2020-06-26 22:14:04 INFO: lyr.conv_caps2 activation_out shape: (64, 5, 5, 16, 1)
2020-06-26 22:14:04 INFO: class_caps votes original shape: (1600, 16, 10, 16)
2020-06-26 22:14:04 INFO: class_caps votes in to routing shape: (64, 400, 10, 16)
2020-06-26 22:14:04 INFO: class_caps activation shape: (64, 10)
2020-06-26 22:14:04 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 22:14:05 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:14:05 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:14:05 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:14:05 INFO: Restoring parameters from logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/checkpoint/model.ckpt292-125268
2020-06-26 22:14:06 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,3072] rhs shape= [1024,784]
	 [[{{node save/Assign_6}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,3072] rhs shape= [1024,784]
	 [[node save/Assign_6 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_6:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:288)

Original stack trace for 'save/Assign_6':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [1024,3072] rhs shape= [1024,784]
	 [[node save/Assign_6 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_6:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:288)

Original stack trace for 'save/Assign_6':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:14:11 INFO: name: 20200605_03:00:14:427684_
2020-06-26 22:14:11 INFO: parent_dir: logs/mnist/nomod_cap
2020-06-26 22:14:11 INFO: test_dir: logs/mnist/nomod_cap/20200605_03:00:14:427684_/test
2020-06-26 22:14:11 INFO: patch_path: logs/mnist/nomodcap_adv_10/20200613_17:57:35:183119_/train/saved_patch.png
2020-06-26 22:14:11 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/params/params.json
2020-06-26 22:14:11 INFO: Using dataset: svhn
2020-06-26 22:14:11 INFO: BUILD TEST GRAPH
2020-06-26 22:14:11 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:14:11 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:14:11 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:14:11 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:14:11 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:14:11 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:14:11 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:14:11 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:14:11 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:14:11 INFO: input shape: (64, 32, 32, 3)
2020-06-26 22:14:11 INFO: Scale of 0 disables regularizer.
2020-06-26 22:14:12 INFO: relu_conv1 output shape: (64, 16, 16, 64)
2020-06-26 22:14:12 INFO: primary_caps pose shape: (64, 16, 16, 8, 16)
2020-06-26 22:14:12 INFO: primary_caps activation shape (64, 16, 16, 8, 1)
2020-06-26 22:14:12 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 22:14:12 INFO: lyr.conv_caps1 votes shape: (3136, 72, 16, 16)
2020-06-26 22:14:12 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 22:14:12 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:14:12 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 22:14:12 INFO: lyr.conv_caps1 pose_out shape: (64, 7, 7, 16, 16)
2020-06-26 22:14:12 INFO: lyr.conv_caps1 activation_out shape: (64, 7, 7, 16, 1)
2020-06-26 22:14:12 INFO: lyr.conv_caps2 votes shape: (1600, 144, 16, 16)
2020-06-26 22:14:12 INFO: lyr.conv_caps2 pose_out shape: (64, 5, 5, 16, 16)
2020-06-26 22:14:12 INFO: lyr.conv_caps2 activation_out shape: (64, 5, 5, 16, 1)
2020-06-26 22:14:12 INFO: class_caps votes original shape: (1600, 16, 10, 16)
2020-06-26 22:14:12 INFO: class_caps votes in to routing shape: (64, 400, 10, 16)
2020-06-26 22:14:12 INFO: class_caps activation shape: (64, 10)
2020-06-26 22:14:12 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 22:14:12 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:14:13 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:14:13 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:14:13 INFO: Restoring parameters from logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/checkpoint/model.ckpt292-125268
2020-06-26 22:14:14 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[{{node save/Assign_1}}]]
	 [[save/RestoreV2/_16]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[{{node save/Assign_1}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[node save/Assign_1 (defined at inspect_results.py:173) ]]
	 [[save/RestoreV2/_16]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[node save/Assign_1 (defined at inspect_results.py:173) ]]
0 successful operations.
0 derived errors ignored.

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_1:
 BatchNorm/moving_variance (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:65)

Input Source operations connected to node save/Assign_1:
 BatchNorm/moving_variance (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:65)

Original stack trace for 'save/Assign_1':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[node save/Assign_1 (defined at inspect_results.py:173) ]]
	 [[save/RestoreV2/_16]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[node save/Assign_1 (defined at inspect_results.py:173) ]]
0 successful operations.
0 derived errors ignored.

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_1:
 BatchNorm/moving_variance (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:65)

Input Source operations connected to node save/Assign_1:
 BatchNorm/moving_variance (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:65)

Original stack trace for 'save/Assign_1':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:14:19 INFO: name: 20200605_03:00:14:427684_
2020-06-26 22:14:19 INFO: parent_dir: logs/mnist/nomod_cap
2020-06-26 22:14:19 INFO: test_dir: logs/mnist/nomod_cap/20200605_03:00:14:427684_/test
2020-06-26 22:14:19 INFO: patch_path: logs/mnist/nomodcap_adv_15/20200613_17:57:35:183021_/train/saved_patch.png
2020-06-26 22:14:19 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/params/params.json
2020-06-26 22:14:19 INFO: Using dataset: svhn
2020-06-26 22:14:19 INFO: BUILD TEST GRAPH
2020-06-26 22:14:19 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:14:19 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:14:19 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:14:19 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:14:20 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:14:20 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:14:20 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:14:20 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:14:20 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:14:20 INFO: input shape: (64, 32, 32, 3)
2020-06-26 22:14:20 INFO: Scale of 0 disables regularizer.
2020-06-26 22:14:20 INFO: relu_conv1 output shape: (64, 16, 16, 64)
2020-06-26 22:14:20 INFO: primary_caps pose shape: (64, 16, 16, 8, 16)
2020-06-26 22:14:20 INFO: primary_caps activation shape (64, 16, 16, 8, 1)
2020-06-26 22:14:20 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 22:14:20 INFO: lyr.conv_caps1 votes shape: (3136, 72, 16, 16)
2020-06-26 22:14:20 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 22:14:20 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:14:20 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 22:14:21 INFO: lyr.conv_caps1 pose_out shape: (64, 7, 7, 16, 16)
2020-06-26 22:14:21 INFO: lyr.conv_caps1 activation_out shape: (64, 7, 7, 16, 1)
2020-06-26 22:14:21 INFO: lyr.conv_caps2 votes shape: (1600, 144, 16, 16)
2020-06-26 22:14:21 INFO: lyr.conv_caps2 pose_out shape: (64, 5, 5, 16, 16)
2020-06-26 22:14:21 INFO: lyr.conv_caps2 activation_out shape: (64, 5, 5, 16, 1)
2020-06-26 22:14:21 INFO: class_caps votes original shape: (1600, 16, 10, 16)
2020-06-26 22:14:21 INFO: class_caps votes in to routing shape: (64, 400, 10, 16)
2020-06-26 22:14:21 INFO: class_caps activation shape: (64, 10)
2020-06-26 22:14:21 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 22:14:21 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:14:22 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:14:22 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:14:22 INFO: Restoring parameters from logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/checkpoint/model.ckpt292-125268
2020-06-26 22:14:22 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,3072] rhs shape= [1024,784]
	 [[{{node save/Assign_6}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,3072] rhs shape= [1024,784]
	 [[node save/Assign_6 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_6:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:288)

Original stack trace for 'save/Assign_6':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [1024,3072] rhs shape= [1024,784]
	 [[node save/Assign_6 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_6:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:288)

Original stack trace for 'save/Assign_6':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:14:27 INFO: name: 20200605_03:00:14:427684_
2020-06-26 22:14:28 INFO: parent_dir: logs/mnist/nomod_cap
2020-06-26 22:14:28 INFO: test_dir: logs/mnist/nomod_cap/20200605_03:00:14:427684_/test
2020-06-26 22:14:28 INFO: patch_path: logs/mnist/nomodcap_adv_20/20200613_17:57:35:183201_/train/saved_patch.png
2020-06-26 22:14:28 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/params/params.json
2020-06-26 22:14:28 INFO: Using dataset: svhn
2020-06-26 22:14:28 INFO: BUILD TEST GRAPH
2020-06-26 22:14:28 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:14:28 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:14:28 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:14:28 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:14:28 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:14:28 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:14:28 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:14:28 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:14:29 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:14:29 INFO: input shape: (64, 32, 32, 3)
2020-06-26 22:14:29 INFO: Scale of 0 disables regularizer.
2020-06-26 22:14:29 INFO: relu_conv1 output shape: (64, 16, 16, 64)
2020-06-26 22:14:29 INFO: primary_caps pose shape: (64, 16, 16, 8, 16)
2020-06-26 22:14:29 INFO: primary_caps activation shape (64, 16, 16, 8, 1)
2020-06-26 22:14:29 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 22:14:29 INFO: lyr.conv_caps1 votes shape: (3136, 72, 16, 16)
2020-06-26 22:14:29 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 22:14:29 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:14:29 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 22:14:29 INFO: lyr.conv_caps1 pose_out shape: (64, 7, 7, 16, 16)
2020-06-26 22:14:29 INFO: lyr.conv_caps1 activation_out shape: (64, 7, 7, 16, 1)
2020-06-26 22:14:29 INFO: lyr.conv_caps2 votes shape: (1600, 144, 16, 16)
2020-06-26 22:14:29 INFO: lyr.conv_caps2 pose_out shape: (64, 5, 5, 16, 16)
2020-06-26 22:14:29 INFO: lyr.conv_caps2 activation_out shape: (64, 5, 5, 16, 1)
2020-06-26 22:14:29 INFO: class_caps votes original shape: (1600, 16, 10, 16)
2020-06-26 22:14:29 INFO: class_caps votes in to routing shape: (64, 400, 10, 16)
2020-06-26 22:14:30 INFO: class_caps activation shape: (64, 10)
2020-06-26 22:14:30 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 22:14:30 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:14:30 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:14:30 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:14:30 INFO: Restoring parameters from logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/checkpoint/model.ckpt292-125268
2020-06-26 22:14:31 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [5,5,3,64] rhs shape= [5,5,1,64]
	 [[{{node save/Assign_23}}]]
	 [[save/RestoreV2/_10]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [5,5,3,64] rhs shape= [5,5,1,64]
	 [[{{node save/Assign_23}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [5,5,3,64] rhs shape= [5,5,1,64]
	 [[node save/Assign_23 (defined at inspect_results.py:173) ]]
	 [[save/RestoreV2/_10]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [5,5,3,64] rhs shape= [5,5,1,64]
	 [[node save/Assign_23 (defined at inspect_results.py:173) ]]
0 successful operations.
0 derived errors ignored.

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_23:
 relu_conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:75)

Input Source operations connected to node save/Assign_23:
 relu_conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:75)

Original stack trace for 'save/Assign_23':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [5,5,3,64] rhs shape= [5,5,1,64]
	 [[node save/Assign_23 (defined at inspect_results.py:173) ]]
	 [[save/RestoreV2/_10]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [5,5,3,64] rhs shape= [5,5,1,64]
	 [[node save/Assign_23 (defined at inspect_results.py:173) ]]
0 successful operations.
0 derived errors ignored.

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_23:
 relu_conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:75)

Input Source operations connected to node save/Assign_23:
 relu_conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:75)

Original stack trace for 'save/Assign_23':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:14:36 INFO: name: 20200605_03:00:14:427684_
2020-06-26 22:14:36 INFO: parent_dir: logs/mnist/nomod_cap
2020-06-26 22:14:36 INFO: test_dir: logs/mnist/nomod_cap/20200605_03:00:14:427684_/test
2020-06-26 22:14:36 INFO: patch_path: logs/mnist/nomodcap_adv_25/20200613_17:57:35:183737_/train/saved_patch.png
2020-06-26 22:14:36 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/params/params.json
2020-06-26 22:14:36 INFO: Using dataset: svhn
2020-06-26 22:14:36 INFO: BUILD TEST GRAPH
2020-06-26 22:14:36 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:14:36 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:14:36 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:14:36 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:14:36 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:14:36 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:14:36 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:14:36 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:14:36 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:14:36 INFO: input shape: (64, 32, 32, 3)
2020-06-26 22:14:36 INFO: Scale of 0 disables regularizer.
2020-06-26 22:14:37 INFO: relu_conv1 output shape: (64, 16, 16, 64)
2020-06-26 22:14:37 INFO: primary_caps pose shape: (64, 16, 16, 8, 16)
2020-06-26 22:14:37 INFO: primary_caps activation shape (64, 16, 16, 8, 1)
2020-06-26 22:14:37 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 22:14:37 INFO: lyr.conv_caps1 votes shape: (3136, 72, 16, 16)
2020-06-26 22:14:37 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 22:14:37 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:14:37 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 22:14:37 INFO: lyr.conv_caps1 pose_out shape: (64, 7, 7, 16, 16)
2020-06-26 22:14:37 INFO: lyr.conv_caps1 activation_out shape: (64, 7, 7, 16, 1)
2020-06-26 22:14:37 INFO: lyr.conv_caps2 votes shape: (1600, 144, 16, 16)
2020-06-26 22:14:37 INFO: lyr.conv_caps2 pose_out shape: (64, 5, 5, 16, 16)
2020-06-26 22:14:37 INFO: lyr.conv_caps2 activation_out shape: (64, 5, 5, 16, 1)
2020-06-26 22:14:37 INFO: class_caps votes original shape: (1600, 16, 10, 16)
2020-06-26 22:14:37 INFO: class_caps votes in to routing shape: (64, 400, 10, 16)
2020-06-26 22:14:37 INFO: class_caps activation shape: (64, 10)
2020-06-26 22:14:37 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 22:14:37 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:14:38 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:14:38 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:14:38 INFO: Restoring parameters from logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/checkpoint/model.ckpt292-125268
2020-06-26 22:14:39 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[{{node save/Assign_1}}]]
	 [[save/RestoreV2/_34]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[{{node save/Assign_1}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[node save/Assign_1 (defined at inspect_results.py:173) ]]
	 [[save/RestoreV2/_34]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[node save/Assign_1 (defined at inspect_results.py:173) ]]
0 successful operations.
0 derived errors ignored.

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_1:
 BatchNorm/moving_variance (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:65)

Input Source operations connected to node save/Assign_1:
 BatchNorm/moving_variance (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:65)

Original stack trace for 'save/Assign_1':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[node save/Assign_1 (defined at inspect_results.py:173) ]]
	 [[save/RestoreV2/_34]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[node save/Assign_1 (defined at inspect_results.py:173) ]]
0 successful operations.
0 derived errors ignored.

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_1:
 BatchNorm/moving_variance (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:65)

Input Source operations connected to node save/Assign_1:
 BatchNorm/moving_variance (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:65)

Original stack trace for 'save/Assign_1':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:14:43 INFO: name: 20200605_03:00:14:427684_
2020-06-26 22:14:43 INFO: parent_dir: logs/mnist/nomod_cap
2020-06-26 22:14:43 INFO: test_dir: logs/mnist/nomod_cap/20200605_03:00:14:427684_/test
2020-06-26 22:14:43 INFO: patch_path: logs/mnist/nomodcap_adv_30/20200613_17:57:35:183706_/train/saved_patch.png
2020-06-26 22:14:43 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/params/params.json
2020-06-26 22:14:43 INFO: Using dataset: svhn
2020-06-26 22:14:43 INFO: BUILD TEST GRAPH
2020-06-26 22:14:43 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:14:43 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:14:43 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:14:43 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:14:43 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:14:44 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:14:44 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:14:44 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:14:44 INFO: name: 20200605_03:00:14:427684_
2020-06-26 22:14:44 INFO: parent_dir: logs/mnist/nomod_cap
2020-06-26 22:14:44 INFO: test_dir: logs/mnist/nomod_cap/20200605_03:00:14:427684_/test
2020-06-26 22:14:44 INFO: patch_path: logs/mnist/nomodcap_adv_35/20200613_17:57:52:399077_/train/saved_patch.png
2020-06-26 22:14:44 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/params/params.json
2020-06-26 22:14:44 INFO: Using dataset: svhn
2020-06-26 22:14:44 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:14:44 INFO: BUILD TEST GRAPH
2020-06-26 22:14:44 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:14:44 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:14:44 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:14:44 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:14:44 INFO: input shape: (64, 32, 32, 3)
2020-06-26 22:14:44 INFO: Scale of 0 disables regularizer.
2020-06-26 22:14:44 INFO: relu_conv1 output shape: (64, 16, 16, 64)
2020-06-26 22:14:44 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:14:44 INFO: primary_caps pose shape: (64, 16, 16, 8, 16)
2020-06-26 22:14:44 INFO: primary_caps activation shape (64, 16, 16, 8, 1)
2020-06-26 22:14:44 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

cated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 22:14:44 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:14:44 INFO: lyr.conv_caps1 votes shape: (3136, 72, 16, 16)
2020-06-26 22:14:44 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:14:44 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 22:14:44 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:14:44 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 22:14:44 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:14:44 INFO: input shape: (64, 32, 32, 3)
2020-06-26 22:14:44 INFO: Scale of 0 disables regularizer.
2020-06-26 22:14:44 INFO: lyr.conv_caps1 pose_out shape: (64, 7, 7, 16, 16)
2020-06-26 22:14:44 INFO: lyr.conv_caps1 activation_out shape: (64, 7, 7, 16, 1)
2020-06-26 22:14:44 INFO: lyr.conv_caps2 votes shape: (1600, 144, 16, 16)
2020-06-26 22:14:45 INFO: lyr.conv_caps2 pose_out shape: (64, 5, 5, 16, 16)
2020-06-26 22:14:45 INFO: lyr.conv_caps2 activation_out shape: (64, 5, 5, 16, 1)
2020-06-26 22:14:45 INFO: class_caps votes original shape: (1600, 16, 10, 16)
2020-06-26 22:14:45 INFO: class_caps votes in to routing shape: (64, 400, 10, 16)
2020-06-26 22:14:45 INFO: relu_conv1 output shape: (64, 16, 16, 64)
2020-06-26 22:14:45 INFO: primary_caps pose shape: (64, 16, 16, 8, 16)
2020-06-26 22:14:45 INFO: primary_caps activation shape (64, 16, 16, 8, 1)
2020-06-26 22:14:45 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 22:14:45 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 22:14:45 INFO: lyr.conv_caps1 votes shape: (3136, 72, 16, 16)
2020-06-26 22:14:45 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 22:14:45 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:14:45 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 22:14:45 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:14:45 INFO: lyr.conv_caps1 pose_out shape: (64, 7, 7, 16, 16)
2020-06-26 22:14:45 INFO: lyr.conv_caps1 activation_out shape: (64, 7, 7, 16, 1)
2020-06-26 22:14:45 INFO: lyr.conv_caps2 votes shape: (1600, 144, 16, 16)
2020-06-26 22:14:45 INFO: lyr.conv_caps2 pose_out shape: (64, 5, 5, 16, 16)
2020-06-26 22:14:45 INFO: lyr.conv_caps2 activation_out shape: (64, 5, 5, 16, 1)
2020-06-26 22:14:45 INFO: class_caps votes original shape: (1600, 16, 10, 16)
2020-06-26 22:14:45 INFO: class_caps votes in to routing shape: (64, 400, 10, 16)
2020-06-26 22:14:45 INFO: class_caps activation shape: (64, 10)
2020-06-26 22:14:45 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:14:45 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 22:14:46 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:14:46 INFO: Restoring parameters from logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/checkpoint/model.ckpt292-125268
2020-06-26 22:14:46 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:14:46 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:14:46 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[{{node save/Assign_1}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[node save/Assign_1 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_1:
 BatchNorm/moving_variance (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:65)

Original stack trace for 'save/Assign_1':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[node save/Assign_1 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_1:
 BatchNorm/moving_variance (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:65)

Original stack trace for 'save/Assign_1':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:14:46 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:14:46 INFO: Restoring parameters from logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/checkpoint/model.ckpt292-125268
2020-06-26 22:14:47 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[{{node save/Assign_1}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[node save/Assign_1 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_1:
 BatchNorm/moving_variance (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:65)

Original stack trace for 'save/Assign_1':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[node save/Assign_1 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_1:
 BatchNorm/moving_variance (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:65)

Original stack trace for 'save/Assign_1':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:14:50 INFO: name: 20200605_03:00:14:427684_
2020-06-26 22:14:51 INFO: parent_dir: logs/mnist/nomod_cap
2020-06-26 22:14:51 INFO: test_dir: logs/mnist/nomod_cap/20200605_03:00:14:427684_/test
2020-06-26 22:14:51 INFO: patch_path: logs/mnist/nomodcap_adv_40/20200613_17:58:25:830000_/train/saved_patch.png
2020-06-26 22:14:51 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/params/params.json
2020-06-26 22:14:51 INFO: Using dataset: svhn
2020-06-26 22:14:51 INFO: BUILD TEST GRAPH
2020-06-26 22:14:51 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:14:51 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:14:51 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:14:51 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:14:51 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:14:51 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:14:51 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:14:51 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:14:52 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:14:52 INFO: input shape: (64, 32, 32, 3)
2020-06-26 22:14:52 INFO: Scale of 0 disables regularizer.
2020-06-26 22:14:52 INFO: relu_conv1 output shape: (64, 16, 16, 64)
2020-06-26 22:14:52 INFO: primary_caps pose shape: (64, 16, 16, 8, 16)
2020-06-26 22:14:52 INFO: primary_caps activation shape (64, 16, 16, 8, 1)
2020-06-26 22:14:52 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 22:14:52 INFO: lyr.conv_caps1 votes shape: (3136, 72, 16, 16)
2020-06-26 22:14:52 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 22:14:52 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:14:52 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 22:14:52 INFO: lyr.conv_caps1 pose_out shape: (64, 7, 7, 16, 16)
2020-06-26 22:14:52 INFO: lyr.conv_caps1 activation_out shape: (64, 7, 7, 16, 1)
2020-06-26 22:14:52 INFO: lyr.conv_caps2 votes shape: (1600, 144, 16, 16)
2020-06-26 22:14:52 INFO: lyr.conv_caps2 pose_out shape: (64, 5, 5, 16, 16)
2020-06-26 22:14:52 INFO: lyr.conv_caps2 activation_out shape: (64, 5, 5, 16, 1)
2020-06-26 22:14:52 INFO: class_caps votes original shape: (1600, 16, 10, 16)
2020-06-26 22:14:52 INFO: class_caps votes in to routing shape: (64, 400, 10, 16)
2020-06-26 22:14:52 INFO: class_caps activation shape: (64, 10)
2020-06-26 22:14:53 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 22:14:53 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:14:53 INFO: name: 20200605_03:00:14:427684_
2020-06-26 22:14:53 INFO: parent_dir: logs/mnist/nomod_cap
2020-06-26 22:14:53 INFO: test_dir: logs/mnist/nomod_cap/20200605_03:00:14:427684_/test
2020-06-26 22:14:53 INFO: patch_path: logs/mnist/nomodcap_adv_45/20200613_17:58:25:667432_/train/saved_patch.png
2020-06-26 22:14:53 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/params/params.json
2020-06-26 22:14:53 INFO: Using dataset: svhn
2020-06-26 22:14:53 INFO: BUILD TEST GRAPH
2020-06-26 22:14:53 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:14:53 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:14:53 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:14:53 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:14:53 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:14:53 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:14:53 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:14:53 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:14:53 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:14:53 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:14:53 INFO: Restoring parameters from logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/checkpoint/model.ckpt292-125268
2020-06-26 22:14:53 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:14:54 INFO: input shape: (64, 32, 32, 3)
2020-06-26 22:14:54 INFO: Scale of 0 disables regularizer.
2020-06-26 22:14:54 INFO: relu_conv1 output shape: (64, 16, 16, 64)
2020-06-26 22:14:54 INFO: primary_caps pose shape: (64, 16, 16, 8, 16)
2020-06-26 22:14:54 INFO: primary_caps activation shape (64, 16, 16, 8, 1)
2020-06-26 22:14:54 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 22:14:54 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [5,5,3,64] rhs shape= [5,5,1,64]
	 [[{{node save/Assign_23}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [5,5,3,64] rhs shape= [5,5,1,64]
	 [[node save/Assign_23 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_23:
 relu_conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:75)

Original stack trace for 'save/Assign_23':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [5,5,3,64] rhs shape= [5,5,1,64]
	 [[node save/Assign_23 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_23:
 relu_conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:75)

Original stack trace for 'save/Assign_23':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:14:54 INFO: lyr.conv_caps1 votes shape: (3136, 72, 16, 16)
2020-06-26 22:14:54 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 22:14:54 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:14:54 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 22:14:54 INFO: lyr.conv_caps1 pose_out shape: (64, 7, 7, 16, 16)
2020-06-26 22:14:54 INFO: lyr.conv_caps1 activation_out shape: (64, 7, 7, 16, 1)
2020-06-26 22:14:54 INFO: lyr.conv_caps2 votes shape: (1600, 144, 16, 16)
2020-06-26 22:14:54 INFO: lyr.conv_caps2 pose_out shape: (64, 5, 5, 16, 16)
2020-06-26 22:14:54 INFO: lyr.conv_caps2 activation_out shape: (64, 5, 5, 16, 1)
2020-06-26 22:14:54 INFO: class_caps votes original shape: (1600, 16, 10, 16)
2020-06-26 22:14:54 INFO: class_caps votes in to routing shape: (64, 400, 10, 16)
2020-06-26 22:14:55 INFO: class_caps activation shape: (64, 10)
2020-06-26 22:14:55 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 22:14:55 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:14:55 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:14:55 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:14:55 INFO: Restoring parameters from logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/checkpoint/model.ckpt292-125268
2020-06-26 22:14:56 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,3072] rhs shape= [1024,784]
	 [[{{node save/Assign_6}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [1024,3072] rhs shape= [1024,784]
	 [[node save/Assign_6 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_6:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:288)

Original stack trace for 'save/Assign_6':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [1024,3072] rhs shape= [1024,784]
	 [[node save/Assign_6 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_6:
 class_output/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:288)

Original stack trace for 'save/Assign_6':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:14:58 INFO: name: 20200605_03:00:14:427684_
2020-06-26 22:14:58 INFO: parent_dir: logs/mnist/nomod_cap
2020-06-26 22:14:58 INFO: test_dir: logs/mnist/nomod_cap/20200605_03:00:14:427684_/test
2020-06-26 22:14:58 INFO: patch_path: logs/mnist/nomodcap_adv_50/20200613_18:19:45:657219_/train/saved_patch.png
2020-06-26 22:14:58 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/params/params.json
2020-06-26 22:14:58 INFO: Using dataset: svhn
2020-06-26 22:14:58 INFO: BUILD TEST GRAPH
2020-06-26 22:14:58 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:14:59 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:14:59 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:14:59 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:14:59 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:14:59 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:14:59 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:14:59 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:14:59 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:14:59 INFO: input shape: (64, 32, 32, 3)
2020-06-26 22:14:59 INFO: Scale of 0 disables regularizer.
2020-06-26 22:15:00 INFO: relu_conv1 output shape: (64, 16, 16, 64)
2020-06-26 22:15:00 INFO: primary_caps pose shape: (64, 16, 16, 8, 16)
2020-06-26 22:15:00 INFO: primary_caps activation shape (64, 16, 16, 8, 1)
2020-06-26 22:15:00 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 22:15:00 INFO: lyr.conv_caps1 votes shape: (3136, 72, 16, 16)
2020-06-26 22:15:00 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 22:15:00 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:15:00 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 22:15:00 INFO: lyr.conv_caps1 pose_out shape: (64, 7, 7, 16, 16)
2020-06-26 22:15:00 INFO: lyr.conv_caps1 activation_out shape: (64, 7, 7, 16, 1)
2020-06-26 22:15:00 INFO: lyr.conv_caps2 votes shape: (1600, 144, 16, 16)
2020-06-26 22:15:00 INFO: lyr.conv_caps2 pose_out shape: (64, 5, 5, 16, 16)
2020-06-26 22:15:00 INFO: lyr.conv_caps2 activation_out shape: (64, 5, 5, 16, 1)
2020-06-26 22:15:00 INFO: class_caps votes original shape: (1600, 16, 10, 16)
2020-06-26 22:15:00 INFO: class_caps votes in to routing shape: (64, 400, 10, 16)
2020-06-26 22:15:00 INFO: class_caps activation shape: (64, 10)
2020-06-26 22:15:00 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 22:15:01 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:15:01 INFO: name: 20200605_03:00:14:427684_
2020-06-26 22:15:01 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:15:01 INFO: parent_dir: logs/mnist/nomod_cap
2020-06-26 22:15:01 INFO: test_dir: logs/mnist/nomod_cap/20200605_03:00:14:427684_/test
2020-06-26 22:15:01 INFO: patch_path: logs/mnist/nomodcap_adv_hun/20200613_18:35:13:369111_/train/saved_patch.png
2020-06-26 22:15:01 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/params/params.json
2020-06-26 22:15:01 INFO: Using dataset: svhn
2020-06-26 22:15:01 INFO: BUILD TEST GRAPH
2020-06-26 22:15:01 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:15:01 INFO: Overwrite dataset info from restored data version.
thon3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:15:01 INFO: Restoring parameters from logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/checkpoint/model.ckpt292-125268
2020-06-26 22:15:01 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:15:01 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:15:01 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:15:01 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:15:01 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:15:01 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:15:02 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:15:02 INFO: input shape: (64, 32, 32, 3)
2020-06-26 22:15:02 INFO: Scale of 0 disables regularizer.
2020-06-26 22:15:02 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [5,5,3,64] rhs shape= [5,5,1,64]
	 [[{{node save/Assign_23}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [5,5,3,64] rhs shape= [5,5,1,64]
	 [[node save/Assign_23 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_23:
 relu_conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:75)

Original stack trace for 'save/Assign_23':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [5,5,3,64] rhs shape= [5,5,1,64]
	 [[node save/Assign_23 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_23:
 relu_conv1/weights (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:75)

Original stack trace for 'save/Assign_23':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:15:02 INFO: relu_conv1 output shape: (64, 16, 16, 64)
2020-06-26 22:15:02 INFO: primary_caps pose shape: (64, 16, 16, 8, 16)
2020-06-26 22:15:02 INFO: primary_caps activation shape (64, 16, 16, 8, 1)
2020-06-26 22:15:02 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 22:15:02 INFO: lyr.conv_caps1 votes shape: (3136, 72, 16, 16)
2020-06-26 22:15:02 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 22:15:02 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:15:02 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 22:15:02 INFO: lyr.conv_caps1 pose_out shape: (64, 7, 7, 16, 16)
2020-06-26 22:15:02 INFO: lyr.conv_caps1 activation_out shape: (64, 7, 7, 16, 1)
2020-06-26 22:15:02 INFO: lyr.conv_caps2 votes shape: (1600, 144, 16, 16)
2020-06-26 22:15:02 INFO: lyr.conv_caps2 pose_out shape: (64, 5, 5, 16, 16)
2020-06-26 22:15:02 INFO: lyr.conv_caps2 activation_out shape: (64, 5, 5, 16, 1)
2020-06-26 22:15:02 INFO: class_caps votes original shape: (1600, 16, 10, 16)
2020-06-26 22:15:03 INFO: class_caps votes in to routing shape: (64, 400, 10, 16)
2020-06-26 22:15:03 INFO: name: 20200605_03:00:14:427684_
2020-06-26 22:15:03 INFO: parent_dir: logs/mnist/nomod_cap
2020-06-26 22:15:03 INFO: test_dir: logs/mnist/nomod_cap/20200605_03:00:14:427684_/test
2020-06-26 22:15:03 INFO: patch_path: logs/mnist/nomodcap_adv_ten/20200613_18:35:13:369721_/train/saved_patch.png
2020-06-26 22:15:03 INFO: class_caps activation shape: (64, 10)
2020-06-26 22:15:03 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 22:15:03 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/params/params.json
2020-06-26 22:15:03 INFO: Using dataset: svhn
2020-06-26 22:15:03 INFO: BUILD TEST GRAPH
2020-06-26 22:15:03 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:15:03 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:15:03 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:15:03 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:15:03 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:15:03 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:15:03 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:15:03 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:15:03 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:15:03 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:15:03 INFO: input shape: (64, 32, 32, 3)
2020-06-26 22:15:03 INFO: Scale of 0 disables regularizer.
2020-06-26 22:15:03 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:15:04 INFO: relu_conv1 output shape: (64, 16, 16, 64)
2020-06-26 22:15:04 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:15:04 INFO: Restoring parameters from logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/checkpoint/model.ckpt292-125268
2020-06-26 22:15:04 INFO: primary_caps pose shape: (64, 16, 16, 8, 16)
2020-06-26 22:15:04 INFO: primary_caps activation shape (64, 16, 16, 8, 1)
2020-06-26 22:15:04 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 22:15:04 INFO: lyr.conv_caps1 votes shape: (3136, 72, 16, 16)
2020-06-26 22:15:04 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 22:15:04 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:15:04 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 22:15:04 INFO: lyr.conv_caps1 pose_out shape: (64, 7, 7, 16, 16)
2020-06-26 22:15:04 INFO: lyr.conv_caps1 activation_out shape: (64, 7, 7, 16, 1)
2020-06-26 22:15:04 INFO: lyr.conv_caps2 votes shape: (1600, 144, 16, 16)
2020-06-26 22:15:04 INFO: lyr.conv_caps2 pose_out shape: (64, 5, 5, 16, 16)
2020-06-26 22:15:04 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[{{node save/Assign}}]]
	 [[save/RestoreV2/_10]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[{{node save/Assign}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[node save/Assign (defined at inspect_results.py:173) ]]
	 [[save/RestoreV2/_10]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[node save/Assign (defined at inspect_results.py:173) ]]
0 successful operations.
0 derived errors ignored.

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign:
 BatchNorm/moving_mean (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:65)

Input Source operations connected to node save/Assign:
 BatchNorm/moving_mean (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:65)

Original stack trace for 'save/Assign':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[node save/Assign (defined at inspect_results.py:173) ]]
	 [[save/RestoreV2/_10]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[node save/Assign (defined at inspect_results.py:173) ]]
0 successful operations.
0 derived errors ignored.

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign:
 BatchNorm/moving_mean (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:65)

Input Source operations connected to node save/Assign:
 BatchNorm/moving_mean (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:65)

Original stack trace for 'save/Assign':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:15:04 INFO: lyr.conv_caps2 activation_out shape: (64, 5, 5, 16, 1)
2020-06-26 22:15:04 INFO: class_caps votes original shape: (1600, 16, 10, 16)
2020-06-26 22:15:04 INFO: class_caps votes in to routing shape: (64, 400, 10, 16)
2020-06-26 22:15:04 INFO: class_caps activation shape: (64, 10)
2020-06-26 22:15:05 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 22:15:05 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:15:06 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:15:06 INFO: name: 20200605_03:00:14:427684_
2020-06-26 22:15:06 INFO: parent_dir: logs/mnist/nomod_cap
2020-06-26 22:15:06 INFO: test_dir: logs/mnist/nomod_cap/20200605_03:00:14:427684_/test
2020-06-26 22:15:06 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:15:06 INFO: patch_path: logs/mnist/nomodcap_adv_tho/20200613_18:35:13:369235_/train/saved_patch.png
2020-06-26 22:15:06 INFO: Restoring parameters from logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/checkpoint/model.ckpt292-125268
2020-06-26 22:15:06 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/params/params.json
2020-06-26 22:15:06 INFO: Using dataset: svhn
2020-06-26 22:15:06 INFO: BUILD TEST GRAPH
2020-06-26 22:15:06 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:15:06 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:15:06 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:15:06 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:15:06 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:15:06 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:15:06 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:15:06 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:15:07 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:15:07 INFO: input shape: (64, 32, 32, 3)
2020-06-26 22:15:07 INFO: Scale of 0 disables regularizer.
2020-06-26 22:15:07 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[{{node save/Assign_1}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[node save/Assign_1 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_1:
 BatchNorm/moving_variance (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:65)

Original stack trace for 'save/Assign_1':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[node save/Assign_1 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_1:
 BatchNorm/moving_variance (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:65)

Original stack trace for 'save/Assign_1':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:15:07 INFO: relu_conv1 output shape: (64, 16, 16, 64)
2020-06-26 22:15:07 INFO: primary_caps pose shape: (64, 16, 16, 8, 16)
2020-06-26 22:15:07 INFO: primary_caps activation shape (64, 16, 16, 8, 1)
2020-06-26 22:15:07 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 22:15:07 INFO: lyr.conv_caps1 votes shape: (3136, 72, 16, 16)
2020-06-26 22:15:07 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 22:15:07 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:15:07 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 22:15:07 INFO: lyr.conv_caps1 pose_out shape: (64, 7, 7, 16, 16)
2020-06-26 22:15:07 INFO: lyr.conv_caps1 activation_out shape: (64, 7, 7, 16, 1)
2020-06-26 22:15:07 INFO: lyr.conv_caps2 votes shape: (1600, 144, 16, 16)
2020-06-26 22:15:07 INFO: lyr.conv_caps2 pose_out shape: (64, 5, 5, 16, 16)
2020-06-26 22:15:07 INFO: lyr.conv_caps2 activation_out shape: (64, 5, 5, 16, 1)
2020-06-26 22:15:07 INFO: class_caps votes original shape: (1600, 16, 10, 16)
2020-06-26 22:15:07 INFO: class_caps votes in to routing shape: (64, 400, 10, 16)
2020-06-26 22:15:08 INFO: class_caps activation shape: (64, 10)
2020-06-26 22:15:08 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 22:15:08 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:15:08 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:15:08 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:15:08 INFO: Restoring parameters from logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/checkpoint/model.ckpt292-125268
2020-06-26 22:15:09 INFO: name: 20200605_03:00:14:427684_
2020-06-26 22:15:09 INFO: parent_dir: logs/mnist/nomod_cap
2020-06-26 22:15:09 INFO: test_dir: logs/mnist/nomod_cap/20200605_03:00:14:427684_/test
2020-06-26 22:15:09 INFO: patch_path: logs/mnist/nomodcap_adv_tnk/20200613_18:35:13:370155_/train/saved_patch.png
2020-06-26 22:15:09 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/params/params.json
2020-06-26 22:15:09 INFO: Using dataset: svhn
2020-06-26 22:15:09 INFO: BUILD TEST GRAPH
2020-06-26 22:15:09 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 22:15:09 INFO: Overwrite dataset info from restored data version.
2020-06-26 22:15:09 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 22:15:09 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 22:15:09 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [3072] rhs shape= [784]
	 [[{{node save/Assign_5}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Assign requires shapes of both tensors to match. lhs shape= [3072] rhs shape= [784]
	 [[node save/Assign_5 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_5:
 class_output/biases (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:288)

Original stack trace for 'save/Assign_5':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Assign requires shapes of both tensors to match. lhs shape= [3072] rhs shape= [784]
	 [[node save/Assign_5 (defined at inspect_results.py:173) ]]

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_5:
 class_output/biases (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:288)

Original stack trace for 'save/Assign_5':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 22:15:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 22:15:09 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 22:15:09 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 22:15:09 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 22:15:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 22:15:09 INFO: input shape: (64, 32, 32, 3)
2020-06-26 22:15:09 INFO: Scale of 0 disables regularizer.
2020-06-26 22:15:09 INFO: relu_conv1 output shape: (64, 16, 16, 64)
2020-06-26 22:15:09 INFO: primary_caps pose shape: (64, 16, 16, 8, 16)
2020-06-26 22:15:10 INFO: primary_caps activation shape (64, 16, 16, 8, 1)
2020-06-26 22:15:10 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 22:15:10 INFO: lyr.conv_caps1 votes shape: (3136, 72, 16, 16)
2020-06-26 22:15:10 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 22:15:10 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 22:15:10 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 22:15:10 INFO: lyr.conv_caps1 pose_out shape: (64, 7, 7, 16, 16)
2020-06-26 22:15:10 INFO: lyr.conv_caps1 activation_out shape: (64, 7, 7, 16, 1)
2020-06-26 22:15:10 INFO: lyr.conv_caps2 votes shape: (1600, 144, 16, 16)
2020-06-26 22:15:10 INFO: lyr.conv_caps2 pose_out shape: (64, 5, 5, 16, 16)
2020-06-26 22:15:10 INFO: lyr.conv_caps2 activation_out shape: (64, 5, 5, 16, 1)
2020-06-26 22:15:10 INFO: class_caps votes original shape: (1600, 16, 10, 16)
2020-06-26 22:15:10 INFO: class_caps votes in to routing shape: (64, 400, 10, 16)
2020-06-26 22:15:10 INFO: class_caps activation shape: (64, 10)
2020-06-26 22:15:10 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 22:15:11 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 22:15:11 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 22:15:11 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 22:15:11 INFO: Restoring parameters from logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/checkpoint/model.ckpt292-125268
2020-06-26 22:15:12 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[{{node save/Assign_1}}]]
	 [[save/RestoreV2/_16]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[{{node save/Assign_1}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[node save/Assign_1 (defined at inspect_results.py:173) ]]
	 [[save/RestoreV2/_16]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[node save/Assign_1 (defined at inspect_results.py:173) ]]
0 successful operations.
0 derived errors ignored.

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_1:
 BatchNorm/moving_variance (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:65)

Input Source operations connected to node save/Assign_1:
 BatchNorm/moving_variance (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:65)

Original stack trace for 'save/Assign_1':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 235, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1322, in restore
    err, "a mismatch between the current graph and the graph")
tensorflow.python.framework.errors_impl.InvalidArgumentError: Restoring from checkpoint failed. This is most likely due to a mismatch between the current graph and the graph from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

2 root error(s) found.
  (0) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[node save/Assign_1 (defined at inspect_results.py:173) ]]
	 [[save/RestoreV2/_16]]
  (1) Invalid argument: Assign requires shapes of both tensors to match. lhs shape= [3] rhs shape= [1]
	 [[node save/Assign_1 (defined at inspect_results.py:173) ]]
0 successful operations.
0 derived errors ignored.

Errors may have originated from an input operation.
Input Source operations connected to node save/Assign_1:
 BatchNorm/moving_variance (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:65)

Input Source operations connected to node save/Assign_1:
 BatchNorm/moving_variance (defined at /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:65)

Original stack trace for 'save/Assign_1':
  File "inspect_results.py", line 322, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 173, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 350, in _AddRestoreOps
    assign_ops.append(saveable.restore(saveable_tensors, shapes))
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saving/saveable_object_util.py", line 72, in restore
    self.op.get_shape().is_fully_defined())
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/state_ops.py", line 227, in assign
    validate_shape=validate_shape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_state_ops.py", line 66, in assign
    use_locking=use_locking, name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 23:10:23 INFO: name: 20200605_03:00:14:427684_
2020-06-26 23:10:23 INFO: parent_dir: logs/mnist/nomod_cap
2020-06-26 23:10:23 INFO: test_dir: logs/mnist/nomod_cap/20200605_03:00:14:427684_/test
2020-06-26 23:10:23 INFO: patch_path: logs/mnist/nomodcap_adv_00/20200613_17:57:35:190094_/train/saved_patch.png
2020-06-26 23:10:23 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/params/params.json
2020-06-26 23:10:23 INFO: Using dataset: mnist
2020-06-26 23:10:23 INFO: BUILD TEST GRAPH
2020-06-26 23:10:23 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 23:10:23 INFO: Overwrite dataset info from restored data version.
2020-06-26 23:10:23 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-06-26 23:10:23 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-06-26 23:10:23 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-06-26 23:10:23 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 23:10:23 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 23:10:23 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 23:10:23 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 23:10:24 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 23:10:24 INFO: input shape: (64, 28, 28, 1)
2020-06-26 23:10:24 INFO: Scale of 0 disables regularizer.
2020-06-26 23:10:24 INFO: relu_conv1 output shape: (64, 14, 14, 64)
2020-06-26 23:10:24 INFO: primary_caps pose shape: (64, 14, 14, 8, 16)
2020-06-26 23:10:24 INFO: primary_caps activation shape (64, 14, 14, 8, 1)
2020-06-26 23:10:24 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 23:10:24 INFO: lyr.conv_caps1 votes shape: (2304, 72, 16, 16)
2020-06-26 23:10:24 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 23:10:24 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 23:10:24 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 23:10:24 INFO: lyr.conv_caps1 pose_out shape: (64, 6, 6, 16, 16)
2020-06-26 23:10:24 INFO: lyr.conv_caps1 activation_out shape: (64, 6, 6, 16, 1)
2020-06-26 23:10:24 INFO: lyr.conv_caps2 votes shape: (1024, 144, 16, 16)
2020-06-26 23:10:25 INFO: lyr.conv_caps2 pose_out shape: (64, 4, 4, 16, 16)
2020-06-26 23:10:25 INFO: lyr.conv_caps2 activation_out shape: (64, 4, 4, 16, 1)
2020-06-26 23:10:25 INFO: class_caps votes original shape: (1024, 16, 10, 16)
2020-06-26 23:10:25 INFO: class_caps votes in to routing shape: (64, 256, 10, 16)
2020-06-26 23:10:25 INFO: class_caps activation shape: (64, 10)
2020-06-26 23:10:25 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 23:10:25 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 23:10:25 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 23:10:26 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 23:10:26 INFO: Restoring parameters from logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/checkpoint/model.ckpt292-125268
2020-06-26 23:10:36 INFO: name: 20200605_03:00:14:427684_
2020-06-26 23:10:36 INFO: parent_dir: logs/mnist/nomod_cap
2020-06-26 23:10:36 INFO: test_dir: logs/mnist/nomod_cap/20200605_03:00:14:427684_/test
2020-06-26 23:10:37 INFO: patch_path: logs/mnist/nomodcap_adv_05/20200613_17:57:35:183021_/train/saved_patch.png
2020-06-26 23:10:37 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/params/params.json
2020-06-26 23:10:37 INFO: Using dataset: mnist
2020-06-26 23:10:37 INFO: BUILD TEST GRAPH
2020-06-26 23:10:37 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 23:10:37 INFO: Overwrite dataset info from restored data version.
2020-06-26 23:10:37 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-06-26 23:10:37 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-06-26 23:10:37 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-06-26 23:10:37 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 23:10:37 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 23:10:37 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 23:10:37 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 23:10:37 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 23:10:37 INFO: input shape: (64, 28, 28, 1)
2020-06-26 23:10:37 INFO: Scale of 0 disables regularizer.
2020-06-26 23:10:38 INFO: relu_conv1 output shape: (64, 14, 14, 64)
2020-06-26 23:10:38 INFO: primary_caps pose shape: (64, 14, 14, 8, 16)
2020-06-26 23:10:38 INFO: primary_caps activation shape (64, 14, 14, 8, 1)
2020-06-26 23:10:38 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 23:10:38 INFO: lyr.conv_caps1 votes shape: (2304, 72, 16, 16)
2020-06-26 23:10:38 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 23:10:38 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 23:10:38 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 23:10:38 INFO: lyr.conv_caps1 pose_out shape: (64, 6, 6, 16, 16)
2020-06-26 23:10:38 INFO: lyr.conv_caps1 activation_out shape: (64, 6, 6, 16, 1)
2020-06-26 23:10:38 INFO: lyr.conv_caps2 votes shape: (1024, 144, 16, 16)
2020-06-26 23:10:38 INFO: lyr.conv_caps2 pose_out shape: (64, 4, 4, 16, 16)
2020-06-26 23:10:38 INFO: lyr.conv_caps2 activation_out shape: (64, 4, 4, 16, 1)
2020-06-26 23:10:38 INFO: class_caps votes original shape: (1024, 16, 10, 16)
2020-06-26 23:10:38 INFO: class_caps votes in to routing shape: (64, 256, 10, 16)
2020-06-26 23:10:38 INFO: class_caps activation shape: (64, 10)
2020-06-26 23:10:38 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 23:10:39 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 23:10:39 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 23:10:39 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 23:10:39 INFO: Restoring parameters from logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/checkpoint/model.ckpt292-125268
2020-06-26 23:11:20 INFO: name: 20200605_03:00:14:427684_
2020-06-26 23:11:20 INFO: parent_dir: logs/mnist/nomod_cap
2020-06-26 23:11:20 INFO: test_dir: logs/mnist/nomod_cap/20200605_03:00:14:427684_/test
2020-06-26 23:11:20 INFO: patch_path: logs/mnist/nomodcap_adv_10/20200613_17:57:35:183119_/train/saved_patch.png
2020-06-26 23:11:20 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/params/params.json
2020-06-26 23:11:20 INFO: Using dataset: mnist
2020-06-26 23:11:20 INFO: BUILD TEST GRAPH
2020-06-26 23:11:20 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 23:11:20 INFO: Overwrite dataset info from restored data version.
2020-06-26 23:11:20 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-06-26 23:11:20 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-06-26 23:11:20 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-06-26 23:11:20 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 23:11:20 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 23:11:20 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 23:11:20 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 23:11:21 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 23:11:21 INFO: input shape: (64, 28, 28, 1)
2020-06-26 23:11:21 INFO: Scale of 0 disables regularizer.
2020-06-26 23:11:21 INFO: relu_conv1 output shape: (64, 14, 14, 64)
2020-06-26 23:11:21 INFO: primary_caps pose shape: (64, 14, 14, 8, 16)
2020-06-26 23:11:21 INFO: primary_caps activation shape (64, 14, 14, 8, 1)
2020-06-26 23:11:21 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 23:11:21 INFO: lyr.conv_caps1 votes shape: (2304, 72, 16, 16)
2020-06-26 23:11:21 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 23:11:21 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 23:11:21 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 23:11:21 INFO: lyr.conv_caps1 pose_out shape: (64, 6, 6, 16, 16)
2020-06-26 23:11:21 INFO: lyr.conv_caps1 activation_out shape: (64, 6, 6, 16, 1)
2020-06-26 23:11:21 INFO: lyr.conv_caps2 votes shape: (1024, 144, 16, 16)
2020-06-26 23:11:22 INFO: lyr.conv_caps2 pose_out shape: (64, 4, 4, 16, 16)
2020-06-26 23:11:22 INFO: lyr.conv_caps2 activation_out shape: (64, 4, 4, 16, 1)
2020-06-26 23:11:22 INFO: class_caps votes original shape: (1024, 16, 10, 16)
2020-06-26 23:11:22 INFO: class_caps votes in to routing shape: (64, 256, 10, 16)
2020-06-26 23:11:22 INFO: class_caps activation shape: (64, 10)
2020-06-26 23:11:22 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 23:11:22 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 23:11:23 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 23:11:23 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 23:11:23 INFO: Restoring parameters from logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/checkpoint/model.ckpt292-125268
2020-06-26 23:23:51 INFO: name: 20200605_03:00:14:427684_
2020-06-26 23:23:51 INFO: parent_dir: logs/mnist/nomod_cap
2020-06-26 23:23:51 INFO: test_dir: logs/mnist/nomod_cap/20200605_03:00:14:427684_/test
2020-06-26 23:23:51 INFO: patch_path: logs/mnist/nomodcap_adv_15/20200613_17:57:35:183021_/train/saved_patch.png
2020-06-26 23:23:51 INFO: patch_path: logs/mnist/nomodcap_adv_25/20200613_17:57:35:183737_/train/saved_patch.png
2020-06-26 23:23:51 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/params/params.json
2020-06-26 23:23:51 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/params/params.json
2020-06-26 23:23:51 INFO: Using dataset: mnist
2020-06-26 23:23:51 INFO: Using dataset: mnist
2020-06-26 23:23:51 INFO: BUILD TEST GRAPH
2020-06-26 23:23:51 INFO: BUILD TEST GRAPH
2020-06-26 23:23:51 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 23:23:51 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 23:23:51 INFO: Overwrite dataset info from restored data version.
2020-06-26 23:23:51 INFO: Overwrite dataset info from restored data version.
2020-06-26 23:23:51 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-06-26 23:23:51 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-06-26 23:23:51 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-06-26 23:23:51 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-06-26 23:23:51 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-06-26 23:23:51 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 23:23:51 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 23:23:51 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 23:23:51 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 23:23:51 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 23:23:51 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 23:23:52 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 23:23:52 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 23:23:52 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 23:23:52 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 23:23:52 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 23:23:52 INFO: input shape: (64, 28, 28, 1)
2020-06-26 23:23:52 INFO: input shape: (64, 28, 28, 1)
er.
2020-06-26 23:23:52 INFO: Scale of 0 disables regularizer.
2020-06-26 23:23:52 INFO: relu_conv1 output shape: (64, 14, 14, 64)
2020-06-26 23:23:52 INFO: relu_conv1 output shape: (64, 14, 14, 64)
2020-06-26 23:23:52 INFO: relu_conv1 output shape: (64, 14, 14, 64)
6)
2020-06-26 23:23:52 INFO: primary_caps activation shape (64, 14, 14, 8, 1)
2020-06-26 23:23:52 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 23:23:52 INFO: primary_caps pose shape: (64, 14, 14, 8, 16)
2020-06-26 23:23:52 INFO: primary_caps pose shape: (64, 14, 14, 8, 16)
 1)
2020-06-26 23:23:52 INFO: primary_caps activation shape (64, 14, 14, 8, 1)
ith-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 23:23:52 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 23:23:53 INFO: lyr.conv_caps1 votes shape: (2304, 72, 16, 16)
-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 23:23:53 INFO: lyr.conv_caps1 votes shape: (2304, 72, 16, 16)
2020-06-26 23:23:53 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
which has the same broadcast rule as np.where
2020-06-26 23:23:53 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 23:23:53 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 23:23:53 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 23:23:53 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 23:23:53 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 23:23:53 INFO: lyr.conv_caps1 activation_out shape: (64, 6, 6, 16, 1)
2020-06-26 23:23:53 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 23:23:53 INFO: lyr.conv_caps1 pose_out shape: (64, 6, 6, 16, 16)
2020-06-26 23:23:53 INFO: lyr.conv_caps2 votes shape: (1024, 144, 16, 16)
2020-06-26 23:23:53 INFO: lyr.conv_caps1 activation_out shape: (64, 6, 6, 16, 1)
2020-06-26 23:23:53 INFO: lyr.conv_caps1 pose_out shape: (64, 6, 6, 16, 16)
2020-06-26 23:23:53 INFO: lyr.conv_caps1 activation_out shape: (64, 6, 6, 16, 1)
2020-06-26 23:23:53 INFO: lyr.conv_caps2 votes shape: (1024, 144, 16, 16)
2020-06-26 23:23:53 INFO: lyr.conv_caps2 pose_out shape: (64, 4, 4, 16, 16)
2020-06-26 23:23:53 INFO: lyr.conv_caps2 activation_out shape: (64, 4, 4, 16, 1)
2020-06-26 23:23:53 INFO: class_caps votes original shape: (1024, 16, 10, 16)
2020-06-26 23:23:53 INFO: lyr.conv_caps2 pose_out shape: (64, 4, 4, 16, 16)
2020-06-26 23:23:53 INFO: class_caps votes in to routing shape: (64, 256, 10, 16)
2020-06-26 23:23:53 INFO: lyr.conv_caps2 activation_out shape: (64, 4, 4, 16, 1)
2020-06-26 23:23:53 INFO: lyr.conv_caps2 activation_out shape: (64, 4, 4, 16, 1)
2020-06-26 23:23:53 INFO: class_caps votes original shape: (1024, 16, 10, 16)
2020-06-26 23:23:53 INFO: class_caps votes in to routing shape: (64, 256, 10, 16)
2020-06-26 23:23:53 INFO: class_caps votes original shape: (1024, 16, 10, 16)
2020-06-26 23:23:53 INFO: class_caps votes in to routing shape: (64, 256, 10, 16)
2020-06-26 23:23:53 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 23:23:53 INFO: class_caps activation shape: (64, 10)
2020-06-26 23:23:53 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 23:23:53 INFO: class_caps activation shape: (64, 10)
2020-06-26 23:23:53 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 23:23:53 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 23:23:53 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 23:23:53 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 23:23:54 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 23:23:54 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 23:23:54 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 23:23:54 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 23:23:54 INFO: Restoring parameters from logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/checkpoint/model.ckpt292-125268
2020-06-26 23:23:54 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 23:23:54 INFO: Restoring parameters from logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/checkpoint/model.ckpt292-125268
2020-06-26 23:33:23 INFO: writing to csv
2020-06-26 23:33:23 INFO: csv saved at logs/mnist/nomod_cap/20200605_03:00:14:427684_/test/logs_mnist_nomodcap_adv_00_20200613_17_57_35_190094__train_saved_patch_png_test.csv
2020-06-26 23:33:37 INFO: writing to csv
2020-06-26 23:33:37 INFO: csv saved at logs/mnist/nomod_cap/20200605_03:00:14:427684_/test/logs_mnist_nomodcap_adv_05_20200613_17_57_35_183021__train_saved_patch_png_test.csv
2020-06-26 23:33:44 INFO: name: 20200605_03:00:14:427684_
2020-06-26 23:33:44 INFO: parent_dir: logs/mnist/nomod_cap
2020-06-26 23:33:44 INFO: test_dir: logs/mnist/nomod_cap/20200605_03:00:14:427684_/test
2020-06-26 23:33:44 INFO: patch_path: logs/mnist/nomodcap_adv_35/20200613_17:57:52:399077_/train/saved_patch.png
2020-06-26 23:33:45 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/params/params.json
2020-06-26 23:33:45 INFO: Using dataset: mnist
2020-06-26 23:33:45 INFO: BUILD TEST GRAPH
2020-06-26 23:33:45 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 23:33:45 INFO: Overwrite dataset info from restored data version.
2020-06-26 23:33:45 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-06-26 23:33:45 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-06-26 23:33:45 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-06-26 23:33:46 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 23:33:46 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 23:33:46 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 23:33:46 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 23:33:47 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 23:33:47 INFO: input shape: (64, 28, 28, 1)
2020-06-26 23:33:47 INFO: Scale of 0 disables regularizer.
2020-06-26 23:33:47 INFO: relu_conv1 output shape: (64, 14, 14, 64)
2020-06-26 23:33:47 INFO: primary_caps pose shape: (64, 14, 14, 8, 16)
2020-06-26 23:33:48 INFO: primary_caps activation shape (64, 14, 14, 8, 1)
2020-06-26 23:33:48 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 23:33:48 INFO: lyr.conv_caps1 votes shape: (2304, 72, 16, 16)
2020-06-26 23:33:48 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 23:33:48 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 23:33:48 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 23:33:48 INFO: lyr.conv_caps1 pose_out shape: (64, 6, 6, 16, 16)
2020-06-26 23:33:48 INFO: lyr.conv_caps1 activation_out shape: (64, 6, 6, 16, 1)
2020-06-26 23:33:49 INFO: lyr.conv_caps2 votes shape: (1024, 144, 16, 16)
2020-06-26 23:33:49 INFO: lyr.conv_caps2 pose_out shape: (64, 4, 4, 16, 16)
2020-06-26 23:33:49 INFO: lyr.conv_caps2 activation_out shape: (64, 4, 4, 16, 1)
2020-06-26 23:33:49 INFO: class_caps votes original shape: (1024, 16, 10, 16)
2020-06-26 23:33:49 INFO: class_caps votes in to routing shape: (64, 256, 10, 16)
2020-06-26 23:33:49 INFO: class_caps activation shape: (64, 10)
2020-06-26 23:33:49 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 23:33:49 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 23:33:50 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 23:33:50 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 23:33:50 INFO: Restoring parameters from logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/checkpoint/model.ckpt292-125268
2020-06-26 23:34:05 INFO: name: 20200605_03:00:14:427684_
2020-06-26 23:34:05 INFO: parent_dir: logs/mnist/nomod_cap
2020-06-26 23:34:05 INFO: test_dir: logs/mnist/nomod_cap/20200605_03:00:14:427684_/test
2020-06-26 23:34:05 INFO: patch_path: logs/mnist/nomodcap_adv_30/20200613_17:57:35:183706_/train/saved_patch.png
2020-06-26 23:34:05 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/params/params.json
2020-06-26 23:34:05 INFO: Using dataset: mnist
2020-06-26 23:34:05 INFO: BUILD TEST GRAPH
2020-06-26 23:34:05 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 23:34:06 INFO: Overwrite dataset info from restored data version.
2020-06-26 23:34:06 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-06-26 23:34:06 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-06-26 23:34:06 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-06-26 23:34:07 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 23:34:07 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 23:34:07 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 23:34:07 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 23:34:07 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 23:34:07 INFO: input shape: (64, 28, 28, 1)
2020-06-26 23:34:07 INFO: Scale of 0 disables regularizer.
2020-06-26 23:34:08 INFO: relu_conv1 output shape: (64, 14, 14, 64)
2020-06-26 23:34:08 INFO: primary_caps pose shape: (64, 14, 14, 8, 16)
2020-06-26 23:34:08 INFO: primary_caps activation shape (64, 14, 14, 8, 1)
2020-06-26 23:34:08 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 23:34:08 INFO: lyr.conv_caps1 votes shape: (2304, 72, 16, 16)
2020-06-26 23:34:08 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 23:34:08 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 23:34:08 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 23:34:09 INFO: lyr.conv_caps1 pose_out shape: (64, 6, 6, 16, 16)
2020-06-26 23:34:09 INFO: lyr.conv_caps1 activation_out shape: (64, 6, 6, 16, 1)
2020-06-26 23:34:09 INFO: lyr.conv_caps2 votes shape: (1024, 144, 16, 16)
2020-06-26 23:34:09 INFO: lyr.conv_caps2 pose_out shape: (64, 4, 4, 16, 16)
2020-06-26 23:34:09 INFO: lyr.conv_caps2 activation_out shape: (64, 4, 4, 16, 1)
2020-06-26 23:34:09 INFO: class_caps votes original shape: (1024, 16, 10, 16)
2020-06-26 23:34:09 INFO: class_caps votes in to routing shape: (64, 256, 10, 16)
2020-06-26 23:34:10 INFO: class_caps activation shape: (64, 10)
2020-06-26 23:34:10 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 23:34:10 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 23:34:10 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 23:34:11 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 23:34:11 INFO: Restoring parameters from logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/checkpoint/model.ckpt292-125268
2020-06-26 23:34:25 INFO: writing to csv
2020-06-26 23:34:25 INFO: csv saved at logs/mnist/nomod_cap/20200605_03:00:14:427684_/test/logs_mnist_nomodcap_adv_10_20200613_17_57_35_183119__train_saved_patch_png_test.csv
2020-06-26 23:34:31 INFO: name: 20200605_03:00:14:427684_
2020-06-26 23:34:31 INFO: parent_dir: logs/mnist/nomod_cap
2020-06-26 23:34:32 INFO: test_dir: logs/mnist/nomod_cap/20200605_03:00:14:427684_/test
2020-06-26 23:34:32 INFO: patch_path: logs/mnist/nomodcap_adv_40/20200613_17:58:25:830000_/train/saved_patch.png
2020-06-26 23:34:32 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/params/params.json
2020-06-26 23:34:32 INFO: Using dataset: mnist
2020-06-26 23:34:32 INFO: BUILD TEST GRAPH
2020-06-26 23:34:32 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 23:34:32 INFO: Overwrite dataset info from restored data version.
2020-06-26 23:34:32 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-06-26 23:34:32 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-06-26 23:34:32 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-06-26 23:34:33 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 23:34:33 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 23:34:33 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 23:34:33 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 23:34:33 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 23:34:34 INFO: input shape: (64, 28, 28, 1)
2020-06-26 23:34:34 INFO: Scale of 0 disables regularizer.
2020-06-26 23:34:34 INFO: relu_conv1 output shape: (64, 14, 14, 64)
2020-06-26 23:34:34 INFO: primary_caps pose shape: (64, 14, 14, 8, 16)
2020-06-26 23:34:34 INFO: primary_caps activation shape (64, 14, 14, 8, 1)
2020-06-26 23:34:35 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 23:34:35 INFO: lyr.conv_caps1 votes shape: (2304, 72, 16, 16)
2020-06-26 23:34:35 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 23:34:35 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 23:34:35 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 23:34:35 INFO: lyr.conv_caps1 pose_out shape: (64, 6, 6, 16, 16)
2020-06-26 23:34:36 INFO: lyr.conv_caps1 activation_out shape: (64, 6, 6, 16, 1)
2020-06-26 23:34:36 INFO: lyr.conv_caps2 votes shape: (1024, 144, 16, 16)
2020-06-26 23:34:36 INFO: lyr.conv_caps2 pose_out shape: (64, 4, 4, 16, 16)
2020-06-26 23:34:36 INFO: lyr.conv_caps2 activation_out shape: (64, 4, 4, 16, 1)
2020-06-26 23:34:36 INFO: class_caps votes original shape: (1024, 16, 10, 16)
2020-06-26 23:34:36 INFO: class_caps votes in to routing shape: (64, 256, 10, 16)
2020-06-26 23:34:36 INFO: class_caps activation shape: (64, 10)
2020-06-26 23:34:36 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 23:34:37 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 23:34:37 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 23:34:37 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 23:34:37 INFO: Restoring parameters from logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/checkpoint/model.ckpt292-125268
2020-06-26 23:38:10 INFO: name: 20200605_03:00:14:427684_
2020-06-26 23:38:10 INFO: parent_dir: logs/mnist/nomod_cap
2020-06-26 23:38:10 INFO: test_dir: logs/mnist/nomod_cap/20200605_03:00:14:427684_/test
2020-06-26 23:38:10 INFO: patch_path: logs/mnist/nomodcap_adv_45/20200613_17:58:25:667432_/train/saved_patch.png
2020-06-26 23:38:10 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/params/params.json
2020-06-26 23:38:10 INFO: Using dataset: mnist
2020-06-26 23:38:11 INFO: BUILD TEST GRAPH
2020-06-26 23:38:11 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 23:38:11 INFO: Overwrite dataset info from restored data version.
2020-06-26 23:38:11 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-06-26 23:38:11 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-06-26 23:38:11 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-06-26 23:38:11 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 23:38:12 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 23:38:12 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 23:38:12 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 23:38:12 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 23:38:13 INFO: input shape: (64, 28, 28, 1)
2020-06-26 23:38:13 INFO: Scale of 0 disables regularizer.
2020-06-26 23:38:13 INFO: relu_conv1 output shape: (64, 14, 14, 64)
2020-06-26 23:38:13 INFO: primary_caps pose shape: (64, 14, 14, 8, 16)
2020-06-26 23:38:13 INFO: primary_caps activation shape (64, 14, 14, 8, 1)
2020-06-26 23:38:13 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 23:38:13 INFO: lyr.conv_caps1 votes shape: (2304, 72, 16, 16)
2020-06-26 23:38:13 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 23:38:13 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 23:38:14 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 23:38:14 INFO: lyr.conv_caps1 pose_out shape: (64, 6, 6, 16, 16)
2020-06-26 23:38:14 INFO: lyr.conv_caps1 activation_out shape: (64, 6, 6, 16, 1)
2020-06-26 23:38:14 INFO: lyr.conv_caps2 votes shape: (1024, 144, 16, 16)
2020-06-26 23:38:14 INFO: lyr.conv_caps2 pose_out shape: (64, 4, 4, 16, 16)
2020-06-26 23:38:14 INFO: lyr.conv_caps2 activation_out shape: (64, 4, 4, 16, 1)
2020-06-26 23:38:14 INFO: class_caps votes original shape: (1024, 16, 10, 16)
2020-06-26 23:38:15 INFO: class_caps votes in to routing shape: (64, 256, 10, 16)
2020-06-26 23:38:15 INFO: class_caps activation shape: (64, 10)
2020-06-26 23:38:15 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 23:38:15 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 23:38:16 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 23:38:16 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 23:38:16 INFO: Restoring parameters from logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/checkpoint/model.ckpt292-125268
2020-06-26 23:45:14 INFO: name: 20200605_03:00:14:427684_
2020-06-26 23:45:14 INFO: parent_dir: logs/mnist/nomod_cap
2020-06-26 23:45:14 INFO: test_dir: logs/mnist/nomod_cap/20200605_03:00:14:427684_/test
2020-06-26 23:45:14 INFO: patch_path: logs/mnist/nomodcap_adv_50/20200613_18:19:45:657219_/train/saved_patch.png
2020-06-26 23:45:14 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/params/params.json
2020-06-26 23:45:15 INFO: Using dataset: mnist
2020-06-26 23:45:15 INFO: BUILD TEST GRAPH
2020-06-26 23:45:15 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 23:45:15 INFO: Overwrite dataset info from restored data version.
2020-06-26 23:45:15 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-06-26 23:45:15 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-06-26 23:45:15 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-06-26 23:45:16 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 23:45:16 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 23:45:16 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 23:45:16 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 23:45:17 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 23:45:17 INFO: input shape: (64, 28, 28, 1)
2020-06-26 23:45:17 INFO: Scale of 0 disables regularizer.
2020-06-26 23:45:17 INFO: relu_conv1 output shape: (64, 14, 14, 64)
2020-06-26 23:45:18 INFO: primary_caps pose shape: (64, 14, 14, 8, 16)
2020-06-26 23:45:18 INFO: primary_caps activation shape (64, 14, 14, 8, 1)
2020-06-26 23:45:18 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 23:45:18 INFO: lyr.conv_caps1 votes shape: (2304, 72, 16, 16)
2020-06-26 23:45:18 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 23:45:18 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 23:45:19 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 23:45:19 INFO: lyr.conv_caps1 pose_out shape: (64, 6, 6, 16, 16)
2020-06-26 23:45:19 INFO: lyr.conv_caps1 activation_out shape: (64, 6, 6, 16, 1)
2020-06-26 23:45:19 INFO: lyr.conv_caps2 votes shape: (1024, 144, 16, 16)
2020-06-26 23:45:19 INFO: lyr.conv_caps2 pose_out shape: (64, 4, 4, 16, 16)
2020-06-26 23:45:19 INFO: lyr.conv_caps2 activation_out shape: (64, 4, 4, 16, 1)
2020-06-26 23:45:19 INFO: class_caps votes original shape: (1024, 16, 10, 16)
2020-06-26 23:45:19 INFO: class_caps votes in to routing shape: (64, 256, 10, 16)
2020-06-26 23:45:20 INFO: class_caps activation shape: (64, 10)
2020-06-26 23:45:20 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 23:45:20 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 23:45:20 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 23:45:21 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 23:45:21 INFO: Restoring parameters from logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/checkpoint/model.ckpt292-125268
2020-06-26 23:46:46 INFO: writing to csv
2020-06-26 23:46:47 INFO: csv saved at logs/mnist/nomod_cap/20200605_03:00:14:427684_/test/logs_mnist_nomodcap_adv_20_20200613_17_57_35_183201__train_saved_patch_png_test.csv
2020-06-26 23:46:52 INFO: writing to csv
2020-06-26 23:46:52 INFO: csv saved at logs/mnist/nomod_cap/20200605_03:00:14:427684_/test/logs_mnist_nomodcap_adv_25_20200613_17_57_35_183737__train_saved_patch_png_test.csv
2020-06-26 23:46:53 INFO: name: 20200605_03:00:14:427684_
2020-06-26 23:46:54 INFO: parent_dir: logs/mnist/nomod_cap
2020-06-26 23:46:54 INFO: test_dir: logs/mnist/nomod_cap/20200605_03:00:14:427684_/test
2020-06-26 23:46:54 INFO: patch_path: logs/mnist/nomodcap_adv_hun/20200613_18:35:13:369111_/train/saved_patch.png
2020-06-26 23:46:54 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/params/params.json
2020-06-26 23:46:54 INFO: Using dataset: mnist
2020-06-26 23:46:54 INFO: BUILD TEST GRAPH
2020-06-26 23:46:54 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 23:46:54 INFO: Overwrite dataset info from restored data version.
2020-06-26 23:46:54 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-06-26 23:46:54 INFO: writing to csv
2020-06-26 23:46:55 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-06-26 23:46:55 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-06-26 23:46:55 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 23:46:55 INFO: csv saved at logs/mnist/nomod_cap/20200605_03:00:14:427684_/test/logs_mnist_nomodcap_adv_15_20200613_17_57_35_183021__train_saved_patch_png_test.csv
2020-06-26 23:46:55 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 23:46:56 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 23:46:56 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 23:46:56 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 23:46:56 INFO: input shape: (64, 28, 28, 1)
2020-06-26 23:46:56 INFO: Scale of 0 disables regularizer.
2020-06-26 23:46:57 INFO: relu_conv1 output shape: (64, 14, 14, 64)
2020-06-26 23:46:57 INFO: primary_caps pose shape: (64, 14, 14, 8, 16)
2020-06-26 23:46:57 INFO: primary_caps activation shape (64, 14, 14, 8, 1)
2020-06-26 23:46:57 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 23:46:57 INFO: lyr.conv_caps1 votes shape: (2304, 72, 16, 16)
2020-06-26 23:46:57 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 23:46:58 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 23:46:58 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 23:46:58 INFO: lyr.conv_caps1 pose_out shape: (64, 6, 6, 16, 16)
2020-06-26 23:46:58 INFO: lyr.conv_caps1 activation_out shape: (64, 6, 6, 16, 1)
2020-06-26 23:46:58 INFO: lyr.conv_caps2 votes shape: (1024, 144, 16, 16)
2020-06-26 23:46:58 INFO: lyr.conv_caps2 pose_out shape: (64, 4, 4, 16, 16)
2020-06-26 23:46:59 INFO: lyr.conv_caps2 activation_out shape: (64, 4, 4, 16, 1)
2020-06-26 23:46:59 INFO: parent_dir: logs/mnist/nomod_cap
2020-06-26 23:46:59 INFO: class_caps votes original shape: (1024, 16, 10, 16)
684_/test
2020-06-26 23:46:59 INFO: patch_path: logs/mnist/nomodcap_adv_ten/20200613_18:35:13:369721_/train/saved_patch.png
2020-06-26 23:46:59 INFO: class_caps votes in to routing shape: (64, 256, 10, 16)
rix-capsules-with-em-routing/logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/params/params.json
2020-06-26 23:46:59 INFO: Using dataset: mnist
2020-06-26 23:46:59 INFO: BUILD TEST GRAPH
2020-06-26 23:46:59 INFO: class_caps activation shape: (64, 10)
2020-06-26 23:47:00 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 23:47:00 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 23:47:00 INFO: Overwrite dataset info from restored data version.
2020-06-26 23:47:00 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-06-26 23:47:00 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-06-26 23:47:00 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-06-26 23:47:00 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 23:47:00 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 23:47:00 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 23:47:01 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 23:47:01 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 23:47:01 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 23:47:01 INFO: name: 20200605_03:00:14:427684_
2020-06-26 23:47:01 INFO: parent_dir: logs/mnist/nomod_cap
2020-06-26 23:47:01 INFO: test_dir: logs/mnist/nomod_cap/20200605_03:00:14:427684_/test
2020-06-26 23:47:01 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 23:47:01 INFO: Restoring parameters from logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/checkpoint/model.ckpt292-125268
605_03:00:14:427684_/train/params/params.json
2020-06-26 23:47:01 INFO: Using dataset: mnist
2020-06-26 23:47:01 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 23:47:01 INFO: BUILD TEST GRAPH
2020-06-26 23:47:02 INFO: input shape: (64, 28, 28, 1)
2020-06-26 23:47:02 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 23:47:02 INFO: Scale of 0 disables regularizer.
2020-06-26 23:47:02 INFO: Overwrite dataset info from restored data version.
2020-06-26 23:47:02 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-06-26 23:47:02 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-06-26 23:47:02 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-06-26 23:47:02 INFO: relu_conv1 output shape: (64, 14, 14, 64)
2020-06-26 23:47:02 INFO: primary_caps pose shape: (64, 14, 14, 8, 16)
2020-06-26 23:47:02 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 23:47:03 INFO: primary_caps activation shape (64, 14, 14, 8, 1)
2020-06-26 23:47:03 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 23:47:03 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 23:47:03 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 23:47:03 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 23:47:03 INFO: lyr.conv_caps1 votes shape: (2304, 72, 16, 16)
2020-06-26 23:47:04 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 23:47:04 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 23:47:04 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 23:47:04 INFO: lyr.conv_caps1 pose_out shape: (64, 6, 6, 16, 16)
2020-06-26 23:47:04 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 23:47:04 INFO: lyr.conv_caps1 activation_out shape: (64, 6, 6, 16, 1)
2020-06-26 23:47:04 INFO: input shape: (64, 28, 28, 1)
2020-06-26 23:47:04 INFO: lyr.conv_caps2 votes shape: (1024, 144, 16, 16)
2020-06-26 23:47:04 INFO: Scale of 0 disables regularizer.
2020-06-26 23:47:05 INFO: lyr.conv_caps2 pose_out shape: (64, 4, 4, 16, 16)
2020-06-26 23:47:05 INFO: lyr.conv_caps2 activation_out shape: (64, 4, 4, 16, 1)
2020-06-26 23:47:05 INFO: class_caps votes original shape: (1024, 16, 10, 16)
2020-06-26 23:47:05 INFO: relu_conv1 output shape: (64, 14, 14, 64)
2020-06-26 23:47:05 INFO: class_caps votes in to routing shape: (64, 256, 10, 16)
2020-06-26 23:47:05 INFO: primary_caps pose shape: (64, 14, 14, 8, 16)
2020-06-26 23:47:05 INFO: primary_caps activation shape (64, 14, 14, 8, 1)
2020-06-26 23:47:05 INFO: class_caps activation shape: (64, 10)
-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 23:47:05 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 23:47:06 INFO: lyr.conv_caps1 votes shape: (2304, 72, 16, 16)
2020-06-26 23:47:06 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 23:47:06 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 23:47:06 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 23:47:06 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 23:47:06 INFO: lyr.conv_caps1 pose_out shape: (64, 6, 6, 16, 16)
2020-06-26 23:47:06 INFO: lyr.conv_caps1 activation_out shape: (64, 6, 6, 16, 1)
2020-06-26 23:47:06 INFO: lyr.conv_caps2 votes shape: (1024, 144, 16, 16)
2020-06-26 23:47:07 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 23:47:07 INFO: lyr.conv_caps2 pose_out shape: (64, 4, 4, 16, 16)
2020-06-26 23:47:07 INFO: lyr.conv_caps2 activation_out shape: (64, 4, 4, 16, 1)
2020-06-26 23:47:07 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 23:47:07 INFO: class_caps votes original shape: (1024, 16, 10, 16)
2020-06-26 23:47:07 INFO: Restoring parameters from logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/checkpoint/model.ckpt292-125268
2020-06-26 23:47:07 INFO: class_caps votes in to routing shape: (64, 256, 10, 16)
2020-06-26 23:47:07 INFO: class_caps activation shape: (64, 10)
2020-06-26 23:47:07 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 23:47:08 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 23:47:08 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 23:47:08 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 23:47:08 INFO: Restoring parameters from logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/checkpoint/model.ckpt292-125268
2020-06-26 23:56:48 INFO: writing to csv
2020-06-26 23:56:49 INFO: csv saved at logs/mnist/nomod_cap/20200605_03:00:14:427684_/test/logs_mnist_nomodcap_adv_35_20200613_17_57_52_399077__train_saved_patch_png_test.csv
2020-06-26 23:57:10 INFO: writing to csv
2020-06-26 23:57:11 INFO: csv saved at logs/mnist/nomod_cap/20200605_03:00:14:427684_/test/logs_mnist_nomodcap_adv_30_20200613_17_57_35_183706__train_saved_patch_png_test.csv
2020-06-26 23:57:30 INFO: name: 20200605_03:00:14:427684_
2020-06-26 23:57:30 INFO: parent_dir: logs/mnist/nomod_cap
2020-06-26 23:57:30 INFO: test_dir: logs/mnist/nomod_cap/20200605_03:00:14:427684_/test
2020-06-26 23:57:30 INFO: patch_path: logs/mnist/nomodcap_adv_tnk/20200613_18:35:13:370155_/train/saved_patch.png
2020-06-26 23:57:30 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/params/params.json
2020-06-26 23:57:30 INFO: Using dataset: mnist
2020-06-26 23:57:30 INFO: BUILD TEST GRAPH
2020-06-26 23:57:31 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 23:57:31 INFO: Overwrite dataset info from restored data version.
2020-06-26 23:57:31 INFO: Field info.location from disk and from code do not match. Keeping the one from code.
2020-06-26 23:57:31 INFO: Reusing dataset mnist (/home/xxd9704/tensorflow_datasets/mnist/1.0.0)
2020-06-26 23:57:31 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/mnist/1.0.0
2020-06-26 23:57:31 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/mnist.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 23:57:31 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 23:57:31 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 23:57:32 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 23:57:32 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 23:57:32 INFO: input shape: (64, 28, 28, 1)
2020-06-26 23:57:32 INFO: Scale of 0 disables regularizer.
2020-06-26 23:57:33 INFO: relu_conv1 output shape: (64, 14, 14, 64)
2020-06-26 23:57:33 INFO: primary_caps pose shape: (64, 14, 14, 8, 16)
2020-06-26 23:57:33 INFO: primary_caps activation shape (64, 14, 14, 8, 1)
2020-06-26 23:57:33 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 23:57:33 INFO: lyr.conv_caps1 votes shape: (2304, 72, 16, 16)
2020-06-26 23:57:33 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 23:57:33 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 23:57:33 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 23:57:33 INFO: lyr.conv_caps1 pose_out shape: (64, 6, 6, 16, 16)
2020-06-26 23:57:33 INFO: lyr.conv_caps1 activation_out shape: (64, 6, 6, 16, 1)
2020-06-26 23:57:33 INFO: lyr.conv_caps2 votes shape: (1024, 144, 16, 16)
2020-06-26 23:57:34 INFO: lyr.conv_caps2 pose_out shape: (64, 4, 4, 16, 16)
2020-06-26 23:57:34 INFO: lyr.conv_caps2 activation_out shape: (64, 4, 4, 16, 1)
2020-06-26 23:57:34 INFO: class_caps votes original shape: (1024, 16, 10, 16)
2020-06-26 23:57:34 INFO: class_caps votes in to routing shape: (64, 256, 10, 16)
2020-06-26 23:57:34 INFO: class_caps activation shape: (64, 10)
2020-06-26 23:57:34 INFO: class_caps pose shape: (64, 10, 16)
2020-06-26 23:57:35 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 23:57:35 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 23:57:36 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 23:57:36 INFO: Restoring parameters from logs/mnist/nomod_cap/20200605_03:00:14:427684_/train/checkpoint/model.ckpt292-125268
2020-06-26 23:57:38 INFO: writing to csv
2020-06-26 23:57:38 INFO: csv saved at logs/mnist/nomod_cap/20200605_03:00:14:427684_/test/logs_mnist_nomodcap_adv_40_20200613_17_58_25_830000__train_saved_patch_png_test.csv
2020-06-27 00:01:05 INFO: writing to csv
2020-06-27 00:01:06 INFO: csv saved at logs/mnist/nomod_cap/20200605_03:00:14:427684_/test/logs_mnist_nomodcap_adv_45_20200613_17_58_25_667432__train_saved_patch_png_test.csv
2020-06-27 00:08:12 INFO: writing to csv
2020-06-27 00:08:13 INFO: csv saved at logs/mnist/nomod_cap/20200605_03:00:14:427684_/test/logs_mnist_nomodcap_adv_50_20200613_18_19_45_657219__train_saved_patch_png_test.csv
2020-06-27 00:09:50 INFO: writing to csv
2020-06-27 00:09:51 INFO: csv saved at logs/mnist/nomod_cap/20200605_03:00:14:427684_/test/logs_mnist_nomodcap_adv_hun_20200613_18_35_13_369111__train_saved_patch_png_test.csv
2020-06-27 00:10:00 INFO: writing to csv
2020-06-27 00:10:01 INFO: csv saved at logs/mnist/nomod_cap/20200605_03:00:14:427684_/test/logs_mnist_nomodcap_adv_tho_20200613_18_35_13_369235__train_saved_patch_png_test.csv
2020-06-27 00:10:02 INFO: writing to csv
2020-06-27 00:10:03 INFO: csv saved at logs/mnist/nomod_cap/20200605_03:00:14:427684_/test/logs_mnist_nomodcap_adv_ten_20200613_18_35_13_369721__train_saved_patch_png_test.csv
2020-06-27 00:20:22 INFO: writing to csv
2020-06-27 00:20:22 INFO: csv saved at logs/mnist/nomod_cap/20200605_03:00:14:427684_/test/logs_mnist_nomodcap_adv_tnk_20200613_18_35_13_370155__train_saved_patch_png_test.csv
