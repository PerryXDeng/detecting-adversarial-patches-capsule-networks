2020-06-26 04:52:55 INFO: name: 20200604_15:10:41:870680_
2020-06-26 04:52:55 INFO: parent_dir: logs/svhn/nomod_cap
2020-06-26 04:52:55 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
2020-06-26 04:52:55 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 04:52:55 INFO: name: 20200604_15:10:41:870680_
2020-06-26 04:52:55 INFO: Using dataset: svhn
2020-06-26 04:52:55 INFO: parent_dir: logs/svhn/nomod_cap
2020-06-26 04:52:55 INFO: BUILD TEST GRAPH
2020-06-26 04:52:56 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
2020-06-26 04:52:56 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:52:56 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 04:52:56 INFO: Overwrite dataset info from restored data version.
2020-06-26 04:52:57 INFO: Using dataset: svhn
2020-06-26 04:52:57 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:52:57 INFO: BUILD TEST GRAPH
2020-06-26 04:52:57 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:52:57 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:52:58 INFO: Overwrite dataset info from restored data version.
2020-06-26 04:52:58 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:52:58 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:52:59 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:52:59 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 04:53:00 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:53:00 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:53:00 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:53:00 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:53:00 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 04:53:00 INFO: input shape: (12, 32, 32, 3)
2020-06-26 04:53:00 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:53:00 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:53:00 INFO: relu_conv1 output shape: (12, 16, 16, 128)
2020-06-26 04:53:01 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:53:01 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 04:53:01 INFO: input shape: (12, 32, 32, 3)
2020-06-26 04:53:01 INFO: primary_caps activation shape (12, 16, 16, 32, 1)
2020-06-26 04:53:01 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:53:01 INFO: relu_conv1 output shape: (12, 16, 16, 128)
2020-06-26 04:53:01 INFO: lyr.conv_caps1 votes shape: (588, 288, 24, 16)
2020-06-26 04:53:01 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 04:53:02 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 04:53:02 INFO: primary_caps activation shape (12, 16, 16, 32, 1)
2020-06-26 04:53:02 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 04:53:02 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:53:02 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:53:02 INFO: lyr.conv_caps1 votes shape: (588, 288, 24, 16)
2020-06-26 04:53:02 INFO: lyr.conv_caps1 pose_out shape: (12, 7, 7, 24, 16)
2020-06-26 04:53:02 INFO: lyr.conv_caps1 activation_out shape: (12, 7, 7, 24, 1)
-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 04:53:02 INFO: lyr.conv_caps2 votes shape: (300, 216, 32, 16)
2020-06-26 04:53:02 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 04:53:03 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:53:03 INFO: lyr.conv_caps2 pose_out shape: (12, 5, 5, 32, 16)
2020-06-26 04:53:03 INFO: lyr.conv_caps1 pose_out shape: (12, 7, 7, 24, 16)
2020-06-26 04:53:03 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 04:53:03 INFO: lyr.conv_caps1 activation_out shape: (12, 7, 7, 24, 1)
2020-06-26 04:53:03 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 04:53:04 INFO: lyr.conv_caps2 votes shape: (300, 216, 32, 16)
2020-06-26 04:53:04 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 04:53:04 INFO: class_caps activation shape: (12, 10)
2020-06-26 04:53:04 INFO: lyr.conv_caps2 pose_out shape: (12, 5, 5, 32, 16)
2020-06-26 04:53:04 INFO: class_caps pose shape: (12, 10, 16)
2020-06-26 04:53:04 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 04:53:05 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 04:53:05 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 04:53:05 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:53:05 INFO: class_caps activation shape: (12, 10)
2020-06-26 04:53:05 INFO: class_caps pose shape: (12, 10, 16)
2020-06-26 04:53:06 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:53:08 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:53:09 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:53:09 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:53:09 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-26 04:53:09 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:53:09 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-26 04:53:09 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
	 [[save/RestoreV2/_19]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_19]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_19]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 04:53:10 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 04:53:25 INFO: name: 20200604_15:10:41:870680_
2020-06-26 04:53:25 INFO: parent_dir: logs/svhn/nomod_cap
2020-06-26 04:53:25 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
2020-06-26 04:53:25 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 04:53:25 INFO: Using dataset: svhn
2020-06-26 04:53:26 INFO: BUILD TEST GRAPH
2020-06-26 04:53:26 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:53:26 INFO: name: 20200604_15:10:41:870680_
2020-06-26 04:53:27 INFO: Overwrite dataset info from restored data version.
2020-06-26 04:53:27 INFO: parent_dir: logs/svhn/nomod_cap
2020-06-26 04:53:27 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:53:27 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
2020-06-26 04:53:27 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:53:27 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 04:53:28 INFO: Using dataset: svhn
2020-06-26 04:53:28 INFO: BUILD TEST GRAPH
2020-06-26 04:53:28 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:53:28 INFO: Overwrite dataset info from restored data version.
2020-06-26 04:53:29 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:53:29 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:53:30 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:53:30 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 04:53:30 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:53:30 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:53:30 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:53:31 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:53:31 INFO: input shape: (12, 32, 32, 3)
2020-06-26 04:53:31 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 04:53:31 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:53:31 INFO: relu_conv1 output shape: (12, 16, 16, 128)
2020-06-26 04:53:31 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:53:31 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 04:53:31 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:53:32 INFO: primary_caps activation shape (12, 16, 16, 32, 1)
2020-06-26 04:53:32 INFO: input shape: (12, 32, 32, 3)
2020-06-26 04:53:32 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:53:32 INFO: lyr.conv_caps1 votes shape: (588, 288, 24, 16)
2020-06-26 04:53:32 INFO: relu_conv1 output shape: (12, 16, 16, 128)
2020-06-26 04:53:32 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 04:53:33 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 04:53:33 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 04:53:33 INFO: primary_caps activation shape (12, 16, 16, 32, 1)
2020-06-26 04:53:33 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:53:33 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:53:34 INFO: lyr.conv_caps1 pose_out shape: (12, 7, 7, 24, 16)
2020-06-26 04:53:34 INFO: lyr.conv_caps1 votes shape: (588, 288, 24, 16)
2020-06-26 04:53:34 INFO: lyr.conv_caps1 activation_out shape: (12, 7, 7, 24, 1)
2020-06-26 04:53:34 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 04:53:34 INFO: lyr.conv_caps2 votes shape: (300, 216, 32, 16)
2020-06-26 04:53:34 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 04:53:34 INFO: lyr.conv_caps2 pose_out shape: (12, 5, 5, 32, 16)
2020-06-26 04:53:34 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:53:34 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 04:53:34 INFO: lyr.conv_caps1 pose_out shape: (12, 7, 7, 24, 16)
2020-06-26 04:53:34 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 04:53:35 INFO: lyr.conv_caps1 activation_out shape: (12, 7, 7, 24, 1)
2020-06-26 04:53:35 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 04:53:35 INFO: lyr.conv_caps2 votes shape: (300, 216, 32, 16)
2020-06-26 04:53:35 INFO: class_caps activation shape: (12, 10)
2020-06-26 04:53:35 INFO: class_caps pose shape: (12, 10, 16)
2020-06-26 04:53:35 INFO: lyr.conv_caps2 pose_out shape: (12, 5, 5, 32, 16)
2020-06-26 04:53:36 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 04:53:36 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:53:36 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 04:53:36 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 04:53:37 INFO: class_caps activation shape: (12, 10)
2020-06-26 04:53:37 INFO: class_caps pose shape: (12, 10, 16)
2020-06-26 04:53:38 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:53:39 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:53:40 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:53:40 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-26 04:53:40 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
	 [[save/RestoreV2/_3]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_3]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_3]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 04:53:42 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:53:42 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:53:42 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-26 04:53:42 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 04:53:55 INFO: name: 20200604_15:10:41:870680_
2020-06-26 04:53:55 INFO: parent_dir: logs/svhn/nomod_cap
2020-06-26 04:53:55 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
2020-06-26 04:53:55 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 04:53:56 INFO: Using dataset: svhn
2020-06-26 04:53:56 INFO: BUILD TEST GRAPH
2020-06-26 04:53:56 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:53:56 INFO: Overwrite dataset info from restored data version.
2020-06-26 04:53:56 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:53:56 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:53:58 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:53:58 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 04:53:58 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:53:58 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:53:59 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:53:59 INFO: input shape: (12, 32, 32, 3)
2020-06-26 04:53:59 INFO: relu_conv1 output shape: (12, 16, 16, 128)
2020-06-26 04:53:59 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 04:53:59 INFO: primary_caps activation shape (12, 16, 16, 32, 1)
2020-06-26 04:53:59 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:54:00 INFO: lyr.conv_caps1 votes shape: (588, 288, 24, 16)
2020-06-26 04:54:00 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 04:54:00 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 04:54:00 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:54:00 INFO: lyr.conv_caps1 pose_out shape: (12, 7, 7, 24, 16)
2020-06-26 04:54:01 INFO: lyr.conv_caps1 activation_out shape: (12, 7, 7, 24, 1)
2020-06-26 04:54:01 INFO: lyr.conv_caps2 votes shape: (300, 216, 32, 16)
2020-06-26 04:54:01 INFO: lyr.conv_caps2 pose_out shape: (12, 5, 5, 32, 16)
2020-06-26 04:54:01 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 04:54:01 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 04:54:01 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 04:54:02 INFO: class_caps activation shape: (12, 10)
2020-06-26 04:54:02 INFO: class_caps pose shape: (12, 10, 16)
2020-06-26 04:54:02 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:54:07 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:54:08 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:54:08 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-26 04:54:08 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 04:54:25 INFO: name: 20200604_15:10:41:870680_
2020-06-26 04:54:25 INFO: parent_dir: logs/svhn/nomod_cap
2020-06-26 04:54:25 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
2020-06-26 04:54:25 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 04:54:26 INFO: Using dataset: svhn
2020-06-26 04:54:26 INFO: BUILD TEST GRAPH
2020-06-26 04:54:26 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:54:26 INFO: Overwrite dataset info from restored data version.
2020-06-26 04:54:26 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:54:26 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:54:27 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:54:27 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 04:54:27 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:54:27 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:54:27 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:54:27 INFO: input shape: (12, 32, 32, 3)
2020-06-26 04:54:28 INFO: relu_conv1 output shape: (12, 16, 16, 128)
2020-06-26 04:54:28 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 04:54:28 INFO: primary_caps activation shape (12, 16, 16, 32, 1)
2020-06-26 04:54:28 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:54:28 INFO: lyr.conv_caps1 votes shape: (588, 288, 24, 16)
2020-06-26 04:54:28 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 04:54:28 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 04:54:29 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:54:29 INFO: lyr.conv_caps1 pose_out shape: (12, 7, 7, 24, 16)
2020-06-26 04:54:29 INFO: lyr.conv_caps1 activation_out shape: (12, 7, 7, 24, 1)
2020-06-26 04:54:29 INFO: lyr.conv_caps2 votes shape: (300, 216, 32, 16)
2020-06-26 04:54:29 INFO: lyr.conv_caps2 pose_out shape: (12, 5, 5, 32, 16)
2020-06-26 04:54:29 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 04:54:29 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 04:54:29 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 04:54:30 INFO: class_caps activation shape: (12, 10)
2020-06-26 04:54:30 INFO: class_caps pose shape: (12, 10, 16)
2020-06-26 04:54:30 INFO: name: 20200604_15:10:41:870680_
2020-06-26 04:54:30 INFO: parent_dir: logs/svhn/nomod_cap
2020-06-26 04:54:31 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
precated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:54:31 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 04:54:31 INFO: Using dataset: svhn
2020-06-26 04:54:31 INFO: BUILD TEST GRAPH
2020-06-26 04:54:31 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:54:31 INFO: Overwrite dataset info from restored data version.
2020-06-26 04:54:31 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:54:32 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:54:32 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:54:33 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:54:33 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-26 04:54:33 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:54:33 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 04:54:33 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 04:54:33 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:54:33 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:54:34 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:54:34 INFO: input shape: (12, 32, 32, 3)
2020-06-26 04:54:34 INFO: relu_conv1 output shape: (12, 16, 16, 128)
2020-06-26 04:54:34 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 04:54:34 INFO: primary_caps activation shape (12, 16, 16, 32, 1)
2020-06-26 04:54:34 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:54:34 INFO: lyr.conv_caps1 votes shape: (588, 288, 24, 16)
2020-06-26 04:54:34 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 04:54:35 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 04:54:35 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:54:35 INFO: lyr.conv_caps1 pose_out shape: (12, 7, 7, 24, 16)
2020-06-26 04:54:35 INFO: lyr.conv_caps1 activation_out shape: (12, 7, 7, 24, 1)
2020-06-26 04:54:35 INFO: lyr.conv_caps2 votes shape: (300, 216, 32, 16)
2020-06-26 04:54:35 INFO: lyr.conv_caps2 pose_out shape: (12, 5, 5, 32, 16)
2020-06-26 04:54:35 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 04:54:35 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 04:54:36 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 04:54:36 INFO: class_caps activation shape: (12, 10)
2020-06-26 04:54:36 INFO: class_caps pose shape: (12, 10, 16)
2020-06-26 04:54:37 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:54:39 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:54:39 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:54:39 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-26 04:54:39 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
	 [[save/RestoreV2/_19]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_19]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_19]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 04:54:55 INFO: name: 20200604_15:10:41:870680_
2020-06-26 04:54:55 INFO: parent_dir: logs/svhn/nomod_cap
2020-06-26 04:54:55 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
2020-06-26 04:54:56 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 04:54:56 INFO: Using dataset: svhn
2020-06-26 04:54:56 INFO: BUILD TEST GRAPH
2020-06-26 04:54:56 INFO: name: 20200604_15:10:41:870680_
2020-06-26 04:54:56 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:54:56 INFO: parent_dir: logs/svhn/nomod_cap
2020-06-26 04:54:56 INFO: Overwrite dataset info from restored data version.
2020-06-26 04:54:56 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
2020-06-26 04:54:56 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:54:56 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 04:54:56 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:54:56 INFO: Using dataset: svhn
2020-06-26 04:54:56 INFO: BUILD TEST GRAPH
2020-06-26 04:54:57 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:54:57 INFO: Overwrite dataset info from restored data version.
2020-06-26 04:54:57 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:54:57 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:54:58 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:54:58 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 04:54:58 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:54:59 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:54:59 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:54:59 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:54:59 INFO: input shape: (12, 32, 32, 3)
2020-06-26 04:54:59 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 04:55:00 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:55:00 INFO: relu_conv1 output shape: (12, 16, 16, 128)
.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:55:00 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:55:00 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 04:55:00 INFO: input shape: (12, 32, 32, 3)
2020-06-26 04:55:00 INFO: primary_caps activation shape (12, 16, 16, 32, 1)
2020-06-26 04:55:00 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:55:00 INFO: lyr.conv_caps1 votes shape: (588, 288, 24, 16)
2020-06-26 04:55:00 INFO: relu_conv1 output shape: (12, 16, 16, 128)
2020-06-26 04:55:00 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 04:55:00 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 04:55:00 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 04:55:00 INFO: primary_caps activation shape (12, 16, 16, 32, 1)
2020-06-26 04:55:01 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:55:01 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:55:01 INFO: lyr.conv_caps1 pose_out shape: (12, 7, 7, 24, 16)
2020-06-26 04:55:01 INFO: lyr.conv_caps1 votes shape: (588, 288, 24, 16)
2020-06-26 04:55:01 INFO: lyr.conv_caps1 activation_out shape: (12, 7, 7, 24, 1)
2020-06-26 04:55:01 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 04:55:01 INFO: lyr.conv_caps2 votes shape: (300, 216, 32, 16)
2020-06-26 04:55:01 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 04:55:01 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:55:01 INFO: lyr.conv_caps1 pose_out shape: (12, 7, 7, 24, 16)
2020-06-26 04:55:01 INFO: lyr.conv_caps2 pose_out shape: (12, 5, 5, 32, 16)
, 1)
2020-06-26 04:55:01 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 04:55:01 INFO: lyr.conv_caps2 votes shape: (300, 216, 32, 16)
2020-06-26 04:55:01 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 04:55:02 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 04:55:02 INFO: lyr.conv_caps2 pose_out shape: (12, 5, 5, 32, 16)
2020-06-26 04:55:02 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 04:55:02 INFO: class_caps activation shape: (12, 10)
2020-06-26 04:55:02 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 04:55:02 INFO: class_caps pose shape: (12, 10, 16)
2020-06-26 04:55:02 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 04:55:02 INFO: class_caps activation shape: (12, 10)
2020-06-26 04:55:02 INFO: class_caps pose shape: (12, 10, 16)
2020-06-26 04:55:02 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:55:03 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:55:05 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:55:05 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:55:05 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:55:05 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-26 04:55:05 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:55:05 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-26 04:55:05 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
	 [[save/RestoreV2/_3]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_3]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_3]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 04:55:06 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 04:55:25 INFO: name: 20200604_15:10:41:870680_
2020-06-26 04:55:25 INFO: parent_dir: logs/svhn/nomod_cap
2020-06-26 04:55:25 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
2020-06-26 04:55:25 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 04:55:25 INFO: Using dataset: svhn
2020-06-26 04:55:25 INFO: BUILD TEST GRAPH
2020-06-26 04:55:26 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:55:26 INFO: name: 20200604_15:10:41:870680_
ored data version.
2020-06-26 04:55:26 INFO: parent_dir: logs/svhn/nomod_cap
2020-06-26 04:55:26 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:55:26 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
2020-06-26 04:55:26 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:55:26 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 04:55:27 INFO: Using dataset: svhn
2020-06-26 04:55:27 INFO: BUILD TEST GRAPH
2020-06-26 04:55:27 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:55:27 INFO: Overwrite dataset info from restored data version.
2020-06-26 04:55:28 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:55:28 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:55:28 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:55:28 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 04:55:28 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:55:29 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:55:29 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:55:29 INFO: input shape: (12, 32, 32, 3)
2020-06-26 04:55:29 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:55:29 INFO: relu_conv1 output shape: (12, 16, 16, 128)
2020-06-26 04:55:29 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 04:55:29 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 04:55:29 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:55:29 INFO: primary_caps activation shape (12, 16, 16, 32, 1)
2020-06-26 04:55:30 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:55:30 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:55:30 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:55:30 INFO: lyr.conv_caps1 votes shape: (588, 288, 24, 16)
2020-06-26 04:55:30 INFO: input shape: (12, 32, 32, 3)
2020-06-26 04:55:30 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 04:55:30 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 04:55:30 INFO: relu_conv1 output shape: (12, 16, 16, 128)
2020-06-26 04:55:30 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:55:30 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 04:55:30 INFO: lyr.conv_caps1 pose_out shape: (12, 7, 7, 24, 16)
2020-06-26 04:55:30 INFO: primary_caps activation shape (12, 16, 16, 32, 1)
2020-06-26 04:55:31 INFO: lyr.conv_caps1 activation_out shape: (12, 7, 7, 24, 1)
2020-06-26 04:55:31 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:55:31 INFO: lyr.conv_caps2 votes shape: (300, 216, 32, 16)
2020-06-26 04:55:31 INFO: lyr.conv_caps1 votes shape: (588, 288, 24, 16)
2020-06-26 04:55:31 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 04:55:31 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 04:55:31 INFO: lyr.conv_caps2 pose_out shape: (12, 5, 5, 32, 16)
2020-06-26 04:55:31 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:55:31 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 04:55:31 INFO: lyr.conv_caps1 pose_out shape: (12, 7, 7, 24, 16)
2020-06-26 04:55:31 INFO: lyr.conv_caps1 activation_out shape: (12, 7, 7, 24, 1)
2020-06-26 04:55:31 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 04:55:32 INFO: lyr.conv_caps2 votes shape: (300, 216, 32, 16)
2020-06-26 04:55:32 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 04:55:32 INFO: lyr.conv_caps2 pose_out shape: (12, 5, 5, 32, 16)
2020-06-26 04:55:32 INFO: class_caps activation shape: (12, 10)
2020-06-26 04:55:33 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 04:55:33 INFO: class_caps pose shape: (12, 10, 16)
2020-06-26 04:55:33 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 04:55:33 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 04:55:34 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:55:34 INFO: class_caps activation shape: (12, 10)
2020-06-26 04:55:34 INFO: class_caps pose shape: (12, 10, 16)
2020-06-26 04:55:34 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:55:36 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:55:36 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:55:36 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-26 04:55:37 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:55:37 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
	 [[save/RestoreV2/_15]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_15]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_15]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 04:55:37 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:55:37 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-26 04:55:37 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 04:55:56 INFO: name: 20200604_15:10:41:870680_
2020-06-26 04:55:56 INFO: parent_dir: logs/svhn/nomod_cap
2020-06-26 04:55:56 INFO: name: 20200604_15:10:41:870680_
2020-06-26 04:55:56 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
2020-06-26 04:55:57 INFO: parent_dir: logs/svhn/nomod_cap
2020-06-26 04:55:57 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 04:55:57 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
2020-06-26 04:55:57 INFO: Using dataset: svhn
2020-06-26 04:55:57 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 04:55:57 INFO: BUILD TEST GRAPH
2020-06-26 04:55:57 INFO: Using dataset: svhn
2020-06-26 04:55:58 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:55:58 INFO: BUILD TEST GRAPH
2020-06-26 04:55:58 INFO: Overwrite dataset info from restored data version.
2020-06-26 04:55:58 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:55:58 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:55:58 INFO: Overwrite dataset info from restored data version.
2020-06-26 04:55:58 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:55:58 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:55:58 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:55:59 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:56:00 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:56:00 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 04:56:00 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 04:56:00 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:56:00 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:56:00 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:56:00 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:56:00 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:56:00 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:56:00 INFO: input shape: (12, 32, 32, 3)
2020-06-26 04:56:00 INFO: input shape: (12, 32, 32, 3)
2020-06-26 04:56:01 INFO: relu_conv1 output shape: (12, 16, 16, 128)
2020-06-26 04:56:01 INFO: relu_conv1 output shape: (12, 16, 16, 128)
2020-06-26 04:56:01 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 04:56:01 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 04:56:01 INFO: primary_caps activation shape (12, 16, 16, 32, 1)
2020-06-26 04:56:01 INFO: primary_caps activation shape (12, 16, 16, 32, 1)
2020-06-26 04:56:01 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:56:01 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:56:01 INFO: lyr.conv_caps1 votes shape: (588, 288, 24, 16)
2020-06-26 04:56:01 INFO: lyr.conv_caps1 votes shape: (588, 288, 24, 16)
2020-06-26 04:56:01 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 04:56:01 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
which has the same broadcast rule as np.where
2020-06-26 04:56:01 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:56:01 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 04:56:01 INFO: lyr.conv_caps1 pose_out shape: (12, 7, 7, 24, 16)
2020-06-26 04:56:02 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:56:02 INFO: lyr.conv_caps1 activation_out shape: (12, 7, 7, 24, 1)
2020-06-26 04:56:02 INFO: lyr.conv_caps1 pose_out shape: (12, 7, 7, 24, 16)
2020-06-26 04:56:02 INFO: lyr.conv_caps2 votes shape: (300, 216, 32, 16)
2020-06-26 04:56:02 INFO: lyr.conv_caps1 activation_out shape: (12, 7, 7, 24, 1)
2020-06-26 04:56:02 INFO: lyr.conv_caps2 votes shape: (300, 216, 32, 16)
2020-06-26 04:56:02 INFO: lyr.conv_caps2 pose_out shape: (12, 5, 5, 32, 16)
2020-06-26 04:56:02 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 04:56:02 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 04:56:02 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 04:56:02 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 04:56:02 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 04:56:03 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 04:56:03 INFO: class_caps activation shape: (12, 10)
2020-06-26 04:56:04 INFO: class_caps activation shape: (12, 10)
2020-06-26 04:56:04 INFO: class_caps pose shape: (12, 10, 16)
2020-06-26 04:56:04 INFO: class_caps pose shape: (12, 10, 16)
2020-06-26 04:56:04 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:56:04 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:56:07 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:56:07 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:56:07 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:56:07 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-26 04:56:08 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:56:08 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-26 04:56:08 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
	 [[save/RestoreV2/_19]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_19]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_19]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 04:56:08 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 04:56:26 INFO: name: 20200604_15:10:41:870680_
2020-06-26 04:56:26 INFO: parent_dir: logs/svhn/nomod_cap
2020-06-26 04:56:26 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
2020-06-26 04:56:27 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 04:56:27 INFO: Using dataset: svhn
2020-06-26 04:56:27 INFO: BUILD TEST GRAPH
2020-06-26 04:56:27 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:56:27 INFO: Overwrite dataset info from restored data version.
2020-06-26 04:56:27 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:56:27 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:56:28 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:56:28 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 04:56:29 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:56:29 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:56:29 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:56:29 INFO: input shape: (12, 32, 32, 3)
2020-06-26 04:56:30 INFO: relu_conv1 output shape: (12, 16, 16, 128)
2020-06-26 04:56:30 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 04:56:30 INFO: primary_caps activation shape (12, 16, 16, 32, 1)
2020-06-26 04:56:30 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:56:30 INFO: lyr.conv_caps1 votes shape: (588, 288, 24, 16)
2020-06-26 04:56:30 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 04:56:31 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 04:56:31 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:56:31 INFO: lyr.conv_caps1 pose_out shape: (12, 7, 7, 24, 16)
2020-06-26 04:56:31 INFO: lyr.conv_caps1 activation_out shape: (12, 7, 7, 24, 1)
2020-06-26 04:56:31 INFO: lyr.conv_caps2 votes shape: (300, 216, 32, 16)
2020-06-26 04:56:31 INFO: lyr.conv_caps2 pose_out shape: (12, 5, 5, 32, 16)
2020-06-26 04:56:31 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 04:56:31 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 04:56:32 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 04:56:32 INFO: class_caps activation shape: (12, 10)
2020-06-26 04:56:32 INFO: class_caps pose shape: (12, 10, 16)
2020-06-26 04:56:33 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:56:35 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:56:35 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:56:35 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-26 04:56:36 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 04:57:08 INFO: name: 20200604_15:10:41:870680_
2020-06-26 04:57:08 INFO: parent_dir: logs/svhn/nomod_cap
2020-06-26 04:57:08 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
2020-06-26 04:57:08 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 04:57:08 INFO: Using dataset: svhn
2020-06-26 04:57:08 INFO: BUILD TEST GRAPH
2020-06-26 04:57:09 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:57:09 INFO: Overwrite dataset info from restored data version.
2020-06-26 04:57:09 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:57:09 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:57:10 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:57:10 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 04:57:10 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:57:10 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:57:10 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:57:10 INFO: input shape: (12, 32, 32, 3)
2020-06-26 04:57:10 INFO: relu_conv1 output shape: (12, 16, 16, 128)
2020-06-26 04:57:10 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 04:57:10 INFO: primary_caps activation shape (12, 16, 16, 32, 1)
2020-06-26 04:57:10 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:57:10 INFO: lyr.conv_caps1 votes shape: (588, 288, 24, 16)
2020-06-26 04:57:10 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 04:57:10 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 04:57:10 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:57:10 INFO: lyr.conv_caps1 pose_out shape: (12, 7, 7, 24, 16)
2020-06-26 04:57:10 INFO: lyr.conv_caps1 activation_out shape: (12, 7, 7, 24, 1)
2020-06-26 04:57:10 INFO: lyr.conv_caps2 votes shape: (300, 216, 32, 16)
2020-06-26 04:57:11 INFO: lyr.conv_caps2 pose_out shape: (12, 5, 5, 32, 16)
2020-06-26 04:57:11 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 04:57:11 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 04:57:11 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 04:57:11 INFO: class_caps activation shape: (12, 10)
2020-06-26 04:57:11 INFO: class_caps pose shape: (12, 10, 16)
2020-06-26 04:57:11 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:57:11 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:57:11 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:57:11 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-26 04:57:12 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 21:04:47 INFO: name: 20200604_15:10:41:870680_
2020-06-26 21:04:47 INFO: parent_dir: logs/svhn/nomod_cap
2020-06-26 21:04:47 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
2020-06-26 21:04:47 INFO: patch_path: logs/svhn/nomod_adv_00/20200615_08:46:50:486140_/train/saved_patch.png
2020-06-26 21:04:47 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 21:04:47 INFO: Using dataset: svhn
2020-06-26 21:04:47 INFO: BUILD TEST GRAPH
2020-06-26 21:04:47 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 21:04:47 INFO: Overwrite dataset info from restored data version.
2020-06-26 21:04:47 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 21:04:47 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 21:04:47 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 21:04:47 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 21:04:47 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 21:04:47 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 21:04:47 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 21:04:47 INFO: input shape: (12, 32, 32, 3)
2020-06-26 21:04:48 INFO: relu_conv1 output shape: (12, 16, 16, 128)
2020-06-26 21:04:48 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 21:04:48 INFO: primary_caps activation shape (12, 16, 16, 32, 1)
2020-06-26 21:04:48 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 21:04:48 INFO: lyr.conv_caps1 votes shape: (588, 288, 24, 16)
2020-06-26 21:04:48 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 21:04:48 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 21:04:48 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 21:04:48 INFO: lyr.conv_caps1 pose_out shape: (12, 7, 7, 24, 16)
2020-06-26 21:04:48 INFO: lyr.conv_caps1 activation_out shape: (12, 7, 7, 24, 1)
2020-06-26 21:04:48 INFO: lyr.conv_caps2 votes shape: (300, 216, 32, 16)
2020-06-26 21:04:48 INFO: lyr.conv_caps2 pose_out shape: (12, 5, 5, 32, 16)
2020-06-26 21:04:48 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 21:04:48 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 21:04:48 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 21:04:48 INFO: class_caps activation shape: (12, 10)
2020-06-26 21:04:48 INFO: class_caps pose shape: (12, 10, 16)
2020-06-26 21:04:48 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 21:04:49 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 21:04:49 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 21:04:49 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-26 21:11:04 INFO: name: 20200604_15:10:41:870680_
2020-06-26 21:11:04 INFO: parent_dir: logs/svhn/nomod_cap
2020-06-26 21:11:04 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
2020-06-26 21:11:04 INFO: patch_path: logs/svhn/nomod_adv_05/20200615_08:49:37:898728_/train/saved_patch.png
2020-06-26 21:11:04 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 21:11:04 INFO: Using dataset: svhn
2020-06-26 21:11:04 INFO: BUILD TEST GRAPH
2020-06-26 21:11:04 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 21:11:04 INFO: Overwrite dataset info from restored data version.
2020-06-26 21:11:04 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 21:11:04 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 21:11:05 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 21:11:05 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 21:11:05 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 21:11:05 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 21:11:05 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 21:11:05 INFO: input shape: (12, 32, 32, 3)
2020-06-26 21:11:06 INFO: relu_conv1 output shape: (12, 16, 16, 128)
2020-06-26 21:11:06 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 21:11:06 INFO: primary_caps activation shape (12, 16, 16, 32, 1)
2020-06-26 21:11:06 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 21:11:06 INFO: lyr.conv_caps1 votes shape: (588, 288, 24, 16)
2020-06-26 21:11:06 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 21:11:06 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 21:11:06 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 21:11:06 INFO: lyr.conv_caps1 pose_out shape: (12, 7, 7, 24, 16)
2020-06-26 21:11:06 INFO: lyr.conv_caps1 activation_out shape: (12, 7, 7, 24, 1)
2020-06-26 21:11:06 INFO: lyr.conv_caps2 votes shape: (300, 216, 32, 16)
2020-06-26 21:11:06 INFO: lyr.conv_caps2 pose_out shape: (12, 5, 5, 32, 16)
2020-06-26 21:11:06 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 21:11:06 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 21:11:06 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 21:11:06 INFO: class_caps activation shape: (12, 10)
2020-06-26 21:11:06 INFO: class_caps pose shape: (12, 10, 16)
2020-06-26 21:11:07 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 21:11:07 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 21:11:07 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 21:11:07 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-26 21:14:30 INFO: name: 20200604_15:10:41:870680_
2020-06-26 21:14:30 INFO: parent_dir: logs/svhn/nomod_cap
2020-06-26 21:14:30 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
2020-06-26 21:14:30 INFO: patch_path: logs/svhn/nomod_adv_10/20200615_08:50:06:943139_/train/saved_patch.png
2020-06-26 21:14:30 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 21:14:30 INFO: Using dataset: svhn
2020-06-26 21:14:30 INFO: BUILD TEST GRAPH
2020-06-26 21:14:30 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 21:14:30 INFO: Overwrite dataset info from restored data version.
2020-06-26 21:14:30 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 21:14:30 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 21:14:31 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 21:14:31 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 21:14:31 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 21:14:31 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 21:14:31 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 21:14:31 INFO: input shape: (12, 32, 32, 3)
2020-06-26 21:14:31 INFO: relu_conv1 output shape: (12, 16, 16, 128)
2020-06-26 21:14:31 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 21:14:31 INFO: primary_caps activation shape (12, 16, 16, 32, 1)
2020-06-26 21:14:31 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 21:14:32 INFO: lyr.conv_caps1 votes shape: (588, 288, 24, 16)
2020-06-26 21:14:32 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 21:14:32 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 21:14:32 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 21:14:32 INFO: lyr.conv_caps1 pose_out shape: (12, 7, 7, 24, 16)
2020-06-26 21:14:32 INFO: lyr.conv_caps1 activation_out shape: (12, 7, 7, 24, 1)
2020-06-26 21:14:32 INFO: lyr.conv_caps2 votes shape: (300, 216, 32, 16)
2020-06-26 21:14:32 INFO: lyr.conv_caps2 pose_out shape: (12, 5, 5, 32, 16)
2020-06-26 21:14:32 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 21:14:32 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 21:14:32 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 21:14:32 INFO: class_caps activation shape: (12, 10)
2020-06-26 21:14:32 INFO: class_caps pose shape: (12, 10, 16)
2020-06-26 21:14:33 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 21:14:33 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 21:14:33 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 21:14:33 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-26 21:20:38 INFO: name: 20200604_15:10:41:870680_
2020-06-26 21:20:38 INFO: parent_dir: logs/svhn/nomod_cap
2020-06-26 21:20:38 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
2020-06-26 21:20:38 INFO: patch_path: logs/svhn/nomod_adv_15/20200615_08:56:04:885180_/train/saved_patch.png
2020-06-26 21:20:38 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 21:20:38 INFO: Using dataset: svhn
2020-06-26 21:20:38 INFO: BUILD TEST GRAPH
2020-06-26 21:20:39 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 21:20:39 INFO: Overwrite dataset info from restored data version.
2020-06-26 21:20:39 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 21:20:39 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 21:20:39 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 21:20:39 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 21:20:39 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 21:20:39 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 21:20:39 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 21:20:39 INFO: input shape: (12, 32, 32, 3)
2020-06-26 21:20:39 INFO: relu_conv1 output shape: (12, 16, 16, 128)
2020-06-26 21:20:39 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 21:20:39 INFO: primary_caps activation shape (12, 16, 16, 32, 1)
2020-06-26 21:20:39 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 21:20:39 INFO: lyr.conv_caps1 votes shape: (588, 288, 24, 16)
2020-06-26 21:20:39 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 21:20:39 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 21:20:39 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 21:20:39 INFO: lyr.conv_caps1 pose_out shape: (12, 7, 7, 24, 16)
2020-06-26 21:20:39 INFO: lyr.conv_caps1 activation_out shape: (12, 7, 7, 24, 1)
2020-06-26 21:20:40 INFO: lyr.conv_caps2 votes shape: (300, 216, 32, 16)
2020-06-26 21:20:40 INFO: lyr.conv_caps2 pose_out shape: (12, 5, 5, 32, 16)
2020-06-26 21:20:40 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 21:20:40 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 21:20:40 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 21:20:40 INFO: class_caps activation shape: (12, 10)
2020-06-26 21:20:40 INFO: class_caps pose shape: (12, 10, 16)
2020-06-26 21:20:40 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 21:20:41 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 21:20:41 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 21:20:41 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-26 21:21:39 INFO: name: 20200604_15:10:41:870680_
2020-06-26 21:21:39 INFO: parent_dir: logs/svhn/nomod_cap
2020-06-26 21:21:39 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
2020-06-26 21:21:39 INFO: patch_path: logs/svhn/nomod_adv_20/20200615_08:56:29:696680_/train/saved_patch.png
2020-06-26 21:21:39 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 21:21:39 INFO: Using dataset: svhn
2020-06-26 21:21:39 INFO: BUILD TEST GRAPH
2020-06-26 21:21:39 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 21:21:40 INFO: Overwrite dataset info from restored data version.
2020-06-26 21:21:40 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 21:21:40 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 21:21:40 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 21:21:40 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 21:21:40 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 21:21:40 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 21:21:40 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 21:21:41 INFO: input shape: (12, 32, 32, 3)
2020-06-26 21:21:41 INFO: relu_conv1 output shape: (12, 16, 16, 128)
2020-06-26 21:21:41 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 21:21:41 INFO: primary_caps activation shape (12, 16, 16, 32, 1)
2020-06-26 21:21:41 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 21:21:41 INFO: lyr.conv_caps1 votes shape: (588, 288, 24, 16)
2020-06-26 21:21:41 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 21:21:41 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 21:21:41 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 21:21:41 INFO: lyr.conv_caps1 pose_out shape: (12, 7, 7, 24, 16)
2020-06-26 21:21:41 INFO: lyr.conv_caps1 activation_out shape: (12, 7, 7, 24, 1)
2020-06-26 21:21:41 INFO: lyr.conv_caps2 votes shape: (300, 216, 32, 16)
2020-06-26 21:21:41 INFO: lyr.conv_caps2 pose_out shape: (12, 5, 5, 32, 16)
2020-06-26 21:21:41 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 21:21:41 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 21:21:41 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 21:21:42 INFO: class_caps activation shape: (12, 10)
2020-06-26 21:21:42 INFO: class_caps pose shape: (12, 10, 16)
2020-06-26 21:21:42 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 21:21:42 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 21:21:43 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 21:21:43 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-26 21:21:59 INFO: name: 20200604_15:10:41:870680_
2020-06-26 21:21:59 INFO: parent_dir: logs/svhn/nomod_cap
2020-06-26 21:21:59 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
2020-06-26 21:21:59 INFO: patch_path: logs/svhn/nomod_adv_25/20200615_08:57:32:986118_/train/saved_patch.png
2020-06-26 21:21:59 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 21:21:59 INFO: Using dataset: svhn
2020-06-26 21:21:59 INFO: BUILD TEST GRAPH
2020-06-26 21:21:59 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 21:21:59 INFO: Overwrite dataset info from restored data version.
2020-06-26 21:21:59 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 21:21:59 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 21:22:00 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 21:22:00 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 21:22:00 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 21:22:00 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 21:22:00 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 21:22:00 INFO: input shape: (12, 32, 32, 3)
2020-06-26 21:22:00 INFO: relu_conv1 output shape: (12, 16, 16, 128)
2020-06-26 21:22:00 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 21:22:00 INFO: primary_caps activation shape (12, 16, 16, 32, 1)
2020-06-26 21:22:00 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 21:22:00 INFO: lyr.conv_caps1 votes shape: (588, 288, 24, 16)
2020-06-26 21:22:00 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 21:22:00 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 21:22:00 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 21:22:00 INFO: lyr.conv_caps1 pose_out shape: (12, 7, 7, 24, 16)
2020-06-26 21:22:00 INFO: lyr.conv_caps1 activation_out shape: (12, 7, 7, 24, 1)
2020-06-26 21:22:00 INFO: lyr.conv_caps2 votes shape: (300, 216, 32, 16)
2020-06-26 21:22:01 INFO: lyr.conv_caps2 pose_out shape: (12, 5, 5, 32, 16)
2020-06-26 21:22:01 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 21:22:01 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 21:22:01 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 21:22:01 INFO: class_caps activation shape: (12, 10)
2020-06-26 21:22:01 INFO: class_caps pose shape: (12, 10, 16)
2020-06-26 21:22:01 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 21:22:02 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 21:22:02 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 21:22:02 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-26 21:22:31 INFO: name: 20200604_15:10:41:870680_
2020-06-26 21:22:31 INFO: parent_dir: logs/svhn/nomod_cap
2020-06-26 21:22:31 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
2020-06-26 21:22:31 INFO: patch_path: logs/svhn/nomod_adv_30/20200615_09:05:17:403206_/train/saved_patch.png
2020-06-26 21:22:31 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 21:22:31 INFO: Using dataset: svhn
2020-06-26 21:22:31 INFO: BUILD TEST GRAPH
2020-06-26 21:22:31 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 21:22:31 INFO: Overwrite dataset info from restored data version.
2020-06-26 21:22:32 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 21:22:32 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 21:22:32 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 21:22:32 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 21:22:32 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 21:22:32 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 21:22:32 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 21:22:32 INFO: input shape: (12, 32, 32, 3)
2020-06-26 21:22:32 INFO: relu_conv1 output shape: (12, 16, 16, 128)
2020-06-26 21:22:32 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 21:22:32 INFO: primary_caps activation shape (12, 16, 16, 32, 1)
2020-06-26 21:22:32 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 21:22:32 INFO: lyr.conv_caps1 votes shape: (588, 288, 24, 16)
2020-06-26 21:22:32 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 21:22:32 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 21:22:32 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 21:22:33 INFO: lyr.conv_caps1 pose_out shape: (12, 7, 7, 24, 16)
2020-06-26 21:22:33 INFO: lyr.conv_caps1 activation_out shape: (12, 7, 7, 24, 1)
2020-06-26 21:22:33 INFO: lyr.conv_caps2 votes shape: (300, 216, 32, 16)
2020-06-26 21:22:33 INFO: lyr.conv_caps2 pose_out shape: (12, 5, 5, 32, 16)
2020-06-26 21:22:33 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 21:22:33 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 21:22:33 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 21:22:33 INFO: class_caps activation shape: (12, 10)
2020-06-26 21:22:33 INFO: class_caps pose shape: (12, 10, 16)
2020-06-26 21:22:33 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 21:22:34 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 21:22:34 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 21:22:34 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-26 21:28:35 INFO: name: 20200604_15:10:41:870680_
2020-06-26 21:28:35 INFO: parent_dir: logs/svhn/nomod_cap
2020-06-26 21:28:35 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
2020-06-26 21:28:35 INFO: patch_path: logs/svhn/nomod_adv_ten/20200615_09:28:30:015126_/train/saved_patch.png
2020-06-26 21:28:35 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 21:28:35 INFO: Using dataset: svhn
2020-06-26 21:28:35 INFO: BUILD TEST GRAPH
2020-06-26 21:28:35 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 21:28:36 INFO: Overwrite dataset info from restored data version.
2020-06-26 21:28:36 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 21:28:36 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 21:28:36 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 21:28:36 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 21:28:36 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 21:28:36 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 21:28:36 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 21:28:36 INFO: input shape: (12, 32, 32, 3)
2020-06-26 21:28:36 INFO: relu_conv1 output shape: (12, 16, 16, 128)
2020-06-26 21:28:36 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 21:28:36 INFO: primary_caps activation shape (12, 16, 16, 32, 1)
2020-06-26 21:28:36 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 21:28:36 INFO: lyr.conv_caps1 votes shape: (588, 288, 24, 16)
2020-06-26 21:28:37 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 21:28:37 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 21:28:37 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 21:28:37 INFO: lyr.conv_caps1 pose_out shape: (12, 7, 7, 24, 16)
2020-06-26 21:28:37 INFO: lyr.conv_caps1 activation_out shape: (12, 7, 7, 24, 1)
2020-06-26 21:28:37 INFO: lyr.conv_caps2 votes shape: (300, 216, 32, 16)
2020-06-26 21:28:37 INFO: lyr.conv_caps2 pose_out shape: (12, 5, 5, 32, 16)
2020-06-26 21:28:37 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 21:28:37 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 21:28:37 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 21:28:37 INFO: class_caps activation shape: (12, 10)
2020-06-26 21:28:37 INFO: class_caps pose shape: (12, 10, 16)
2020-06-26 21:28:38 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 21:28:38 INFO: name: 20200604_15:10:41:870680_
2020-06-26 21:28:38 INFO: parent_dir: logs/svhn/nomod_cap
2020-06-26 21:28:38 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
2020-06-26 21:28:38 INFO: name: 20200604_15:10:41:870680_
hun/20200615_09:33:35:260713_/train/saved_patch.png
2020-06-26 21:28:38 INFO: name: 20200604_15:10:41:870680_
2020-06-26 21:28:38 INFO: name: 20200604_15:10:41:870680_
2020-06-26 21:28:38 INFO: parent_dir: logs/svhn/nomod_cap
2020-06-26 21:28:38 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 21:28:38 INFO: parent_dir: logs/svhn/nomod_cap
2020-06-26 21:28:38 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
2020-06-26 21:28:38 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
2020-06-26 21:28:38 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
2020-06-26 21:28:38 INFO: BUILD TEST GRAPH
2020-06-26 21:28:38 INFO: patch_path: logs/svhn/nomod_adv_tnk/20200615_09:34:34:395790_/train/saved_patch.png
2020-06-26 21:28:38 INFO: patch_path: logs/svhn/nomod_adv_35/20200615_09:05:17:856924_/train/saved_patch.png

ated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 21:28:38 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 21:28:38 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 21:28:38 INFO: Using dataset: svhn
fo from restored data version.
2020-06-26 21:28:38 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 21:28:38 INFO: BUILD TEST GRAPH
2020-06-26 21:28:38 INFO: Using dataset: svhn
2020-06-26 21:28:38 INFO: BUILD TEST GRAPH
2020-06-26 21:28:38 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 21:28:38 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 21:28:38 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 21:28:38 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 21:28:38 INFO: Overwrite dataset info from restored data version.
2020-06-26 21:28:38 INFO: Overwrite dataset info from restored data version.
2020-06-26 21:28:38 INFO: Overwrite dataset info from restored data version.
low_datasets/svhn_cropped/1.0.0)
2020-06-26 21:28:38 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 21:28:38 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 21:28:38 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
svhn_cropped/1.0.0
2020-06-26 21:28:38 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 21:28:38 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 21:28:38 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 21:28:38 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-26 21:28:38 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 21:28:38 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 21:28:38 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 21:28:38 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 21:28:38 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 21:28:38 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 21:28:38 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 21:28:38 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

stead.

2020-06-26 21:28:38 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 21:28:38 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 21:28:39 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 21:28:39 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 21:28:39 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 21:28:39 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 21:28:39 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 21:28:39 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 21:28:39 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 21:28:39 INFO: input shape: (12, 32, 32, 3)
2020-06-26 21:28:39 INFO: input shape: (12, 32, 32, 3)
2020-06-26 21:28:39 INFO: input shape: (12, 32, 32, 3)
2020-06-26 21:28:39 INFO: relu_conv1 output shape: (12, 16, 16, 128)
2020-06-26 21:28:39 INFO: relu_conv1 output shape: (12, 16, 16, 128)
2020-06-26 21:28:39 INFO: relu_conv1 output shape: (12, 16, 16, 128)
2020-06-26 21:28:39 INFO: relu_conv1 output shape: (12, 16, 16, 128)
2020-06-26 21:28:39 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 21:28:39 INFO: primary_caps activation shape (12, 16, 16, 32, 1)
2020-06-26 21:28:39 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 21:28:39 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 21:28:39 INFO: primary_caps activation shape (12, 16, 16, 32, 1)
2020-06-26 21:28:39 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 21:28:39 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 21:28:39 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 21:28:39 INFO: primary_caps activation shape (12, 16, 16, 32, 1)
2020-06-26 21:28:39 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 21:28:39 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 21:28:39 INFO: lyr.conv_caps1 votes shape: (588, 288, 24, 16)
2020-06-26 21:28:39 INFO: lyr.conv_caps1 votes shape: (588, 288, 24, 16)
2020-06-26 21:28:39 INFO: lyr.conv_caps1 votes shape: (588, 288, 24, 16)
-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 21:28:39 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 21:28:39 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 21:28:39 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 21:28:39 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 21:28:39 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 21:28:39 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 21:28:39 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 21:28:39 INFO: lyr.conv_caps1 pose_out shape: (12, 7, 7, 24, 16)
2020-06-26 21:28:39 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 21:28:39 INFO: lyr.conv_caps1 activation_out shape: (12, 7, 7, 24, 1)
2020-06-26 21:28:39 INFO: lyr.conv_caps1 pose_out shape: (12, 7, 7, 24, 16)
2020-06-26 21:28:39 INFO: lyr.conv_caps1 pose_out shape: (12, 7, 7, 24, 16)
2020-06-26 21:28:39 INFO: lyr.conv_caps1 activation_out shape: (12, 7, 7, 24, 1)
2020-06-26 21:28:39 INFO: lyr.conv_caps1 activation_out shape: (12, 7, 7, 24, 1)
2020-06-26 21:28:39 INFO: lyr.conv_caps2 votes shape: (300, 216, 32, 16)
6)
2020-06-26 21:28:39 INFO: lyr.conv_caps2 votes shape: (300, 216, 32, 16)
2020-06-26 21:28:39 INFO: lyr.conv_caps1 activation_out shape: (12, 7, 7, 24, 1)
2020-06-26 21:28:39 INFO: lyr.conv_caps2 votes shape: (300, 216, 32, 16)
2020-06-26 21:28:39 INFO: lyr.conv_caps2 pose_out shape: (12, 5, 5, 32, 16)
2020-06-26 21:28:39 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 21:28:39 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 21:28:39 INFO: lyr.conv_caps2 pose_out shape: (12, 5, 5, 32, 16)
2020-06-26 21:28:39 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 21:28:39 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 21:28:39 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 21:28:40 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 21:28:40 INFO: lyr.conv_caps2 pose_out shape: (12, 5, 5, 32, 16)
2020-06-26 21:28:40 INFO: lyr.conv_caps2 pose_out shape: (12, 5, 5, 32, 16)
2020-06-26 21:28:40 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 21:28:40 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 21:28:40 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 21:28:40 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 21:28:40 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 21:28:40 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 21:28:40 INFO: class_caps activation shape: (12, 10)
2020-06-26 21:28:40 INFO: class_caps pose shape: (12, 10, 16)
2020-06-26 21:28:40 INFO: class_caps activation shape: (12, 10)
2020-06-26 21:28:40 INFO: class_caps activation shape: (12, 10)
2020-06-26 21:28:40 INFO: class_caps pose shape: (12, 10, 16)
2020-06-26 21:28:40 INFO: class_caps pose shape: (12, 10, 16)
2020-06-26 21:28:40 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 21:28:40 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 21:28:40 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 21:28:40 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 21:28:40 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 21:28:40 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 21:28:40 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 21:28:40 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-26 21:28:41 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 21:28:41 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-26 21:28:41 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 21:28:41 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 21:28:41 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 21:28:41 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-26 21:28:41 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 21:28:41 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-26 21:28:42 INFO: name: 20200604_15:10:41:870680_
2020-06-26 21:28:42 INFO: parent_dir: logs/svhn/nomod_cap
2020-06-26 21:28:42 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
2020-06-26 21:28:42 INFO: patch_path: logs/svhn/nomod_adv_40/20200615_09:05:17:857144_/train/saved_patch.png
2020-06-26 21:28:42 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 21:28:42 INFO: Using dataset: svhn
2020-06-26 21:28:42 INFO: BUILD TEST GRAPH
2020-06-26 21:28:42 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 21:28:42 INFO: Overwrite dataset info from restored data version.
2020-06-26 21:28:42 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 21:28:42 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 21:28:43 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 21:28:43 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 21:28:43 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 21:28:43 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 21:28:43 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 21:28:43 INFO: input shape: (12, 32, 32, 3)
2020-06-26 21:28:43 INFO: relu_conv1 output shape: (12, 16, 16, 128)
2020-06-26 21:28:43 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 21:28:43 INFO: primary_caps activation shape (12, 16, 16, 32, 1)
2020-06-26 21:28:43 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 21:28:43 INFO: lyr.conv_caps1 votes shape: (588, 288, 24, 16)
2020-06-26 21:28:43 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 21:28:43 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 21:28:43 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 21:28:43 INFO: lyr.conv_caps1 pose_out shape: (12, 7, 7, 24, 16)
2020-06-26 21:28:43 INFO: lyr.conv_caps1 activation_out shape: (12, 7, 7, 24, 1)
2020-06-26 21:28:44 INFO: lyr.conv_caps2 votes shape: (300, 216, 32, 16)
2020-06-26 21:28:44 INFO: lyr.conv_caps2 pose_out shape: (12, 5, 5, 32, 16)
2020-06-26 21:28:44 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 21:28:44 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 21:28:44 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 21:28:44 INFO: class_caps activation shape: (12, 10)
2020-06-26 21:28:44 INFO: class_caps pose shape: (12, 10, 16)
2020-06-26 21:28:44 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 21:28:45 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 21:28:45 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 21:28:45 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-26 21:28:48 INFO: name: 20200604_15:10:41:870680_
2020-06-26 21:28:48 INFO: name: 20200604_15:10:41:870680_
2020-06-26 21:28:48 INFO: parent_dir: logs/svhn/nomod_cap
2020-06-26 21:28:48 INFO: parent_dir: logs/svhn/nomod_cap
2020-06-26 21:28:48 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
2020-06-26 21:28:48 INFO: test_dir: logs/svhn/nomod_cap/20200604_15:10:41:870680_/test
2020-06-26 21:28:48 INFO: patch_path: logs/svhn/nomod_adv_45/20200615_09:23:30:000997_/train/saved_patch.png
2020-06-26 21:28:48 INFO: patch_path: logs/svhn/nomod_adv_50/20200615_09:23:30:000544_/train/saved_patch.png
2020-06-26 21:28:48 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 21:28:48 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/params/params.json
2020-06-26 21:28:48 INFO: Using dataset: svhn
2020-06-26 21:28:48 INFO: Using dataset: svhn
2020-06-26 21:28:48 INFO: BUILD TEST GRAPH
2020-06-26 21:28:48 INFO: BUILD TEST GRAPH
2020-06-26 21:28:48 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 21:28:48 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 21:28:48 INFO: Overwrite dataset info from restored data version.
2020-06-26 21:28:48 INFO: Overwrite dataset info from restored data version.
2020-06-26 21:28:48 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 21:28:48 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 21:28:48 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 21:28:48 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 21:28:49 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 21:28:49 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 21:28:49 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 21:28:49 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 21:28:49 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 21:28:49 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 21:28:49 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 21:28:49 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 21:28:49 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 21:28:49 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 21:28:49 INFO: input shape: (12, 32, 32, 3)
2020-06-26 21:28:49 INFO: input shape: (12, 32, 32, 3)
2020-06-26 21:28:49 INFO: relu_conv1 output shape: (12, 16, 16, 128)
2020-06-26 21:28:49 INFO: relu_conv1 output shape: (12, 16, 16, 128)
2020-06-26 21:28:49 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 21:28:49 INFO: primary_caps pose shape: (12, 16, 16, 32, 16)
2020-06-26 21:28:49 INFO: primary_caps activation shape (12, 16, 16, 32, 1)
2020-06-26 21:28:49 INFO: primary_caps activation shape (12, 16, 16, 32, 1)
2020-06-26 21:28:49 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 21:28:49 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 21:28:49 INFO: lyr.conv_caps1 votes shape: (588, 288, 24, 16)
2020-06-26 21:28:49 INFO: lyr.conv_caps1 votes shape: (588, 288, 24, 16)
2020-06-26 21:28:49 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 21:28:49 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 21:28:49 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 21:28:49 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 21:28:49 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 21:28:49 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 21:28:49 INFO: lyr.conv_caps1 pose_out shape: (12, 7, 7, 24, 16)
2020-06-26 21:28:49 INFO: lyr.conv_caps1 activation_out shape: (12, 7, 7, 24, 1)
2020-06-26 21:28:49 INFO: lyr.conv_caps1 pose_out shape: (12, 7, 7, 24, 16)
2020-06-26 21:28:49 INFO: lyr.conv_caps1 activation_out shape: (12, 7, 7, 24, 1)
2020-06-26 21:28:49 INFO: lyr.conv_caps2 votes shape: (300, 216, 32, 16)
2020-06-26 21:28:50 INFO: lyr.conv_caps2 votes shape: (300, 216, 32, 16)
2020-06-26 21:28:50 INFO: lyr.conv_caps2 pose_out shape: (12, 5, 5, 32, 16)
2020-06-26 21:28:50 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 21:28:50 INFO: lyr.conv_caps2 pose_out shape: (12, 5, 5, 32, 16)
2020-06-26 21:28:50 INFO: lyr.conv_caps2 activation_out shape: (12, 5, 5, 32, 1)
2020-06-26 21:28:50 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 21:28:50 INFO: class_caps votes original shape: (300, 32, 10, 16)
2020-06-26 21:28:50 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 21:28:50 INFO: class_caps votes in to routing shape: (12, 800, 10, 16)
2020-06-26 21:28:50 INFO: class_caps activation shape: (12, 10)
2020-06-26 21:28:50 INFO: class_caps pose shape: (12, 10, 16)
2020-06-26 21:28:50 INFO: class_caps activation shape: (12, 10)
2020-06-26 21:28:50 INFO: class_caps pose shape: (12, 10, 16)
2020-06-26 21:28:50 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 21:28:50 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 21:28:51 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 21:28:51 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 21:28:51 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 21:28:51 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 21:28:51 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-26 21:28:51 INFO: Restoring parameters from logs/svhn/nomod_cap/20200604_15:10:41:870680_/train/checkpoint/model.ckpt30-91560
2020-06-27 03:37:59 INFO: writing to csv
2020-06-27 03:38:01 INFO: csv saved at logs/svhn/nomod_cap/20200604_15:10:41:870680_/test/logs_svhn_nomod_adv_00_20200615_08_46_50_486140__train_saved_patch_png_test.csv
2020-06-27 03:51:03 INFO: writing to csv
2020-06-27 03:51:04 INFO: csv saved at logs/svhn/nomod_cap/20200604_15:10:41:870680_/test/logs_svhn_nomod_adv_05_20200615_08_49_37_898728__train_saved_patch_png_test.csv
2020-06-27 03:56:41 INFO: writing to csv
2020-06-27 03:56:43 INFO: csv saved at logs/svhn/nomod_cap/20200604_15:10:41:870680_/test/logs_svhn_nomod_adv_10_20200615_08_50_06_943139__train_saved_patch_png_test.csv
2020-06-27 04:00:52 INFO: writing to csv
2020-06-27 04:00:53 INFO: csv saved at logs/svhn/nomod_cap/20200604_15:10:41:870680_/test/logs_svhn_nomod_adv_25_20200615_08_57_32_986118__train_saved_patch_png_test.csv
2020-06-27 04:01:18 INFO: writing to csv
2020-06-27 04:01:19 INFO: csv saved at logs/svhn/nomod_cap/20200604_15:10:41:870680_/test/logs_svhn_nomod_adv_30_20200615_09_05_17_403206__train_saved_patch_png_test.csv
2020-06-27 04:01:28 INFO: writing to csv
2020-06-27 04:01:30 INFO: csv saved at logs/svhn/nomod_cap/20200604_15:10:41:870680_/test/logs_svhn_nomod_adv_15_20200615_08_56_04_885180__train_saved_patch_png_test.csv
2020-06-27 04:02:36 INFO: writing to csv
2020-06-27 04:02:37 INFO: csv saved at logs/svhn/nomod_cap/20200604_15:10:41:870680_/test/logs_svhn_nomod_adv_20_20200615_08_56_29_696680__train_saved_patch_png_test.csv
2020-06-27 04:02:38 INFO: writing to csv
2020-06-27 04:02:39 INFO: csv saved at logs/svhn/nomod_cap/20200604_15:10:41:870680_/test/logs_svhn_nomod_adv_tnk_20200615_09_34_34_395790__train_saved_patch_png_test.csv
2020-06-27 04:02:59 INFO: writing to csv
2020-06-27 04:03:00 INFO: csv saved at logs/svhn/nomod_cap/20200604_15:10:41:870680_/test/logs_svhn_nomod_adv_tho_20200615_09_34_34_354702__train_saved_patch_png_test.csv
2020-06-27 04:03:43 INFO: writing to csv
2020-06-27 04:03:45 INFO: csv saved at logs/svhn/nomod_cap/20200604_15:10:41:870680_/test/logs_svhn_nomod_adv_50_20200615_09_23_30_000544__train_saved_patch_png_test.csv
2020-06-27 04:04:06 INFO: writing to csv
2020-06-27 04:04:07 INFO: csv saved at logs/svhn/nomod_cap/20200604_15:10:41:870680_/test/logs_svhn_nomod_adv_45_20200615_09_23_30_000997__train_saved_patch_png_test.csv
2020-06-27 04:04:13 INFO: writing to csv
2020-06-27 04:04:14 INFO: csv saved at logs/svhn/nomod_cap/20200604_15:10:41:870680_/test/logs_svhn_nomod_adv_35_20200615_09_05_17_856924__train_saved_patch_png_test.csv
2020-06-27 04:04:58 INFO: writing to csv
2020-06-27 04:04:59 INFO: csv saved at logs/svhn/nomod_cap/20200604_15:10:41:870680_/test/logs_svhn_nomod_adv_ten_20200615_09_28_30_015126__train_saved_patch_png_test.csv
2020-06-27 04:10:03 INFO: writing to csv
2020-06-27 04:10:04 INFO: csv saved at logs/svhn/nomod_cap/20200604_15:10:41:870680_/test/logs_svhn_nomod_adv_hun_20200615_09_33_35_260713__train_saved_patch_png_test.csv
2020-06-27 04:10:52 INFO: writing to csv
2020-06-27 04:10:53 INFO: csv saved at logs/svhn/nomod_cap/20200604_15:10:41:870680_/test/logs_svhn_nomod_adv_40_20200615_09_05_17_857144__train_saved_patch_png_test.csv
