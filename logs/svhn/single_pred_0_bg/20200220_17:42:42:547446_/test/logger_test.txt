2020-06-26 04:47:09 INFO: name: 20200220_17:42:42:547446_
2020-06-26 04:47:09 INFO: parent_dir: logs/svhn/single_pred_0_bg
2020-06-26 04:47:09 INFO: test_dir: logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test
2020-06-26 04:47:09 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 04:47:09 INFO: Using dataset: svhn
2020-06-26 04:47:09 INFO: BUILD TEST GRAPH
2020-06-26 04:47:09 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:47:09 INFO: Overwrite dataset info from restored data version.
2020-06-26 04:47:09 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:47:09 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:47:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:47:09 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 04:47:09 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:47:09 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:47:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:47:09 INFO: input shape: (8, 32, 32, 3)
2020-06-26 04:47:10 INFO: relu_conv1 output shape: (8, 16, 16, 128)
2020-06-26 04:47:10 INFO: primary_caps pose shape: (8, 16, 16, 32, 16)
2020-06-26 04:47:10 INFO: primary_caps activation shape (8, 16, 16, 32, 1)
2020-06-26 04:47:10 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:47:10 INFO: lyr.conv_caps1 votes shape: (392, 288, 24, 16)
2020-06-26 04:47:10 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 04:47:10 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 04:47:10 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:47:10 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
2020-06-26 04:47:10 INFO: lyr.conv_caps1 activation_out shape: (8, 7, 7, 24, 1)
2020-06-26 04:47:10 INFO: lyr.conv_caps2 votes shape: (200, 216, 32, 16)
2020-06-26 04:47:10 INFO: lyr.conv_caps2 pose_out shape: (8, 5, 5, 32, 16)
2020-06-26 04:47:10 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 04:47:10 INFO: class_caps votes original shape: (200, 32, 10, 16)
2020-06-26 04:47:10 INFO: class_caps votes in to routing shape: (8, 800, 10, 16)
2020-06-26 04:47:10 INFO: class_caps activation shape: (8, 10)
2020-06-26 04:47:10 INFO: class_caps pose shape: (8, 10, 16)
2020-06-26 04:47:10 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:47:11 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:47:11 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:47:11 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-26 04:47:11 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
	 [[save/RestoreV2/_15]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_15]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_15]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 04:47:23 INFO: name: 20200220_17:42:42:547446_
2020-06-26 04:47:23 INFO: parent_dir: logs/svhn/single_pred_0_bg
2020-06-26 04:47:23 INFO: test_dir: logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test
2020-06-26 04:47:23 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 04:47:23 INFO: Using dataset: svhn
2020-06-26 04:47:23 INFO: BUILD TEST GRAPH
2020-06-26 04:47:23 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:47:23 INFO: Overwrite dataset info from restored data version.
2020-06-26 04:47:23 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:47:23 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:47:24 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:47:24 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 04:47:24 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:47:24 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:47:24 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:47:24 INFO: input shape: (8, 32, 32, 3)
2020-06-26 04:47:24 INFO: relu_conv1 output shape: (8, 16, 16, 128)
2020-06-26 04:47:24 INFO: primary_caps pose shape: (8, 16, 16, 32, 16)
2020-06-26 04:47:24 INFO: primary_caps activation shape (8, 16, 16, 32, 1)
2020-06-26 04:47:24 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:47:24 INFO: lyr.conv_caps1 votes shape: (392, 288, 24, 16)
2020-06-26 04:47:24 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 04:47:24 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 04:47:24 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:47:24 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
2020-06-26 04:47:24 INFO: lyr.conv_caps1 activation_out shape: (8, 7, 7, 24, 1)
2020-06-26 04:47:24 INFO: lyr.conv_caps2 votes shape: (200, 216, 32, 16)
2020-06-26 04:47:24 INFO: lyr.conv_caps2 pose_out shape: (8, 5, 5, 32, 16)
2020-06-26 04:47:24 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 04:47:24 INFO: class_caps votes original shape: (200, 32, 10, 16)
2020-06-26 04:47:24 INFO: class_caps votes in to routing shape: (8, 800, 10, 16)
2020-06-26 04:47:24 INFO: class_caps activation shape: (8, 10)
2020-06-26 04:47:24 INFO: class_caps pose shape: (8, 10, 16)
2020-06-26 04:47:25 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:47:25 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:47:25 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:47:25 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-26 04:47:25 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
	 [[save/RestoreV2/_19]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_19]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_19]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 04:47:53 INFO: name: 20200220_17:42:42:547446_
2020-06-26 04:47:53 INFO: parent_dir: logs/svhn/single_pred_0_bg
2020-06-26 04:47:53 INFO: test_dir: logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test
2020-06-26 04:47:53 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 04:47:53 INFO: Using dataset: svhn
2020-06-26 04:47:53 INFO: BUILD TEST GRAPH
2020-06-26 04:47:53 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:47:53 INFO: Overwrite dataset info from restored data version.
2020-06-26 04:47:53 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:47:53 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:47:53 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:47:53 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 04:47:53 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:47:53 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:47:53 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:47:53 INFO: input shape: (8, 32, 32, 3)
2020-06-26 04:47:54 INFO: relu_conv1 output shape: (8, 16, 16, 128)
2020-06-26 04:47:54 INFO: primary_caps pose shape: (8, 16, 16, 32, 16)
2020-06-26 04:47:54 INFO: primary_caps activation shape (8, 16, 16, 32, 1)
2020-06-26 04:47:54 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:47:54 INFO: lyr.conv_caps1 votes shape: (392, 288, 24, 16)
2020-06-26 04:47:54 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 04:47:54 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 04:47:54 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:47:54 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
2020-06-26 04:47:54 INFO: lyr.conv_caps1 activation_out shape: (8, 7, 7, 24, 1)
2020-06-26 04:47:54 INFO: lyr.conv_caps2 votes shape: (200, 216, 32, 16)
2020-06-26 04:47:54 INFO: lyr.conv_caps2 pose_out shape: (8, 5, 5, 32, 16)
2020-06-26 04:47:54 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 04:47:54 INFO: class_caps votes original shape: (200, 32, 10, 16)
2020-06-26 04:47:54 INFO: class_caps votes in to routing shape: (8, 800, 10, 16)
2020-06-26 04:47:54 INFO: class_caps activation shape: (8, 10)
2020-06-26 04:47:54 INFO: class_caps pose shape: (8, 10, 16)
2020-06-26 04:47:54 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:47:55 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:47:55 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:47:55 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-26 04:47:55 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
	 [[save/RestoreV2/_51]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_51]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_51]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 04:48:23 INFO: name: 20200220_17:42:42:547446_
2020-06-26 04:48:23 INFO: parent_dir: logs/svhn/single_pred_0_bg
2020-06-26 04:48:23 INFO: test_dir: logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test
2020-06-26 04:48:23 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 04:48:23 INFO: Using dataset: svhn
2020-06-26 04:48:23 INFO: BUILD TEST GRAPH
2020-06-26 04:48:23 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:48:23 INFO: Overwrite dataset info from restored data version.
2020-06-26 04:48:23 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:48:23 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:48:24 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:48:24 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 04:48:24 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:48:24 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:48:24 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:48:24 INFO: input shape: (8, 32, 32, 3)
2020-06-26 04:48:24 INFO: relu_conv1 output shape: (8, 16, 16, 128)
2020-06-26 04:48:24 INFO: primary_caps pose shape: (8, 16, 16, 32, 16)
2020-06-26 04:48:24 INFO: primary_caps activation shape (8, 16, 16, 32, 1)
2020-06-26 04:48:24 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:48:24 INFO: lyr.conv_caps1 votes shape: (392, 288, 24, 16)
2020-06-26 04:48:24 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 04:48:24 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 04:48:24 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:48:24 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
2020-06-26 04:48:24 INFO: lyr.conv_caps1 activation_out shape: (8, 7, 7, 24, 1)
2020-06-26 04:48:24 INFO: lyr.conv_caps2 votes shape: (200, 216, 32, 16)
2020-06-26 04:48:24 INFO: lyr.conv_caps2 pose_out shape: (8, 5, 5, 32, 16)
2020-06-26 04:48:24 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 04:48:24 INFO: class_caps votes original shape: (200, 32, 10, 16)
2020-06-26 04:48:24 INFO: class_caps votes in to routing shape: (8, 800, 10, 16)
2020-06-26 04:48:24 INFO: class_caps activation shape: (8, 10)
2020-06-26 04:48:24 INFO: class_caps pose shape: (8, 10, 16)
2020-06-26 04:48:25 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:48:25 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:48:25 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:48:25 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-26 04:48:25 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
	 [[save/RestoreV2/_51]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_51]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_51]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 04:48:55 INFO: name: 20200220_17:42:42:547446_
2020-06-26 04:48:55 INFO: parent_dir: logs/svhn/single_pred_0_bg
2020-06-26 04:48:55 INFO: test_dir: logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test
2020-06-26 04:48:55 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 04:48:55 INFO: Using dataset: svhn
2020-06-26 04:48:55 INFO: BUILD TEST GRAPH
2020-06-26 04:48:55 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:48:55 INFO: Overwrite dataset info from restored data version.
2020-06-26 04:48:56 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:48:56 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:48:57 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:48:58 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 04:48:58 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:48:58 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:48:58 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:48:58 INFO: input shape: (8, 32, 32, 3)
2020-06-26 04:48:58 INFO: relu_conv1 output shape: (8, 16, 16, 128)
2020-06-26 04:48:58 INFO: primary_caps pose shape: (8, 16, 16, 32, 16)
2020-06-26 04:48:58 INFO: primary_caps activation shape (8, 16, 16, 32, 1)
2020-06-26 04:48:58 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:48:59 INFO: lyr.conv_caps1 votes shape: (392, 288, 24, 16)
2020-06-26 04:48:59 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 04:48:59 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 04:48:59 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:48:59 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
2020-06-26 04:48:59 INFO: lyr.conv_caps1 activation_out shape: (8, 7, 7, 24, 1)
2020-06-26 04:48:59 INFO: lyr.conv_caps2 votes shape: (200, 216, 32, 16)
2020-06-26 04:48:59 INFO: lyr.conv_caps2 pose_out shape: (8, 5, 5, 32, 16)
2020-06-26 04:48:59 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 04:49:00 INFO: class_caps votes original shape: (200, 32, 10, 16)
2020-06-26 04:49:00 INFO: class_caps votes in to routing shape: (8, 800, 10, 16)
2020-06-26 04:49:00 INFO: class_caps activation shape: (8, 10)
2020-06-26 04:49:00 INFO: class_caps pose shape: (8, 10, 16)
2020-06-26 04:49:00 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:49:03 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:49:03 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:49:03 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-26 04:49:04 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
	 [[save/RestoreV2/_51]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_51]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_51]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 04:49:24 INFO: name: 20200220_17:42:42:547446_
2020-06-26 04:49:24 INFO: parent_dir: logs/svhn/single_pred_0_bg
2020-06-26 04:49:24 INFO: test_dir: logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test
2020-06-26 04:49:25 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 04:49:25 INFO: Using dataset: svhn
2020-06-26 04:49:25 INFO: BUILD TEST GRAPH
2020-06-26 04:49:25 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:49:25 INFO: Overwrite dataset info from restored data version.
2020-06-26 04:49:25 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:49:25 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:49:27 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:49:27 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 04:49:27 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:49:27 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:49:28 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:49:28 INFO: input shape: (8, 32, 32, 3)
2020-06-26 04:49:28 INFO: relu_conv1 output shape: (8, 16, 16, 128)
2020-06-26 04:49:28 INFO: primary_caps pose shape: (8, 16, 16, 32, 16)
2020-06-26 04:49:28 INFO: primary_caps activation shape (8, 16, 16, 32, 1)
2020-06-26 04:49:28 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:49:28 INFO: lyr.conv_caps1 votes shape: (392, 288, 24, 16)
2020-06-26 04:49:29 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 04:49:29 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 04:49:29 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:49:30 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
2020-06-26 04:49:30 INFO: lyr.conv_caps1 activation_out shape: (8, 7, 7, 24, 1)
2020-06-26 04:49:30 INFO: lyr.conv_caps2 votes shape: (200, 216, 32, 16)
2020-06-26 04:49:30 INFO: lyr.conv_caps2 pose_out shape: (8, 5, 5, 32, 16)
2020-06-26 04:49:30 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 04:49:30 INFO: class_caps votes original shape: (200, 32, 10, 16)
2020-06-26 04:49:30 INFO: class_caps votes in to routing shape: (8, 800, 10, 16)
2020-06-26 04:49:31 INFO: class_caps activation shape: (8, 10)
2020-06-26 04:49:31 INFO: class_caps pose shape: (8, 10, 16)
2020-06-26 04:49:31 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:49:35 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:49:35 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:49:36 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-26 04:49:36 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
	 [[save/RestoreV2/_19]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_19]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_19]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 04:50:40 INFO: name: 20200220_17:42:42:547446_
2020-06-26 04:50:40 INFO: parent_dir: logs/svhn/single_pred_0_bg
2020-06-26 04:50:40 INFO: test_dir: logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test
2020-06-26 04:50:40 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 04:50:40 INFO: Using dataset: svhn
2020-06-26 04:50:40 INFO: BUILD TEST GRAPH
2020-06-26 04:50:40 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:50:40 INFO: Overwrite dataset info from restored data version.
2020-06-26 04:50:40 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:50:40 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:50:40 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:50:40 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 04:50:40 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:50:40 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:50:40 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:50:40 INFO: input shape: (8, 32, 32, 3)
2020-06-26 04:50:41 INFO: relu_conv1 output shape: (8, 16, 16, 128)
2020-06-26 04:50:41 INFO: primary_caps pose shape: (8, 16, 16, 32, 16)
2020-06-26 04:50:41 INFO: primary_caps activation shape (8, 16, 16, 32, 1)
2020-06-26 04:50:41 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:50:41 INFO: lyr.conv_caps1 votes shape: (392, 288, 24, 16)
2020-06-26 04:50:41 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 04:50:41 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 04:50:41 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:50:41 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
2020-06-26 04:50:41 INFO: lyr.conv_caps1 activation_out shape: (8, 7, 7, 24, 1)
2020-06-26 04:50:41 INFO: lyr.conv_caps2 votes shape: (200, 216, 32, 16)
2020-06-26 04:50:41 INFO: lyr.conv_caps2 pose_out shape: (8, 5, 5, 32, 16)
2020-06-26 04:50:41 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 04:50:41 INFO: class_caps votes original shape: (200, 32, 10, 16)
2020-06-26 04:50:41 INFO: class_caps votes in to routing shape: (8, 800, 10, 16)
2020-06-26 04:50:41 INFO: class_caps activation shape: (8, 10)
2020-06-26 04:50:41 INFO: class_caps pose shape: (8, 10, 16)
2020-06-26 04:50:41 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:50:42 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:50:42 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:50:42 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-26 04:50:42 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 04:50:54 INFO: name: 20200220_17:42:42:547446_
2020-06-26 04:50:55 INFO: parent_dir: logs/svhn/single_pred_0_bg
2020-06-26 04:50:55 INFO: test_dir: logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test
2020-06-26 04:50:55 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 04:50:55 INFO: name: 20200220_17:42:42:547446_
2020-06-26 04:50:55 INFO: Using dataset: svhn
2020-06-26 04:50:55 INFO: parent_dir: logs/svhn/single_pred_0_bg
2020-06-26 04:50:55 INFO: BUILD TEST GRAPH
2020-06-26 04:50:55 INFO: test_dir: logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test
2020-06-26 04:50:55 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:50:56 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 04:50:56 INFO: Overwrite dataset info from restored data version.
2020-06-26 04:50:56 INFO: Using dataset: svhn
2020-06-26 04:50:56 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:50:56 INFO: BUILD TEST GRAPH
2020-06-26 04:50:56 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:50:56 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:50:57 INFO: Overwrite dataset info from restored data version.
2020-06-26 04:50:57 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:50:57 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:50:58 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:50:58 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 04:50:58 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:50:58 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:50:58 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:50:59 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:50:59 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 04:50:59 INFO: input shape: (8, 32, 32, 3)
2020-06-26 04:50:59 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:50:59 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:50:59 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:50:59 INFO: input shape: (8, 32, 32, 3)
2020-06-26 04:50:59 INFO: relu_conv1 output shape: (8, 16, 16, 128)
2020-06-26 04:51:00 INFO: relu_conv1 output shape: (8, 16, 16, 128)
2020-06-26 04:51:00 INFO: primary_caps pose shape: (8, 16, 16, 32, 16)
2020-06-26 04:51:00 INFO: primary_caps pose shape: (8, 16, 16, 32, 16)
2020-06-26 04:51:00 INFO: primary_caps activation shape (8, 16, 16, 32, 1)
2020-06-26 04:51:01 INFO: primary_caps activation shape (8, 16, 16, 32, 1)
2020-06-26 04:51:01 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:51:01 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:51:01 INFO: lyr.conv_caps1 votes shape: (392, 288, 24, 16)
2020-06-26 04:51:01 INFO: lyr.conv_caps1 votes shape: (392, 288, 24, 16)
2020-06-26 04:51:01 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 04:51:01 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 04:51:01 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 04:51:01 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 04:51:02 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:51:02 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:51:02 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
2020-06-26 04:51:02 INFO: lyr.conv_caps1 activation_out shape: (8, 7, 7, 24, 1)
2020-06-26 04:51:02 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
2020-06-26 04:51:02 INFO: lyr.conv_caps1 activation_out shape: (8, 7, 7, 24, 1)
2020-06-26 04:51:02 INFO: lyr.conv_caps2 votes shape: (200, 216, 32, 16)
2020-06-26 04:51:03 INFO: lyr.conv_caps2 pose_out shape: (8, 5, 5, 32, 16)
2020-06-26 04:51:03 INFO: lyr.conv_caps2 pose_out shape: (8, 5, 5, 32, 16)
2020-06-26 04:51:03 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 04:51:03 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 04:51:03 INFO: class_caps votes original shape: (200, 32, 10, 16)
2020-06-26 04:51:03 INFO: class_caps votes original shape: (200, 32, 10, 16)
2020-06-26 04:51:03 INFO: class_caps votes in to routing shape: (8, 800, 10, 16)
2020-06-26 04:51:03 INFO: class_caps votes in to routing shape: (8, 800, 10, 16)
2020-06-26 04:51:03 INFO: class_caps activation shape: (8, 10)
2020-06-26 04:51:03 INFO: class_caps pose shape: (8, 10, 16)
2020-06-26 04:51:03 INFO: class_caps activation shape: (8, 10)
2020-06-26 04:51:04 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:51:04 INFO: class_caps pose shape: (8, 10, 16)
2020-06-26 04:51:05 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:51:09 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:51:09 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:51:10 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-26 04:51:10 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:51:10 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
	 [[save/RestoreV2/_3]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_3]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_3]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 04:51:10 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:51:10 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-26 04:51:10 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 04:51:24 INFO: name: 20200220_17:42:42:547446_
2020-06-26 04:51:25 INFO: name: 20200220_17:42:42:547446_
2020-06-26 04:51:25 INFO: parent_dir: logs/svhn/single_pred_0_bg
2020-06-26 04:51:25 INFO: parent_dir: logs/svhn/single_pred_0_bg
2020-06-26 04:51:25 INFO: test_dir: logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test
2020-06-26 04:51:25 INFO: test_dir: logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test
2020-06-26 04:51:25 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 04:51:25 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 04:51:26 INFO: Using dataset: svhn
2020-06-26 04:51:26 INFO: Using dataset: svhn
2020-06-26 04:51:26 INFO: BUILD TEST GRAPH
2020-06-26 04:51:26 INFO: BUILD TEST GRAPH
2020-06-26 04:51:26 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:51:26 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:51:27 INFO: Overwrite dataset info from restored data version.
2020-06-26 04:51:27 INFO: Overwrite dataset info from restored data version.
2020-06-26 04:51:27 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:51:27 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:51:27 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:51:27 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:51:28 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:51:28 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

erator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:51:29 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:51:29 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 04:51:29 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:51:29 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:51:29 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:51:29 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:51:29 INFO: input shape: (8, 32, 32, 3)
2020-06-26 04:51:30 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:51:30 INFO: input shape: (8, 32, 32, 3)
2020-06-26 04:51:30 INFO: relu_conv1 output shape: (8, 16, 16, 128)
2020-06-26 04:51:30 INFO: relu_conv1 output shape: (8, 16, 16, 128)
2020-06-26 04:51:30 INFO: primary_caps pose shape: (8, 16, 16, 32, 16)
2020-06-26 04:51:30 INFO: primary_caps pose shape: (8, 16, 16, 32, 16)
2020-06-26 04:51:30 INFO: primary_caps activation shape (8, 16, 16, 32, 1)
2020-06-26 04:51:30 INFO: primary_caps activation shape (8, 16, 16, 32, 1)
2020-06-26 04:51:30 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:51:30 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:51:30 INFO: lyr.conv_caps1 votes shape: (392, 288, 24, 16)
2020-06-26 04:51:31 INFO: lyr.conv_caps1 votes shape: (392, 288, 24, 16)
2020-06-26 04:51:31 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 04:51:31 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 04:51:31 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 04:51:31 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 04:51:31 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:51:32 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:51:32 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
2020-06-26 04:51:32 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
2020-06-26 04:51:32 INFO: lyr.conv_caps1 activation_out shape: (8, 7, 7, 24, 1)
2020-06-26 04:51:32 INFO: lyr.conv_caps1 activation_out shape: (8, 7, 7, 24, 1)
2020-06-26 04:51:32 INFO: lyr.conv_caps2 votes shape: (200, 216, 32, 16)
2020-06-26 04:51:32 INFO: lyr.conv_caps2 votes shape: (200, 216, 32, 16)
2020-06-26 04:51:32 INFO: lyr.conv_caps2 pose_out shape: (8, 5, 5, 32, 16)
2020-06-26 04:51:33 INFO: lyr.conv_caps2 pose_out shape: (8, 5, 5, 32, 16)
2020-06-26 04:51:33 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 04:51:33 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 04:51:33 INFO: class_caps votes original shape: (200, 32, 10, 16)
2020-06-26 04:51:33 INFO: class_caps votes original shape: (200, 32, 10, 16)
2020-06-26 04:51:34 INFO: class_caps votes in to routing shape: (8, 800, 10, 16)
2020-06-26 04:51:34 INFO: class_caps votes in to routing shape: (8, 800, 10, 16)
2020-06-26 04:51:34 INFO: class_caps activation shape: (8, 10)
2020-06-26 04:51:34 INFO: class_caps activation shape: (8, 10)
2020-06-26 04:51:34 INFO: class_caps pose shape: (8, 10, 16)
2020-06-26 04:51:34 INFO: class_caps pose shape: (8, 10, 16)
2020-06-26 04:51:34 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:51:34 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:51:37 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:51:38 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:51:38 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:51:38 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-26 04:51:38 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:51:38 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-26 04:51:38 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
	 [[save/RestoreV2/_51]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_51]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_51]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 04:51:38 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 04:51:55 INFO: name: 20200220_17:42:42:547446_
2020-06-26 04:51:55 INFO: parent_dir: logs/svhn/single_pred_0_bg
2020-06-26 04:51:55 INFO: test_dir: logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test
2020-06-26 04:51:55 INFO: name: 20200220_17:42:42:547446_
2020-06-26 04:51:56 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 04:51:56 INFO: parent_dir: logs/svhn/single_pred_0_bg
2020-06-26 04:51:56 INFO: Using dataset: svhn
2020-06-26 04:51:56 INFO: test_dir: logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test
2020-06-26 04:51:56 INFO: BUILD TEST GRAPH
2020-06-26 04:51:56 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 04:51:56 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:51:56 INFO: Using dataset: svhn
2020-06-26 04:51:56 INFO: Overwrite dataset info from restored data version.
2020-06-26 04:51:56 INFO: BUILD TEST GRAPH
2020-06-26 04:51:57 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:51:57 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:51:57 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:51:57 INFO: Overwrite dataset info from restored data version.
2020-06-26 04:51:57 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:51:57 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:51:58 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:51:58 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 04:51:58 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:51:58 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:51:58 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:51:58 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:51:59 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 04:51:59 INFO: input shape: (8, 32, 32, 3)
2020-06-26 04:51:59 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:51:59 INFO: relu_conv1 output shape: (8, 16, 16, 128)
2020-06-26 04:51:59 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:51:59 INFO: primary_caps pose shape: (8, 16, 16, 32, 16)
2020-06-26 04:51:59 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:51:59 INFO: primary_caps activation shape (8, 16, 16, 32, 1)
2020-06-26 04:51:59 INFO: input shape: (8, 32, 32, 3)
2020-06-26 04:51:59 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:52:00 INFO: lyr.conv_caps1 votes shape: (392, 288, 24, 16)
2020-06-26 04:52:00 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 04:52:00 INFO: relu_conv1 output shape: (8, 16, 16, 128)
2020-06-26 04:52:00 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 04:52:00 INFO: primary_caps pose shape: (8, 16, 16, 32, 16)
2020-06-26 04:52:00 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:52:00 INFO: primary_caps activation shape (8, 16, 16, 32, 1)
2020-06-26 04:52:00 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
2020-06-26 04:52:00 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:52:01 INFO: lyr.conv_caps1 activation_out shape: (8, 7, 7, 24, 1)
2020-06-26 04:52:01 INFO: lyr.conv_caps1 votes shape: (392, 288, 24, 16)
2020-06-26 04:52:01 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 04:52:01 INFO: lyr.conv_caps2 votes shape: (200, 216, 32, 16)
2020-06-26 04:52:01 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 04:52:02 INFO: lyr.conv_caps2 pose_out shape: (8, 5, 5, 32, 16)
2020-06-26 04:52:02 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:52:02 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 04:52:02 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
2020-06-26 04:52:02 INFO: class_caps votes original shape: (200, 32, 10, 16)
2020-06-26 04:52:02 INFO: lyr.conv_caps1 activation_out shape: (8, 7, 7, 24, 1)
2020-06-26 04:52:02 INFO: class_caps votes in to routing shape: (8, 800, 10, 16)
2020-06-26 04:52:02 INFO: lyr.conv_caps2 votes shape: (200, 216, 32, 16)
2020-06-26 04:52:03 INFO: class_caps activation shape: (8, 10)
2020-06-26 04:52:03 INFO: class_caps pose shape: (8, 10, 16)
2020-06-26 04:52:03 INFO: lyr.conv_caps2 pose_out shape: (8, 5, 5, 32, 16)
2020-06-26 04:52:03 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 04:52:03 INFO: class_caps votes original shape: (200, 32, 10, 16)
2020-06-26 04:52:03 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:52:03 INFO: class_caps votes in to routing shape: (8, 800, 10, 16)
2020-06-26 04:52:04 INFO: class_caps activation shape: (8, 10)
2020-06-26 04:52:04 INFO: class_caps pose shape: (8, 10, 16)
2020-06-26 04:52:04 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:52:06 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:52:06 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:52:06 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-26 04:52:07 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
	 [[save/RestoreV2/_15]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_15]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_15]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 04:52:07 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:52:07 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:52:07 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-26 04:52:08 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 04:52:25 INFO: name: 20200220_17:42:42:547446_
2020-06-26 04:52:25 INFO: parent_dir: logs/svhn/single_pred_0_bg
2020-06-26 04:52:25 INFO: test_dir: logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test
2020-06-26 04:52:25 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 04:52:25 INFO: Using dataset: svhn
2020-06-26 04:52:26 INFO: BUILD TEST GRAPH
2020-06-26 04:52:26 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:52:26 INFO: name: 20200220_17:42:42:547446_
2020-06-26 04:52:26 INFO: Overwrite dataset info from restored data version.
2020-06-26 04:52:26 INFO: parent_dir: logs/svhn/single_pred_0_bg
2020-06-26 04:52:26 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:52:26 INFO: test_dir: logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test
2020-06-26 04:52:26 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:52:26 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 04:52:27 INFO: Using dataset: svhn
2020-06-26 04:52:27 INFO: BUILD TEST GRAPH
2020-06-26 04:52:27 WARNING: From inspect_results.py:91: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 04:52:27 INFO: Overwrite dataset info from restored data version.
2020-06-26 04:52:27 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 04:52:28 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 04:52:28 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:52:28 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 04:52:28 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:52:29 WARNING: From inspect_results.py:306: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:52:29 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:52:29 INFO: input shape: (8, 32, 32, 3)
2020-06-26 04:52:29 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 04:52:29 WARNING: From inspect_results.py:126: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 04:52:29 WARNING: From inspect_results.py:306: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 04:52:29 INFO: relu_conv1 output shape: (8, 16, 16, 128)
f.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 04:52:30 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 04:52:30 INFO: primary_caps pose shape: (8, 16, 16, 32, 16)
2020-06-26 04:52:30 INFO: input shape: (8, 32, 32, 3)
2020-06-26 04:52:30 INFO: primary_caps activation shape (8, 16, 16, 32, 1)
2020-06-26 04:52:30 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:52:30 INFO: relu_conv1 output shape: (8, 16, 16, 128)
2020-06-26 04:52:30 INFO: lyr.conv_caps1 votes shape: (392, 288, 24, 16)
2020-06-26 04:52:30 INFO: primary_caps pose shape: (8, 16, 16, 32, 16)
2020-06-26 04:52:30 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 04:52:30 INFO: primary_caps activation shape (8, 16, 16, 32, 1)
2020-06-26 04:52:31 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 04:52:31 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 04:52:31 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:52:31 INFO: lyr.conv_caps1 votes shape: (392, 288, 24, 16)
2020-06-26 04:52:31 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
2020-06-26 04:52:31 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 04:52:31 INFO: lyr.conv_caps1 activation_out shape: (8, 7, 7, 24, 1)
2020-06-26 04:52:32 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 04:52:32 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 04:52:32 INFO: lyr.conv_caps2 votes shape: (200, 216, 32, 16)
2020-06-26 04:52:32 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
2020-06-26 04:52:32 INFO: lyr.conv_caps2 pose_out shape: (8, 5, 5, 32, 16)
2020-06-26 04:52:32 INFO: lyr.conv_caps1 activation_out shape: (8, 7, 7, 24, 1)
2020-06-26 04:52:32 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 04:52:32 INFO: class_caps votes original shape: (200, 32, 10, 16)
2020-06-26 04:52:32 INFO: class_caps votes in to routing shape: (8, 800, 10, 16)
2020-06-26 04:52:32 INFO: lyr.conv_caps2 votes shape: (200, 216, 32, 16)
2020-06-26 04:52:32 INFO: class_caps activation shape: (8, 10)
2020-06-26 04:52:33 INFO: class_caps pose shape: (8, 10, 16)
2020-06-26 04:52:33 INFO: lyr.conv_caps2 pose_out shape: (8, 5, 5, 32, 16)
2020-06-26 04:52:33 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 04:52:33 INFO: class_caps votes original shape: (200, 32, 10, 16)
2020-06-26 04:52:33 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:52:33 INFO: class_caps votes in to routing shape: (8, 800, 10, 16)
2020-06-26 04:52:34 INFO: class_caps activation shape: (8, 10)
2020-06-26 04:52:34 INFO: class_caps pose shape: (8, 10, 16)
2020-06-26 04:52:34 WARNING: From inspect_results.py:171: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 04:52:37 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:52:37 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:52:37 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-26 04:52:38 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]
	 [[save/RestoreV2/_15]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: 2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_15]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

2 root error(s) found.
  (0) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
  (1) Not found: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]
	 [[save/RestoreV2/_15]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 04:52:38 WARNING: From inspect_results.py:193: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 04:52:39 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 04:52:39 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-26 04:52:39 CRITICAL: Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1356, in _do_call
    return fn(*args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1341, in _run_fn
    options, feed_dict, fetch_list, target_list, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1429, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.NotFoundError: Key patch_params not found in checkpoint
	 [[{{node save/RestoreV2}}]]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1286, in restore
    {self.saver_def.filename_tensor_name: save_path})
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 950, in run
    run_metadata_ptr)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1173, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1350, in _do_run
    run_metadata)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1370, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.NotFoundError: Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1296, in restore
    names_to_keys = object_graph_key_mapping(save_path)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1614, in object_graph_key_mapping
    object_graph_string = reader.get_tensor(trackable.OBJECT_GRAPH_PROTO_KEY)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 678, in get_tensor
    return CheckpointReader_GetTensor(self, compat.as_bytes(tensor_str))
tensorflow.python.framework.errors_impl.NotFoundError: Key _CHECKPOINTABLE_OBJECT_GRAPH not found in checkpoint

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 233, in main
    saver.restore(sess_test, ckpt)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 1302, in restore
    err, "a Variable name or other graph key that is missing")
tensorflow.python.framework.errors_impl.NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:

Key patch_params not found in checkpoint
	 [[node save/RestoreV2 (defined at inspect_results.py:171) ]]

Original stack trace for 'save/RestoreV2':
  File "inspect_results.py", line 320, in <module>
    tf.app.run()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/platform/app.py", line 40, in run
    _run(main=main, argv=argv, flags_parser=_parse_flags_tolerate_undef)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "inspect_results.py", line 171, in main
    saver = tf.train.Saver(max_to_keep=None)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 825, in __init__
    self.build()
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 837, in build
    self._build(self._filename, build_save=True, build_restore=True)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 875, in _build
    build_restore=build_restore)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 508, in _build_internal
    restore_sequentially, reshape)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 328, in _AddRestoreOps
    restore_sequentially)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py", line 575, in bulk_restore
    return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1696, in restore_v2
    name=name)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py", line 788, in _apply_op_helper
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 3616, in create_op
    op_def=op_def)
  File "/home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/framework/ops.py", line 2005, in __init__
    self._traceback = tf_stack.extract_stack()


2020-06-26 20:31:07 INFO: name: 20200220_17:42:42:547446_
2020-06-26 20:31:07 INFO: parent_dir: logs/svhn/single_pred_0_bg
2020-06-26 20:31:07 INFO: test_dir: logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test
2020-06-26 20:31:07 INFO: patch_path: logs/svhn/modcap_adv_05/20200529_14:28:15:402853_/train/saved_patch.png
2020-06-26 20:31:07 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 20:31:07 INFO: Using dataset: svhn
2020-06-26 20:31:07 INFO: BUILD TEST GRAPH
2020-06-26 20:31:07 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 20:31:07 INFO: Overwrite dataset info from restored data version.
2020-06-26 20:31:07 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 20:31:07 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 20:31:07 INFO: name: 20200220_17:42:42:547446_
2020-06-26 20:31:08 INFO: parent_dir: logs/svhn/single_pred_0_bg
2020-06-26 20:31:08 INFO: name: 20200220_17:42:42:547446_
0_bg/20200220_17:42:42:547446_/test
2020-06-26 20:31:08 INFO: name: 20200220_17:42:42:547446_
_15/20200529_14:43:08:286782_/train/saved_patch.png
2020-06-26 20:31:08 INFO: parent_dir: logs/svhn/single_pred_0_bg
2020-06-26 20:31:08 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 20:31:08 INFO: parent_dir: logs/svhn/single_pred_0_bg
2020-06-26 20:31:08 INFO: test_dir: logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test
2020-06-26 20:31:08 INFO: Using dataset: svhn
2020-06-26 20:31:08 INFO: test_dir: logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test
saved_patch.png
py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 20:31:08 INFO: patch_path: logs/svhn/modcap_adv_20/20200529_15:34:32:157091_/train/saved_patch.png
ated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 20:31:08 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 20:31:08 INFO: Overwrite dataset info from restored data version.
2020-06-26 20:31:08 INFO: Using dataset: svhn
om file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 20:31:08 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 20:31:08 INFO: Using dataset: svhn
lts.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 20:31:08 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 20:31:08 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
.compat.v1.train.get_or_create_global_step instead.

2020-06-26 20:31:08 INFO: BUILD TEST GRAPH
2020-06-26 20:31:08 INFO: Overwrite dataset info from restored data version.
h-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 20:31:08 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 20:31:08 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 20:31:08 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 20:31:08 INFO: Overwrite dataset info from restored data version.
2020-06-26 20:31:08 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 20:31:08 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 20:31:08 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 20:31:08 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 20:31:08 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 20:31:08 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 20:31:08 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 20:31:08 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 20:31:08 INFO: relu_conv1 output shape: (8, 16, 16, 128)
2020-06-26 20:31:08 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 20:31:08 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 20:31:08 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 20:31:08 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 20:31:08 INFO: primary_caps pose shape: (8, 16, 16, 32, 16)
2020-06-26 20:31:08 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 20:31:08 INFO: name: 20200220_17:42:42:547446_
The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 20:31:08 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 20:31:08 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 20:31:08 INFO: test_dir: logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test
precated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 20:31:08 INFO: patch_path: logs/svhn/modcap_adv_00/20200529_14:25:18:544445_/train/saved_patch.png
2020-06-26 20:31:08 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 20:31:08 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 20:31:08 INFO: Using dataset: svhn
2020-06-26 20:31:08 INFO: input shape: (8, 32, 32, 3)
2020-06-26 20:31:08 INFO: BUILD TEST GRAPH
9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 20:31:09 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 20:31:09 INFO: relu_conv1 output shape: (8, 16, 16, 128)
sules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 20:31:09 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 20:31:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 20:31:09 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 20:31:09 INFO: primary_caps pose shape: (8, 16, 16, 32, 16)
2020-06-26 20:31:09 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
2020-06-26 20:31:09 INFO: relu_conv1 output shape: (8, 16, 16, 128)
2020-06-26 20:31:09 INFO: primary_caps activation shape (8, 16, 16, 32, 1)
, 1)
2020-06-26 20:31:09 INFO: relu_conv1 output shape: (8, 16, 16, 128)
2020-06-26 20:31:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 20:31:09 INFO: lyr.conv_caps2 votes shape: (200, 216, 32, 16)
2020-06-26 20:31:09 INFO: primary_caps pose shape: (8, 16, 16, 32, 16)
2020-06-26 20:31:09 INFO: lyr.conv_caps1 votes shape: (392, 288, 24, 16)
)
2020-06-26 20:31:09 INFO: primary_caps activation shape (8, 16, 16, 32, 1)
ith-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 20:31:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 20:31:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 20:31:09 INFO: lyr.conv_caps1 votes shape: (392, 288, 24, 16)
2020-06-26 20:31:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 20:31:09 INFO: lyr.conv_caps1 votes shape: (392, 288, 24, 16)
2020-06-26 20:31:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 20:31:09 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 20:31:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 20:31:09 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 20:31:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 20:31:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 20:31:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 20:31:09 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
2020-06-26 20:31:09 INFO: lyr.conv_caps1 activation_out shape: (8, 7, 7, 24, 1)
m-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 20:31:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 20:31:09 INFO: lyr.conv_caps2 votes shape: (200, 216, 32, 16)
)
2020-06-26 20:31:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 20:31:09 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 20:31:09 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
)
2020-06-26 20:31:09 INFO: lyr.conv_caps1 activation_out shape: (8, 7, 7, 24, 1)

2020-06-26 20:31:09 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
2020-06-26 20:31:09 INFO: lyr.conv_caps1 activation_out shape: (8, 7, 7, 24, 1)
2020-06-26 20:31:09 INFO: lyr.conv_caps2 votes shape: (200, 216, 32, 16)
2020-06-26 20:31:09 INFO: lyr.conv_caps2 votes shape: (200, 216, 32, 16)
2020-06-26 20:31:09 INFO: class_caps activation shape: (8, 10)
2020-06-26 20:31:09 INFO: class_caps pose shape: (8, 10, 16)
2020-06-26 20:31:09 INFO: relu_conv1 output shape: (8, 16, 16, 128)
2020-06-26 20:31:09 INFO: lyr.conv_caps2 pose_out shape: (8, 5, 5, 32, 16)
2020-06-26 20:31:09 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 20:31:09 INFO: class_caps votes original shape: (200, 32, 10, 16)
2020-06-26 20:31:09 INFO: primary_caps activation shape (8, 16, 16, 32, 1)
2020-06-26 20:31:09 INFO: class_caps votes in to routing shape: (8, 800, 10, 16)
2020-06-26 20:31:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 20:31:09 INFO: lyr.conv_caps2 pose_out shape: (8, 5, 5, 32, 16)
2020-06-26 20:31:09 INFO: lyr.conv_caps1 votes shape: (392, 288, 24, 16)
2020-06-26 20:31:09 INFO: lyr.conv_caps2 pose_out shape: (8, 5, 5, 32, 16)
2020-06-26 20:31:09 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 20:31:09 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 20:31:09 INFO: class_caps activation shape: (8, 10)
, 32, 10, 16)
h-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 20:31:09 INFO: class_caps votes original shape: (200, 32, 10, 16)
2020-06-26 20:31:09 INFO: class_caps votes in to routing shape: (8, 800, 10, 16)
2020-06-26 20:31:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 20:31:09 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 20:31:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 20:31:10 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
2020-06-26 20:31:10 INFO: class_caps activation shape: (8, 10)
2020-06-26 20:31:10 INFO: class_caps activation shape: (8, 10)
2020-06-26 20:31:10 INFO: lyr.conv_caps1 activation_out shape: (8, 7, 7, 24, 1)
2020-06-26 20:31:10 INFO: class_caps pose shape: (8, 10, 16)
2020-06-26 20:31:10 INFO: class_caps pose shape: (8, 10, 16)
2020-06-26 20:31:10 INFO: lyr.conv_caps2 votes shape: (200, 216, 32, 16)
2020-06-26 20:31:10 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 20:31:10 INFO: lyr.conv_caps2 pose_out shape: (8, 5, 5, 32, 16)
2020-06-26 20:31:10 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 20:31:10 INFO: class_caps votes original shape: (200, 32, 10, 16)
2020-06-26 20:31:10 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 20:31:10 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 20:31:10 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 20:31:10 INFO: class_caps activation shape: (8, 10)
2020-06-26 20:31:10 INFO: class_caps pose shape: (8, 10, 16)
2020-06-26 20:31:10 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 20:31:10 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-26 20:31:10 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 20:31:10 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 20:31:10 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-26 20:31:10 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 20:31:10 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 20:31:10 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 20:31:10 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 20:31:11 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-26 20:31:11 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 20:31:11 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-26 20:31:11 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 20:31:11 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 20:31:11 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-26 20:36:08 INFO: name: 20200220_17:42:42:547446_
2020-06-26 20:36:08 INFO: parent_dir: logs/svhn/single_pred_0_bg
2020-06-26 20:36:08 INFO: test_dir: logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test
2020-06-26 20:36:08 INFO: patch_path: logs/svhn/modcap_adv_25/20200529_15:34:32:155179_/train/saved_patch.png
2020-06-26 20:36:08 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 20:36:08 INFO: Using dataset: svhn
2020-06-26 20:36:08 INFO: BUILD TEST GRAPH
2020-06-26 20:36:08 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 20:36:08 INFO: Overwrite dataset info from restored data version.
2020-06-26 20:36:08 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 20:36:08 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 20:36:08 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 20:36:08 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 20:36:08 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 20:36:08 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 20:36:08 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 20:36:08 INFO: input shape: (8, 32, 32, 3)
2020-06-26 20:36:09 INFO: relu_conv1 output shape: (8, 16, 16, 128)
2020-06-26 20:36:09 INFO: primary_caps pose shape: (8, 16, 16, 32, 16)
2020-06-26 20:36:09 INFO: primary_caps activation shape (8, 16, 16, 32, 1)
2020-06-26 20:36:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 20:36:09 INFO: lyr.conv_caps1 votes shape: (392, 288, 24, 16)
2020-06-26 20:36:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 20:36:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 20:36:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 20:36:09 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
2020-06-26 20:36:09 INFO: lyr.conv_caps1 activation_out shape: (8, 7, 7, 24, 1)
2020-06-26 20:36:09 INFO: lyr.conv_caps2 votes shape: (200, 216, 32, 16)
2020-06-26 20:36:09 INFO: lyr.conv_caps2 pose_out shape: (8, 5, 5, 32, 16)
2020-06-26 20:36:09 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 20:36:09 INFO: class_caps votes original shape: (200, 32, 10, 16)
2020-06-26 20:36:09 INFO: class_caps votes in to routing shape: (8, 800, 10, 16)
2020-06-26 20:36:09 INFO: class_caps activation shape: (8, 10)
2020-06-26 20:36:09 INFO: class_caps pose shape: (8, 10, 16)
2020-06-26 20:36:10 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 20:36:10 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 20:36:10 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 20:36:10 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-26 20:36:38 INFO: name: 20200220_17:42:42:547446_
2020-06-26 20:36:38 INFO: parent_dir: logs/svhn/single_pred_0_bg
2020-06-26 20:36:38 INFO: test_dir: logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test
2020-06-26 20:36:38 INFO: patch_path: logs/svhn/modcap_adv_30/20200529_15:43:23:179014_/train/saved_patch.png
2020-06-26 20:36:38 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 20:36:38 INFO: Using dataset: svhn
2020-06-26 20:36:38 INFO: BUILD TEST GRAPH
2020-06-26 20:36:38 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 20:36:38 INFO: Overwrite dataset info from restored data version.
2020-06-26 20:36:38 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 20:36:38 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 20:36:38 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 20:36:38 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 20:36:39 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 20:36:39 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 20:36:39 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 20:36:39 INFO: input shape: (8, 32, 32, 3)
2020-06-26 20:36:39 INFO: relu_conv1 output shape: (8, 16, 16, 128)
2020-06-26 20:36:39 INFO: primary_caps pose shape: (8, 16, 16, 32, 16)
2020-06-26 20:36:39 INFO: primary_caps activation shape (8, 16, 16, 32, 1)
2020-06-26 20:36:39 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 20:36:39 INFO: lyr.conv_caps1 votes shape: (392, 288, 24, 16)
2020-06-26 20:36:39 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 20:36:39 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 20:36:39 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 20:36:39 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
2020-06-26 20:36:39 INFO: lyr.conv_caps1 activation_out shape: (8, 7, 7, 24, 1)
2020-06-26 20:36:39 INFO: lyr.conv_caps2 votes shape: (200, 216, 32, 16)
2020-06-26 20:36:39 INFO: lyr.conv_caps2 pose_out shape: (8, 5, 5, 32, 16)
2020-06-26 20:36:39 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 20:36:39 INFO: class_caps votes original shape: (200, 32, 10, 16)
2020-06-26 20:36:39 INFO: class_caps votes in to routing shape: (8, 800, 10, 16)
2020-06-26 20:36:39 INFO: class_caps activation shape: (8, 10)
2020-06-26 20:36:40 INFO: class_caps pose shape: (8, 10, 16)
2020-06-26 20:36:40 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 20:36:40 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 20:36:40 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 20:36:40 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-26 20:37:08 INFO: name: 20200220_17:42:42:547446_
2020-06-26 20:37:08 INFO: parent_dir: logs/svhn/single_pred_0_bg
2020-06-26 20:37:08 INFO: test_dir: logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test
2020-06-26 20:37:08 INFO: name: 20200220_17:42:42:547446_
2020-06-26 20:37:08 INFO: patch_path: logs/svhn/modcap_adv_35/20200529_16:04:05:697072_/train/saved_patch.png
2020-06-26 20:37:08 INFO: parent_dir: logs/svhn/single_pred_0_bg
2020-06-26 20:37:08 INFO: test_dir: logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test
2020-06-26 20:37:08 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 20:37:08 INFO: patch_path: logs/svhn/modcap_adv_40/20200529_16:06:38:175219_/train/saved_patch.png
2020-06-26 20:37:08 INFO: Using dataset: svhn
2020-06-26 20:37:08 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 20:37:08 INFO: BUILD TEST GRAPH
2020-06-26 20:37:08 INFO: Using dataset: svhn
2020-06-26 20:37:08 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 20:37:08 INFO: BUILD TEST GRAPH
2020-06-26 20:37:08 INFO: Overwrite dataset info from restored data version.
2020-06-26 20:37:08 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 20:37:08 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 20:37:08 INFO: Overwrite dataset info from restored data version.
home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 20:37:08 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 20:37:08 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 20:37:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 20:37:09 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 20:37:09 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 20:37:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 20:37:09 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 20:37:09 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 20:37:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 20:37:09 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 20:37:09 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 20:37:09 INFO: input shape: (8, 32, 32, 3)
2020-06-26 20:37:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 20:37:09 INFO: input shape: (8, 32, 32, 3)
2020-06-26 20:37:09 INFO: name: 20200220_17:42:42:547446_
2020-06-26 20:37:09 INFO: parent_dir: logs/svhn/single_pred_0_bg
2020-06-26 20:37:09 INFO: test_dir: logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test
2020-06-26 20:37:09 INFO: patch_path: logs/svhn/modcap_adv_45/20200529_17:33:44:143073_/train/saved_patch.png
2020-06-26 20:37:09 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 20:37:09 INFO: Using dataset: svhn
2020-06-26 20:37:09 INFO: BUILD TEST GRAPH
2020-06-26 20:37:09 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 20:37:09 INFO: Overwrite dataset info from restored data version.
2020-06-26 20:37:09 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 20:37:09 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 20:37:09 INFO: relu_conv1 output shape: (8, 16, 16, 128)
2020-06-26 20:37:09 INFO: relu_conv1 output shape: (8, 16, 16, 128)
2020-06-26 20:37:09 INFO: primary_caps pose shape: (8, 16, 16, 32, 16)
2020-06-26 20:37:09 INFO: primary_caps activation shape (8, 16, 16, 32, 1)
2020-06-26 20:37:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 20:37:09 INFO: primary_caps pose shape: (8, 16, 16, 32, 16)
2020-06-26 20:37:09 INFO: primary_caps activation shape (8, 16, 16, 32, 1)
2020-06-26 20:37:09 INFO: lyr.conv_caps1 votes shape: (392, 288, 24, 16)
2020-06-26 20:37:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

recated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 20:37:09 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 20:37:09 INFO: lyr.conv_caps1 votes shape: (392, 288, 24, 16)
-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 20:37:09 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 20:37:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 20:37:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 20:37:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 20:37:09 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 20:37:09 INFO: input shape: (8, 32, 32, 3)
ace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 20:37:09 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
2020-06-26 20:37:09 INFO: lyr.conv_caps1 activation_out shape: (8, 7, 7, 24, 1)
2020-06-26 20:37:09 INFO: lyr.conv_caps2 votes shape: (200, 216, 32, 16)
2020-06-26 20:37:09 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
2020-06-26 20:37:09 INFO: lyr.conv_caps1 activation_out shape: (8, 7, 7, 24, 1)
2020-06-26 20:37:09 INFO: lyr.conv_caps2 votes shape: (200, 216, 32, 16)
2020-06-26 20:37:09 INFO: relu_conv1 output shape: (8, 16, 16, 128)
2020-06-26 20:37:09 INFO: lyr.conv_caps2 pose_out shape: (8, 5, 5, 32, 16)
2020-06-26 20:37:09 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 20:37:10 INFO: primary_caps pose shape: (8, 16, 16, 32, 16)
2020-06-26 20:37:10 INFO: class_caps votes original shape: (200, 32, 10, 16)
2020-06-26 20:37:10 INFO: primary_caps activation shape (8, 16, 16, 32, 1)
2020-06-26 20:37:10 INFO: class_caps votes in to routing shape: (8, 800, 10, 16)
2020-06-26 20:37:10 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 20:37:10 INFO: lyr.conv_caps2 pose_out shape: (8, 5, 5, 32, 16)
2020-06-26 20:37:10 INFO: lyr.conv_caps1 votes shape: (392, 288, 24, 16)
2020-06-26 20:37:10 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 20:37:10 INFO: class_caps activation shape: (8, 10)
2020-06-26 20:37:10 INFO: class_caps votes original shape: (200, 32, 10, 16)
2020-06-26 20:37:10 INFO: class_caps pose shape: (8, 10, 16)
rix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 20:37:10 INFO: class_caps votes in to routing shape: (8, 800, 10, 16)
2020-06-26 20:37:10 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 20:37:10 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 20:37:10 INFO: class_caps activation shape: (8, 10)
2020-06-26 20:37:10 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
2020-06-26 20:37:10 INFO: class_caps pose shape: (8, 10, 16)
2020-06-26 20:37:10 INFO: lyr.conv_caps1 activation_out shape: (8, 7, 7, 24, 1)
2020-06-26 20:37:10 INFO: lyr.conv_caps2 votes shape: (200, 216, 32, 16)
2020-06-26 20:37:10 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 20:37:10 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 20:37:10 INFO: lyr.conv_caps2 pose_out shape: (8, 5, 5, 32, 16)
2020-06-26 20:37:10 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 20:37:10 INFO: class_caps votes original shape: (200, 32, 10, 16)
2020-06-26 20:37:10 INFO: class_caps votes in to routing shape: (8, 800, 10, 16)
2020-06-26 20:37:10 INFO: class_caps activation shape: (8, 10)
2020-06-26 20:37:10 INFO: class_caps pose shape: (8, 10, 16)
 name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 20:37:10 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 20:37:11 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 20:37:11 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-26 20:37:11 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 20:37:11 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-26 20:37:11 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 20:37:11 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 20:37:11 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 20:37:11 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-26 20:37:32 INFO: name: 20200220_17:42:42:547446_
2020-06-26 20:37:32 INFO: parent_dir: logs/svhn/single_pred_0_bg
2020-06-26 20:37:32 INFO: test_dir: logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test
2020-06-26 20:37:32 INFO: patch_path: logs/svhn/modcap_adv_50/20200529_18:50:56:538576_/train/saved_patch.png
2020-06-26 20:37:32 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 20:37:32 INFO: Using dataset: svhn
2020-06-26 20:37:32 INFO: BUILD TEST GRAPH
2020-06-26 20:37:32 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 20:37:32 INFO: Overwrite dataset info from restored data version.
2020-06-26 20:37:32 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 20:37:32 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 20:37:32 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 20:37:32 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 20:37:32 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 20:37:32 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 20:37:32 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 20:37:32 INFO: input shape: (8, 32, 32, 3)
2020-06-26 20:37:33 INFO: relu_conv1 output shape: (8, 16, 16, 128)
2020-06-26 20:37:33 INFO: primary_caps pose shape: (8, 16, 16, 32, 16)
2020-06-26 20:37:33 INFO: primary_caps activation shape (8, 16, 16, 32, 1)
2020-06-26 20:37:33 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 20:37:33 INFO: lyr.conv_caps1 votes shape: (392, 288, 24, 16)
2020-06-26 20:37:33 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 20:37:33 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 20:37:33 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 20:37:33 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
2020-06-26 20:37:33 INFO: lyr.conv_caps1 activation_out shape: (8, 7, 7, 24, 1)
2020-06-26 20:37:33 INFO: lyr.conv_caps2 votes shape: (200, 216, 32, 16)
2020-06-26 20:37:33 INFO: lyr.conv_caps2 pose_out shape: (8, 5, 5, 32, 16)
2020-06-26 20:37:33 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 20:37:33 INFO: class_caps votes original shape: (200, 32, 10, 16)
2020-06-26 20:37:33 INFO: class_caps votes in to routing shape: (8, 800, 10, 16)
2020-06-26 20:37:33 INFO: class_caps activation shape: (8, 10)
2020-06-26 20:37:33 INFO: class_caps pose shape: (8, 10, 16)
2020-06-26 20:37:34 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 20:37:34 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 20:37:34 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 20:37:34 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-26 20:38:42 INFO: name: 20200220_17:42:42:547446_
2020-06-26 20:38:42 INFO: parent_dir: logs/svhn/single_pred_0_bg
2020-06-26 20:38:42 INFO: test_dir: logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test
2020-06-26 20:38:42 INFO: patch_path: logs/svhn/modcap_adv_hun/20200529_19:08:42:875141_/train/saved_patch.png
2020-06-26 20:38:42 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 20:38:42 INFO: Using dataset: svhn
2020-06-26 20:38:42 INFO: BUILD TEST GRAPH
2020-06-26 20:38:42 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 20:38:42 INFO: Overwrite dataset info from restored data version.
2020-06-26 20:38:42 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 20:38:42 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 20:38:42 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 20:38:42 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 20:38:42 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 20:38:42 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 20:38:42 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 20:38:42 INFO: input shape: (8, 32, 32, 3)
2020-06-26 20:38:43 INFO: relu_conv1 output shape: (8, 16, 16, 128)
2020-06-26 20:38:43 INFO: primary_caps pose shape: (8, 16, 16, 32, 16)
2020-06-26 20:38:43 INFO: primary_caps activation shape (8, 16, 16, 32, 1)
2020-06-26 20:38:43 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 20:38:43 INFO: lyr.conv_caps1 votes shape: (392, 288, 24, 16)
2020-06-26 20:38:43 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 20:38:43 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 20:38:43 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 20:38:43 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
2020-06-26 20:38:43 INFO: lyr.conv_caps1 activation_out shape: (8, 7, 7, 24, 1)
2020-06-26 20:38:43 INFO: lyr.conv_caps2 votes shape: (200, 216, 32, 16)
2020-06-26 20:38:43 INFO: lyr.conv_caps2 pose_out shape: (8, 5, 5, 32, 16)
2020-06-26 20:38:43 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 20:38:43 INFO: class_caps votes original shape: (200, 32, 10, 16)
2020-06-26 20:38:43 INFO: class_caps votes in to routing shape: (8, 800, 10, 16)
2020-06-26 20:38:44 INFO: class_caps activation shape: (8, 10)
2020-06-26 20:38:44 INFO: class_caps pose shape: (8, 10, 16)
2020-06-26 20:38:44 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 20:38:44 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 20:38:44 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 20:38:44 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-26 20:45:23 INFO: name: 20200220_17:42:42:547446_
2020-06-26 20:45:23 INFO: parent_dir: logs/svhn/single_pred_0_bg
2020-06-26 20:45:23 INFO: test_dir: logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test
2020-06-26 20:45:23 INFO: patch_path: logs/svhn/modcap_adv_ten/20200529_18:58:35:579177_/train/saved_patch.png
2020-06-26 20:45:23 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 20:45:23 INFO: Using dataset: svhn
2020-06-26 20:45:23 INFO: BUILD TEST GRAPH
2020-06-26 20:45:23 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 20:45:23 INFO: Overwrite dataset info from restored data version.
2020-06-26 20:45:23 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 20:45:23 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 20:45:23 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 20:45:23 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 20:45:23 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 20:45:23 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 20:45:23 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 20:45:23 INFO: input shape: (8, 32, 32, 3)
2020-06-26 20:45:23 INFO: relu_conv1 output shape: (8, 16, 16, 128)
2020-06-26 20:45:24 INFO: primary_caps pose shape: (8, 16, 16, 32, 16)
2020-06-26 20:45:24 INFO: primary_caps activation shape (8, 16, 16, 32, 1)
2020-06-26 20:45:24 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 20:45:24 INFO: lyr.conv_caps1 votes shape: (392, 288, 24, 16)
2020-06-26 20:45:24 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 20:45:24 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 20:45:24 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 20:45:24 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
2020-06-26 20:45:24 INFO: lyr.conv_caps1 activation_out shape: (8, 7, 7, 24, 1)
2020-06-26 20:45:24 INFO: lyr.conv_caps2 votes shape: (200, 216, 32, 16)
2020-06-26 20:45:24 INFO: lyr.conv_caps2 pose_out shape: (8, 5, 5, 32, 16)
2020-06-26 20:45:24 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 20:45:24 INFO: class_caps votes original shape: (200, 32, 10, 16)
2020-06-26 20:45:24 INFO: class_caps votes in to routing shape: (8, 800, 10, 16)
2020-06-26 20:45:24 INFO: class_caps activation shape: (8, 10)
2020-06-26 20:45:24 INFO: class_caps pose shape: (8, 10, 16)
2020-06-26 20:45:25 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 20:45:25 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 20:45:25 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 20:45:25 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-26 20:48:53 INFO: name: 20200220_17:42:42:547446_
2020-06-26 20:48:53 INFO: parent_dir: logs/svhn/single_pred_0_bg
2020-06-26 20:48:53 INFO: test_dir: logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test
2020-06-26 20:48:53 INFO: patch_path: logs/svhn/modcap_adv_tho/20200529_20:26:38:982892_/train/saved_patch.png
2020-06-26 20:48:53 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 20:48:53 INFO: Using dataset: svhn
2020-06-26 20:48:53 INFO: BUILD TEST GRAPH
2020-06-26 20:48:53 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 20:48:53 INFO: Overwrite dataset info from restored data version.
2020-06-26 20:48:53 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 20:48:53 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 20:48:53 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 20:48:53 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 20:48:53 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 20:48:53 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 20:48:53 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 20:48:53 INFO: input shape: (8, 32, 32, 3)
2020-06-26 20:48:54 INFO: relu_conv1 output shape: (8, 16, 16, 128)
2020-06-26 20:48:54 INFO: primary_caps pose shape: (8, 16, 16, 32, 16)
2020-06-26 20:48:54 INFO: primary_caps activation shape (8, 16, 16, 32, 1)
2020-06-26 20:48:54 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 20:48:54 INFO: lyr.conv_caps1 votes shape: (392, 288, 24, 16)
2020-06-26 20:48:54 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 20:48:54 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 20:48:54 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 20:48:54 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
2020-06-26 20:48:54 INFO: lyr.conv_caps1 activation_out shape: (8, 7, 7, 24, 1)
2020-06-26 20:48:54 INFO: lyr.conv_caps2 votes shape: (200, 216, 32, 16)
2020-06-26 20:48:54 INFO: lyr.conv_caps2 pose_out shape: (8, 5, 5, 32, 16)
2020-06-26 20:48:54 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 20:48:54 INFO: class_caps votes original shape: (200, 32, 10, 16)
2020-06-26 20:48:54 INFO: class_caps votes in to routing shape: (8, 800, 10, 16)
2020-06-26 20:48:55 INFO: class_caps activation shape: (8, 10)
2020-06-26 20:48:55 INFO: class_caps pose shape: (8, 10, 16)
2020-06-26 20:48:55 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 20:48:55 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 20:48:56 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 20:48:56 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-26 20:49:48 INFO: name: 20200220_17:42:42:547446_
2020-06-26 20:49:48 INFO: parent_dir: logs/svhn/single_pred_0_bg
2020-06-26 20:49:48 INFO: test_dir: logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test
2020-06-26 20:49:48 INFO: patch_path: logs/svhn/modcap_adv_tnk/20200529_21:02:15:012778_/train/saved_patch.png
2020-06-26 20:49:48 INFO: Loaded parameters from file: /home/xxd9704/Workspace/matrix-capsules-with-em-routing/logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/params/params.json
2020-06-26 20:49:48 INFO: Using dataset: svhn
2020-06-26 20:49:48 INFO: BUILD TEST GRAPH
2020-06-26 20:49:48 WARNING: From inspect_results.py:93: The name tf.train.get_or_create_global_step is deprecated. Please use tf.compat.v1.train.get_or_create_global_step instead.

2020-06-26 20:49:48 INFO: Overwrite dataset info from restored data version.
2020-06-26 20:49:48 INFO: Reusing dataset svhn_cropped (/home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0)
2020-06-26 20:49:48 INFO: Constructing tf.data.Dataset for split test, from /home/xxd9704/tensorflow_datasets/svhn_cropped/1.0.0
2020-06-26 20:49:48 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/data_pipelines/svhn.py:23: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
2020-06-26 20:49:48 WARNING: From inspect_results.py:128: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-06-26 20:49:48 WARNING: From inspect_results.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

2020-06-26 20:49:48 WARNING: From inspect_results.py:308: The name tf.get_variable_scope is deprecated. Please use tf.compat.v1.get_variable_scope instead.

2020-06-26 20:49:48 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/adv_patch_train_val.py:806: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
2020-06-26 20:49:48 INFO: input shape: (8, 32, 32, 3)
2020-06-26 20:49:48 INFO: relu_conv1 output shape: (8, 16, 16, 128)
2020-06-26 20:49:48 INFO: primary_caps pose shape: (8, 16, 16, 32, 16)
2020-06-26 20:49:48 INFO: primary_caps activation shape (8, 16, 16, 32, 1)
2020-06-26 20:49:48 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/models.py:116: The name tf.summary.histogram is deprecated. Please use tf.compat.v1.summary.histogram instead.

2020-06-26 20:49:48 INFO: lyr.conv_caps1 votes shape: (392, 288, 24, 16)
2020-06-26 20:49:49 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/em_routing.py:347: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
2020-06-26 20:49:49 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:383: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-06-26 20:49:49 WARNING: From /home/xxd9704/Workspace/matrix-capsules-with-em-routing/utils.py:570: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
2020-06-26 20:49:49 INFO: lyr.conv_caps1 pose_out shape: (8, 7, 7, 24, 16)
2020-06-26 20:49:49 INFO: lyr.conv_caps1 activation_out shape: (8, 7, 7, 24, 1)
2020-06-26 20:49:49 INFO: lyr.conv_caps2 votes shape: (200, 216, 32, 16)
2020-06-26 20:49:49 INFO: lyr.conv_caps2 pose_out shape: (8, 5, 5, 32, 16)
2020-06-26 20:49:49 INFO: lyr.conv_caps2 activation_out shape: (8, 5, 5, 32, 1)
2020-06-26 20:49:49 INFO: class_caps votes original shape: (200, 32, 10, 16)
2020-06-26 20:49:49 INFO: class_caps votes in to routing shape: (8, 800, 10, 16)
2020-06-26 20:49:49 INFO: class_caps activation shape: (8, 10)
2020-06-26 20:49:49 INFO: class_caps pose shape: (8, 10, 16)
2020-06-26 20:49:50 WARNING: From inspect_results.py:173: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2020-06-26 20:49:50 WARNING: From inspect_results.py:195: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

2020-06-26 20:49:50 WARNING: From /home/xxd9704/anaconda3/envs/capsenv/lib/python3.6/site-packages/tensorflow/python/training/saver.py:1276: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
2020-06-26 20:49:50 INFO: Restoring parameters from logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/train/checkpoint/model.ckpt127-387604
2020-06-27 03:18:42 INFO: writing to csv
2020-06-27 03:18:43 INFO: csv saved at logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test/logs_svhn_modcap_adv_15_20200529_14_43_08_286782__train_saved_patch_png_test.csv
2020-06-27 03:19:50 INFO: writing to csv
2020-06-27 03:19:51 INFO: csv saved at logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test/logs_svhn_modcap_adv_50_20200529_18_50_56_538576__train_saved_patch_png_test.csv
2020-06-27 03:20:54 INFO: writing to csv
2020-06-27 03:20:55 INFO: csv saved at logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test/logs_svhn_modcap_adv_20_20200529_15_34_32_157091__train_saved_patch_png_test.csv
2020-06-27 03:23:57 INFO: writing to csv
2020-06-27 03:23:59 INFO: csv saved at logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test/logs_svhn_modcap_adv_05_20200529_14_28_15_402853__train_saved_patch_png_test.csv
2020-06-27 03:24:17 INFO: writing to csv
2020-06-27 03:24:18 INFO: csv saved at logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test/logs_svhn_modcap_adv_10_20200529_14_33_54_592586__train_saved_patch_png_test.csv
2020-06-27 03:24:32 INFO: writing to csv
2020-06-27 03:24:33 INFO: csv saved at logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test/logs_svhn_modcap_adv_25_20200529_15_34_32_155179__train_saved_patch_png_test.csv
2020-06-27 03:25:07 INFO: writing to csv
2020-06-27 03:25:08 INFO: csv saved at logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test/logs_svhn_modcap_adv_35_20200529_16_04_05_697072__train_saved_patch_png_test.csv
2020-06-27 03:25:45 INFO: writing to csv
2020-06-27 03:25:46 INFO: csv saved at logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test/logs_svhn_modcap_adv_00_20200529_14_25_18_544445__train_saved_patch_png_test.csv
2020-06-27 03:26:34 INFO: writing to csv
2020-06-27 03:26:35 INFO: csv saved at logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test/logs_svhn_modcap_adv_hun_20200529_19_08_42_875141__train_saved_patch_png_test.csv
2020-06-27 03:26:47 INFO: writing to csv
2020-06-27 03:26:49 INFO: csv saved at logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test/logs_svhn_modcap_adv_30_20200529_15_43_23_179014__train_saved_patch_png_test.csv
2020-06-27 03:27:05 INFO: writing to csv
2020-06-27 03:27:06 INFO: csv saved at logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test/logs_svhn_modcap_adv_45_20200529_17_33_44_143073__train_saved_patch_png_test.csv
2020-06-27 03:27:42 INFO: writing to csv
2020-06-27 03:27:43 INFO: csv saved at logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test/logs_svhn_modcap_adv_40_20200529_16_06_38_175219__train_saved_patch_png_test.csv
2020-06-27 03:36:11 INFO: writing to csv
2020-06-27 03:36:13 INFO: csv saved at logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test/logs_svhn_modcap_adv_tho_20200529_20_26_38_982892__train_saved_patch_png_test.csv
2020-06-27 03:37:23 INFO: writing to csv
2020-06-27 03:37:25 INFO: csv saved at logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test/logs_svhn_modcap_adv_ten_20200529_18_58_35_579177__train_saved_patch_png_test.csv
2020-06-27 03:39:01 INFO: writing to csv
2020-06-27 03:39:02 INFO: csv saved at logs/svhn/single_pred_0_bg/20200220_17:42:42:547446_/test/logs_svhn_modcap_adv_tnk_20200529_21_02_15_012778__train_saved_patch_png_test.csv
